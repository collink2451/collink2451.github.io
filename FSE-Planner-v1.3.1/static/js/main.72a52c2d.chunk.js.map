{"version":3,"sources":["MapLayers/Components/Canvas.js","MapLayers/Components/Icons.js","MapLayers/Components/AirportIcon.js","utility.js","MapLayers/Components/Marker.js","MapLayers/Components/JobSegment.js","MapLayers/Components/Job.js","MapLayers/Jobs.js","MapLayers/Route.js","MapLayers/Zones.js","MapLayers/Airports.js","Map.js","routing.worker.js","Routing.js","Popups/Components/RectangleTransform.js","Popups/Components/CustomArea.js","Storage.js","Popups/Update.js","Popups/Settings.js","Popups/Credits.js","Tour.js","App.js","index.js"],"names":["Canvas","L","extend","_icons","clearCache","id","this","_map","_redraw","_updateAirportIcon","layer","_drawing","_empty","zoom","_zoom","minZoom","_layersMinZoom","maxZoom","_layersMaxZoom","color","options","fillColor","radius","type","p","_point","civil1","civil2","civil3","water1","water2","water3","military1","military2","military3","default","offscreen","document","createElement","octx","getContext","r","Math","max","scale","beginPath","arc","PI","fillStyle","fill","closePath","moveTo","lineTo","strokeStyle","lineWidth","stroke","rect","setTransform","canvas","_ctx","globalAlpha","drawImage","x","y","_updateArrowedPath","_parts","length","ratio","p1","p2","dx","dy","norm","sqrt","udx","udy","ax","ay","bx","by","l","bothWays","opacity","weight","civilSVG3","color1","color2","size","civilSVG2","civilSVG1","militarySVG","waterSVG","AirportSVG","icons","civil","military","water","s","AirportIcon","CircleMarker","initialize","latlng","prototype","call","_updatePath","_renderer","_radius","setRadius","undefined","getRadius","setStyle","hideAirport","icao","icaodata","runway","surface","includes","onlyMSFS","msfs","useStyles","makeStyles","theme","striked","display","marginRight","spacing","textDecoration","textDecorationStyle","fontWeight","popupHeader","background","palette","primary","main","padding","borderTopLeftRadius","borderTopRightRadius","popupPart","popupLabel","margin","alignItems","icon","toFSE","marginLeft","fontSize","name","simSeparator","model","light","borderRadius","plane","planeHome","planeSearch","toFSEPlane","SVGs","PlaneHome","actions","classes","home","Typography","variant","className","reg","Link","href","target","title","dry","wet","bonus","fr","latitude","lat","longitude","lon","to","dir","round","getRhumbLineBearing","dist","convertDistance","getDistance","Fragment","style","transform","onClick","evt","preventDefault","current","goTo","Popup","props","planes","siminfo","iconRef","React","useRef","useEffect","innerHTML","get","models","push","ref","airportSurface","Breadcrumbs","separator","maxItems","itemsBeforeCollapse","itemsAfterCollapse","component","slice","map","elm","key","Object","entries","Marker","position","sim","a","parseInt","bindPopup","div","ReactDOM","render","autoPanPadding","Point","minWidth","min","window","innerWidth","maxWidth","on","DomEvent","stopPropagation","open","focus","isFromIcao","isToIcao","fromIcao","toIcao","isInCustom","removeCustom","addCustom","contextMenu","mouseX","originalEvent","clientX","mouseY","clientY","JobSegment","Polyline","latlngs","prevColor","highlight","_clickTolerance","myflight","marginTop","icaos","paddingLeft","Cargo","cargo","pay","passengers","kg","Tooltip","leg","rleg","distance","amount","direction","flight","Job","positions","bindTooltip","sticky","Jobs","memo","settings","groupRef","layerGroup","leaflet","useLeaflet","added","jobs","opts","keys","legs","i","split","frIcao","airport","minDist","maxDist","hasOwnProperty","from","distCoef","parseFloat","angle","abs","filteredJobs","filter","job","min_job","nb","reduce","min_leg","top","values","forEach","pay_r","sort","b","index","floor","min_pay","cleanLegs","markers","Set","add","arr","getMarkers","Location","Destination","Units","Amount","Pay","addFlight","clearLayers","legsKeys","mw","weights","base","colors","addTo","marker","sizes","rentable","selected","layerContainer","addLayer","Route","route","cargos","TripOnly","acc","VIP","pax","ZonesLayer","polyline","zone","interactive","AirportsLayer","featureGroup","prevIcao","airportFilter","fseicaodata","link","msfsIcaos","contextMenuTitle","contextMenuList","paddingTop","FSEMap","mapRef","canvasRendererRef","maxBounds","center","useState","setContextMenu","unbuiltFBOs","setUnbuildFBOs","searchRef","prevSearchRef","remove","search","leafletElement","setTimeout","openPopup","bringToFront","points","getBounds","fitBounds","minLat","minLng","maxLat","maxLng","animate","bounds","latLngBounds","mapBounds","contains","fetch","then","response","ok","json","closeContextMenu","attributionControl","renderer","onContextMenu","Number","EPSILON","lng","Popover","onClose","anchorReference","anchorPosition","left","paper","MenuList","action","MenuItem","dense","TileLayer","url","LayersControl","Overlay","checked","Airports","fse","custom","Zones","customIcaos","Worker","__webpack_public_path__","routing","width","boxShadow","zIndex","flexDirection","textAlign","marginBottom","pMore","more","cursor","pButtons","content","overflowX","overflowY","scrollbarWidth","result","borderBottom","grid","gridText","justifyContent","sortByValue","right","form","formLabel","moreSettings","borderTop","typeButtons","tlOp","flex","tlCt","tlPaper","paddingRight","paddingBottom","tlGrid","tlGridText","tlTotal","back","backText","verticalAlign","topResults","nbResults","backSearch","height","backSearchText","lineHeight","topResultsDiv","filterBtn","filters","filtersInput","filtersApply","closeButton","grey","progressBar","textTotalCargo","kgPax","text","join","Results","results","showDetail","setRoute","nbDisplay","sortBy","onMouseEnter","Grid","container","item","xs","time","payNM","payLeg","payTime","filterText","Routing","resultsScroll","resultsDiv","filteredResults","setFilteredResults","loading","setLoading","setMoreSettings","maxPax","setMaxPax","maxKg","setMaxKg","setFromIcao","setToIcao","maxHops","setMaxHops","maxStops","setMaxStops","speed","setSpeed","approachLength","setApproachLength","loop","setLoop","setType","minLoad","setMinLoad","maxBadLegs","setMaxBadLegs","setSortBy","setFocus","filterMenu","setFilterMenu","setMinDist","setMaxDist","minPay","setMinPay","maxPay","setMaxPay","minTime","setMinTime","maxTime","setMaxTime","setNbDisplay","progress","setProgress","cancel","setCancel","sortFunctions","filterResults","minTimeNb","maxTimeNb","t","timeNb","useCallback","scrollTop","scrollTo","prepResults","allResults","totalDistance","h","minBonus","minPlane","startIcao","endIcao","hidden","IconButton","close","Timeline","align","onboard","TimelineItem","TimelineOppositeContent","paragraph","Paper","j","TimelineSeparator","TimelineDot","TimelineConnector","TimelineContent","Button","currentTarget","startIcon","anchorEl","keepMounted","Boolean","TextField","label","value","onChange","replace","InputProps","endAdornment","InputAdornment","InputLabelProps","shrink","placeholder","val","match","startAdornment","select","onScroll","scrollHeight","clientHeight","required","ToggleButtonGroup","exclusive","newType","ToggleButton","FormControlLabel","control","Switch","toUpperCase","alert","k","v","obj","c","Map","set","minPaxLoad","minKgLoad","totalIcaos","maxWorkers","navigator","hardwareConcurrency","closeIcaosCache","done","workers","worker","RoutingWorker","onmessage","data","status","concat","pop","postMessage","terminate","prev","disabled","LinearProgress","RectangleTransform","rectangle","draggable","enable","rotation","scaling","uniformScaling","dragging","onUpdate","Component","withLeaflet","popup","popupContent","boundsOptions","CustomAreaPopup","startBounds","handleClose","setBounds","node","setMinZoom","getBoundsZoom","Dialog","fullWidth","DialogTitle","DialogContent","DialogActions","setArea","Storage","oldVersion","localStorage","getItem","process","planeModel","setItem","defaultValue","JSON","parse","stringify","error","removeItem","storage","getIcaoList","countries","getNorth","getEast","getSouth","getWest","n","e","w","isPointInPolygon","country","state","reminder","list","start","indexOf","buttonProgress","span","divider","dialog","accSummary","accDetails","flexGrow","createFilterOptions","UpdatePopup","setKey","jobsAreas","setJobsAreas","_southWest","_northEast","jobsCustom","setJobsCustom","jobsTime","setJobsTime","jobsRequests","setJobsRequests","setPlaneModel","planesTime","setPlanesTime","planesRequests","setPlanesRequests","flightTime","setFlightTime","openCustom","setOpenCustom","expanded","setExpanded","customIcaosVal","setCustomIcaosVal","areas","getAreas","setUpdatePopup","setUpdatePopupRef","panelChange","panel","event","isExpanded","dividers","Alert","severity","Accordion","data-tour","AccordionSummary","expandIcon","AccordionDetails","helperText","setJobs","Date","toLocaleString","updateJobsRequest","icaosList","callback","Error","csv","readString","header","skipEmptyLines","dynamicTyping","errors","catch","console","log","ToIcao","UnitType","Type","cleanJobs","date","toString","CircularProgress","Autocomplete","multiple","limitTags","renderInput","params","filterOptions","filtered","unshift","selectOnFocus","clearOnBlur","handleHomeEndKeys","renderOption","option","CustomArea","setPlanes","updatePlanesRequest","encodeURI","NeedsRepair","RentedBy","RentalDry","RentalWet","FeeOwed","MakeModel","SerialNumber","Registration","Home","Bonus","cleanPlanes","aircrafts","setFlight","Id","setCustomIcaos","elms","multiline","rows","Setting","setting","setS","assign","_set","SettingSlider","Slider","step","marks","track","valueLabelDisplay","SettingSwitch","SettingSlider2","computeVal","inverseVal","valueLabelFormat","SettingSlider3","SettingSelect","SelectProps","SettingsPopup","handleChange","_clone","src","alt","confirm","setSettings","defaultSettings","version","IssueLink","CreditsPopup","Tabs","newValue","openTutorial","indicatorColor","textColor","centered","Tab","List","ListItem","buttons","button","TourStep","onPrev","disableFocusRipple","skip","end","onNext","Tour","updatePopup","isTourOpen","setIsTourOpen","isUpdatePopupOpen","wasUpdatePopupOpen","wasTourOpen","steps","selector","isOpen","onRequestClose","showNavigation","disableInteraction","showButtons","closeWithMask","showCloseButton","icaodataSrcArr","icaodataSrc","limit","PopperMy","Popper","placement","tgBtn","borderColor","tgBtnSelected","box","input","backgroundColor","shape","inputNb","inputSearch","boxBorder","border","popover","tooltip","dark","tooltipArrow","flexWrap","h6","letterSpacing","textTransform","searchOption","overflow","searchInfos","searchLocation","textOverflow","whiteSpace","searchName","searchIcao","body","TooltipToggleButton","children","tclasses","arrow","transformPlanes","App","setCargo","fromIcaoInput","setFromIcaoInput","toIcaoInput","setToIcaoInput","setMin","setMax","setDirection","settingsPopop","setSettingsPopup","creditsPopop","setCreditsPopup","_defaultsDeep","setSearch","searchInput","setSearchInput","searchHistory","setSearchHistory","setIcaodata","routeFinder","setRouteFinder","useMemo","num","pointLon","wrap","wrapZone","last","URLSearchParams","location","goToRef","history","replaceState","invalidateSize","pan","setFrom","setTo","setActions","flexFlow","AppBar","Toolbar","getOptionLabel","city","inputValue","InputBase","inputProps","PopperComponent","onInputChange","autoHighlight","maxLength","root","Settings","Credits","StrictMode","getElementById"],"mappings":"0ynqaAwMeA,GArMAC,KAAED,OAAOE,OAAO,CAE7BC,OAAQ,GAERC,WAAY,WAAqB,IAAZC,EAAW,uDAAN,KACnBA,SAIIC,KAAKH,OAAOE,GAHnBC,KAAKH,OAAS,GAKXG,KAAKC,MACVD,KAAKE,WAGPC,mBAAoB,SAAUC,GAC5B,GAAKJ,KAAKK,WAAYD,EAAME,SAA5B,CAEA,IAAMC,EAAOP,KAAKC,KAAKO,MACjBC,EAAUT,KAAKC,KAAKS,eACpBC,EAAUX,KAAKC,KAAKW,eACpBC,EAAQT,EAAMU,QAAQD,MACtBE,EAAYX,EAAMU,QAAQC,UAC1BC,EAASZ,EAAMU,QAAQE,OACvBC,EAAOb,EAAMU,QAAQG,KACrBlB,EAAKK,EAAMU,QAAQf,GACnBmB,EAAId,EAAMe,OAiBhB,GAdKnB,KAAKH,OAAOE,KACfC,KAAKH,OAAOE,GAAM,CAChBqB,OAAQ,GACRC,OAAQ,GACRC,OAAQ,GACRC,OAAQ,GACRC,OAAQ,GACRC,OAAQ,GACRC,UAAW,GACXC,UAAW,GACXC,UAAW,GACXC,QAAS,MAGR7B,KAAKH,OAAOE,GAAIkB,GAAMV,GAAO,CAChC,IAAMuB,EAAYC,SAASC,cAAc,UACnCC,EAAOH,EAAUI,WAAW,MAE9BC,EAAI,KACR,GAAI5B,GAAQ,EACV4B,GAAKnB,EAAS,KAAM,EAAIP,IAAUF,EAAOE,GAAW,QAIpD0B,GADkBC,KAAKC,IAAIrB,EAAQ,IAClBA,IAASL,EAAU,IAAIJ,EAAO,GAAKS,EActD,OAXAiB,EAAKK,MAAMH,EAAE,GAAIA,EAAE,IAGnBF,EAAKM,YACLN,EAAKO,IAAI,GAAI,GAAI,GAAI,EAAI,EAAEJ,KAAKK,IAChCR,EAAKS,UAAY3B,EACjBkB,EAAKU,OACLV,EAAKW,YAGLX,EAAKM,YACEtB,GACL,IAAK,SACHgB,EAAKO,IAAI,GAAI,GAAI,EAAG,EAAI,EAAEJ,KAAKK,IAC/B,MACF,IAAK,SACHR,EAAKY,OAAO,MAAO,QACnBZ,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,MAAO,QACnBb,EAAKa,OAAO,MAAO,QACnB,MACF,IAAK,SACHb,EAAKY,OAAO,MAAO,QACnBZ,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,MAAO,QACnBb,EAAKa,OAAO,MAAO,QACnBb,EAAKY,OAAO,MAAO,OACnBZ,EAAKa,OAAO,OAAQ,QACpBb,EAAKa,OAAO,OAAQ,QACpBb,EAAKa,OAAO,MAAO,OACnBb,EAAKa,OAAO,MAAO,OACnB,MACF,IAAK,SACL,IAAK,SACL,IAAK,SACHb,EAAKO,IAAI,GAAI,GAAI,IAAK,GAAOJ,KAAKK,GAAG,IACrCR,EAAKc,YAAclC,EACnBoB,EAAKe,UAAY,IACjBf,EAAKgB,SACLhB,EAAKW,YACLX,EAAKM,YACLN,EAAKiB,KAAK,EAAG,EAAG,EAAG,IACnBjB,EAAKY,OAAO,EAAO,GACnBZ,EAAKa,OAAO,EAAO,GACnBb,EAAKa,OAAO,GAAQ,GACpBb,EAAKa,OAAO,GAAQ,GACpBb,EAAKa,OAAO,EAAO,GACnBb,EAAKY,OAAO,EAAO,IACnB,MACF,IAAK,YACL,IAAK,YACL,IAAK,YACHZ,EAAKY,OAAO,OAAQ,OACpBZ,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,MAAO,QACnBb,EAAKa,OAAO,MAAO,OACnBb,EAAKa,OAAO,MAAO,OACnBb,EAAKa,OAAO,MAAO,QACnBb,EAAKa,OAAO,MAAO,QACnBb,EAAKa,OAAO,MAAO,OACnBb,EAAKa,OAAO,MAAO,OACnBb,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,OAAQ,OACpBb,EAAKa,OAAO,OAAQ,QACpBb,EAAKa,OAAO,OAAQ,QACpBb,EAAKa,OAAO,OAAQ,OAKxBb,EAAKS,UAAY7B,EACjBoB,EAAKU,OACLV,EAAKW,YAELX,EAAKkB,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GAEjCnD,KAAKH,OAAOE,GAAIkB,GAAMV,GAAQ,CAAC4B,EAAGA,EAAGiB,OAAQtB,GAvHZ,MA0Hf9B,KAAKH,OAAOE,GAAIkB,GAAMV,GAAnC4B,EA1H4B,EA0H5BA,EAAGiB,EA1HyB,EA0HzBA,OAIV,OAHApD,KAAKqD,KAAKC,YAAc,EACxBtD,KAAKqD,KAAKE,UAAUH,EAAQlC,EAAEsC,EAAIrB,EAAGjB,EAAEuC,EAAItB,GAEpCA,IAITuB,mBAAoB,SAAStD,GAC3B,GAAKA,EAAMuD,OAAOC,OAAlB,CAEA,IAGIC,EAHEtD,EAAOP,KAAKC,KAAKO,MACjBC,EAAUT,KAAKC,KAAKS,eACpBC,EAAUX,KAAKC,KAAKW,eAGxBiD,EADEtD,GAAQ,EACF,KAAY,EAAIE,IAAUF,EAAOE,GAAW,IAG5C,GAASE,EAAU,IAAIJ,EAAO,GAAK,EAG7C,IAAMuD,EAAK1D,EAAMuD,OAAO,GAAG,GACrBI,EAAK3D,EAAMuD,OAAO,GAAG,GACrBK,EAAKF,EAAGN,EAAIO,EAAGP,EACfS,EAAKH,EAAGL,EAAIM,EAAGN,EACfS,EAAO9B,KAAK+B,KAAKH,EAAGA,EAAGC,EAAGA,GAC1BG,EAAMJ,EAAGE,EACTG,EAAMJ,EAAGC,EAETI,EAAKF,EAAMhC,KAAK+B,KAAK,GAAG,EAAU,EAANE,EAAQ,EACpCE,EAAW,EAANH,EAAQ,EAAIC,EAAMjC,KAAK+B,KAAK,GAAG,EACpCK,EAAKJ,EAAMhC,KAAK+B,KAAK,GAAG,EAAU,EAANE,EAAQ,EACpCI,EAAc,GAANL,EAAQ,EAAIC,EAAMjC,KAAK+B,KAAK,GAAG,EAE7CnE,KAAKqD,KAAKd,YAEVvC,KAAKqD,KAAKR,OAAOiB,EAAGN,EAAGM,EAAGL,GAC1BzD,KAAKqD,KAAKP,OAAOiB,EAAGP,EAAGO,EAAGN,GAE1B,IAAMiB,EAAI,GAAGb,EAEb7D,KAAKqD,KAAKR,OAAOiB,EAAGN,EAAIQ,EAAG,EAAIU,EAAIJ,EAAIR,EAAGL,EAAIQ,EAAG,EAAIS,EAAIH,GACzDvE,KAAKqD,KAAKP,OAAOgB,EAAGN,EAAIQ,EAAG,EAAGF,EAAGL,EAAIQ,EAAG,GACxCjE,KAAKqD,KAAKP,OAAOgB,EAAGN,EAAIQ,EAAG,EAAIU,EAAIF,EAAIV,EAAGL,EAAIQ,EAAG,EAAIS,EAAID,GAErDrE,EAAMU,QAAQ6D,WAChB3E,KAAKqD,KAAKR,OAAOiB,EAAGN,EAAIQ,EAAG,EAAIU,EAAIJ,EAAIR,EAAGL,EAAIQ,EAAG,EAAIS,EAAIH,GACzDvE,KAAKqD,KAAKP,OAAOgB,EAAGN,EAAIQ,EAAG,EAAGF,EAAGL,EAAIQ,EAAG,GACxCjE,KAAKqD,KAAKP,OAAOgB,EAAGN,EAAIQ,EAAG,EAAIU,EAAIF,EAAIV,EAAGL,EAAIQ,EAAG,EAAIS,EAAID,IAG3DzE,KAAKqD,KAAKC,YAAclD,EAAMU,QAAQ8D,QACtC5E,KAAKqD,KAAKN,YAAc3C,EAAMU,QAAQD,MACtCb,KAAKqD,KAAKL,UAAY5C,EAAMU,QAAQ+D,OAAOhB,EAC3C7D,KAAKqD,KAAKJ,SACVjD,KAAKqD,KAAKT,gB,6GCnMd,SAASkC,GAAUC,EAAQC,EAAQC,GACjC,MAAO,eAAeA,EAAK,aAAaA,EAAK,4EAA4EF,EAAO,8FAA8FC,EAAO,6FAA6FA,EAAO,YAE3U,SAASE,GAAUH,EAAQC,EAAQC,GACjC,MAAO,eAAeA,EAAK,aAAaA,EAAK,4EAA4EF,EAAO,8FAA8FC,EAAO,YAEvO,SAASG,GAAUJ,EAAQC,EAAQC,GACjC,MAAO,eAAeA,EAAK,aAAaA,EAAK,yFAAyFF,EAAO,2EAA2EC,EAAO,YAIjO,SAASI,GAAYL,EAAQC,EAAQC,GACnC,MAAO,eAAeA,EAAK,aAAaA,EAAK,4EAA4EF,EAAO,4NAA4NC,EAAO,YAIrW,SAASK,GAASN,EAAQC,EAAQC,GAChC,MAAO,eAAeA,EAAK,aAAaA,EAAK,4EAA4EF,EAAO,oDAAoDC,EAAO,2FAA2FA,EAAO,2HAA2HA,EAAO,2CAG1Z,IAAMM,GAAb,WACE,WAAYP,EAAQC,EAAQC,GAAO,qBACjCjF,KAAKuF,MAAQ,CACXC,MAAO,CACLL,GAAUJ,EAAQC,EAAQC,GAC1BC,GAAUH,EAAQC,EAAQC,GAC1BH,GAAUC,EAAQC,EAAQC,IAE5BQ,SAAU,CACRL,GAAYL,EAAQC,EAAQC,GAC5BG,GAAYL,EAAQC,EAAQC,GAC5BG,GAAYL,EAAQC,EAAQC,IAE9BS,MAAO,CACLL,GAASN,EAAQC,EAAQC,GACzBI,GAASN,EAAQC,EAAQC,GACzBI,GAASN,EAAQC,EAAQC,KAhBjC,iDAqBMhE,EAAMgE,GACR,IAAMU,EAAKV,GAAQ,KAAQ,EAAKA,GAAQ,IAAQ,EAAI,EACpD,OAAOjF,KAAKuF,MAAMtE,GAAM0E,OAvB5B,KCKeC,GAvBKjG,KAAEkG,aAAajG,OAAO,CAExCkB,QAAS,CACPG,KAAM,UACNlB,GAAI,WAGN+F,WAAY,SAASC,EAAQjF,GAC3BnB,KAAEkG,aAAaG,UAAUF,WAAWG,KAAKjG,KAAM+F,EAAQjF,IAGzDoF,YAAa,WACX,IAAMlF,EAAShB,KAAKmG,UAAUhG,mBAAmBH,MAC7CgB,IACFhB,KAAKoG,QAAUpF,IAInBqF,eAAWC,EACXC,eAAWD,EACXE,cAAUF,I,SCrBL,SAASG,GAAYC,EAAMf,GAChC,OACIA,IAGIgB,GAASD,GAAMzB,KAAOU,EAAEV,KAAK,IAE7B0B,GAASD,GAAMzB,KAAOU,EAAEV,KAAK,IAE7B0B,GAASD,GAAME,OAASjB,EAAEiB,OAAO,IAEjCD,GAASD,GAAME,OAASjB,EAAEiB,OAAO,KAEhCjB,EAAEkB,QAAQC,SAASH,GAASD,GAAMG,UAG/BlB,EAAEoB,UAEyB,OAA3BJ,GAASD,GAAMM,KAAK,ICHlC,IAAMC,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCC,QAAS,CACPC,QAAS,eACTC,YAAaH,EAAMI,QAAQ,GAC3BC,eAAgB,eAChBC,oBAAqB,SACrBC,WAAY,KAEdC,YAAa,CACXC,WAAYT,EAAMU,QAAQC,QAAQC,KAClClH,MAAO,OACPmH,QAAS,mBACTC,oBAAqB,EACrBC,qBAAsB,GAExBC,UAAW,CACTH,QAAS,oBAEXI,WAAY,CACVC,OAAQ,wBAEV3B,KAAM,CACJW,QAAS,OACTiB,WAAY,UAEdC,KAAM,CACJlB,QAAS,cACTC,YAAaH,EAAMI,QAAQ,IAE7BiB,MAAO,CACLnB,QAAS,cACTiB,WAAY,SACZG,WAAYtB,EAAMI,QAAQ,GAC1BD,YAAaH,EAAMI,QAAQ,GAC3B1G,MAAO,sCACP6H,SAAU,QACV,UAAW,CACT7H,MAAO,oBAGX8H,KAAM,CACJN,OAAQ,wBACRX,WAAY,KAEdkB,aAAc,CACZH,WAAY,EACZnB,YAAa,GAEfuB,MAAO,CACLjB,WAAYT,EAAMU,QAAQC,QAAQgB,MAClCjI,MAAO,OACPwH,OAAQ,eACRL,QAAS,UACTe,aAAc,GAEhBC,MAAO,CACL3B,QAAS,OACTiB,WAAY,SACZD,OAAQ,2BAEVY,UAAW,CACTZ,OAAQ,wBACRK,SAAU,SACV7H,MAAO,OACPwG,QAAS,OACTiB,WAAY,UAEdY,YAAa,CACX7B,QAAS,cACTiB,WAAY,SACZG,WAAYtB,EAAMI,QAAQ,IAC1BD,YAAaH,EAAMI,QAAQ,IAC3B,UAAW,CACTC,eAAgB,SAGpB2B,WAAY,CACV9B,QAAS,cACTiB,WAAY,SACZhB,YAAaH,EAAMI,QAAQ,IAC3BkB,WAAYtB,EAAMI,QAAQ,SAIxB6B,GAAO,IAAI9D,GAAW,OAAQ,UAAW,IAG/C,SAAS+D,GAAT,GAAsD,IAAlCL,EAAiC,EAAjCA,MAAOrC,EAA0B,EAA1BA,SAAUD,EAAgB,EAAhBA,KAAM4C,EAAU,EAAVA,QACnCC,EAAUtC,KAEhB,GAAI+B,EAAMQ,OAAS9C,EACjB,OACE,kBAAC+C,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQP,OAC5CA,EAAMY,IACP,kBAACC,GAAA,EAAD,CAAMC,KAAM,oDAAoDd,EAAMjJ,GAAIgK,OAAO,MAAMJ,UAAWJ,EAAQJ,WAAYa,MAAM,aAC1H,kBAAC,KAAD,CAAetB,SAAS,aAH5B,KAKKM,EAAMiB,IAAM,IAAIjB,EAAMiB,IAAM,IALjC,IAKuCjB,EAAMkB,IAAM,IAAIlB,EAAMkB,IAAM,IALnE,MAK2ElB,EAAMmB,MALjF,KAUJ,IAAMC,EAAK,CAAEC,SAAU1D,EAASD,GAAM4D,IAAKC,UAAW5D,EAASD,GAAM8D,KAC/DC,EAAK,CAAEJ,SAAU1D,EAASqC,EAAMQ,MAAMc,IAAKC,UAAW5D,EAASqC,EAAMQ,MAAMgB,KAC3EE,EAAMtI,KAAKuI,MAAMC,+BAAoBR,EAAIK,IACzCI,EAAOzI,KAAKuI,MAAMG,2BAAgBC,uBAAYX,EAAIK,GAAK,OAO7D,OACE,kBAAC,IAAMO,SAAP,KACE,kBAACvB,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQP,OAC5CA,EAAMY,IACP,kBAACC,GAAA,EAAD,CAAMC,KAAM,oDAAoDd,EAAMjJ,GAAIgK,OAAO,MAAMJ,UAAWJ,EAAQJ,WAAYa,MAAM,aAC1H,kBAAC,KAAD,CAAetB,SAAS,aAH5B,KAKKM,EAAMiB,IAAM,IAAIjB,EAAMiB,IAAM,IALjC,IAKuCjB,EAAMkB,IAAM,IAAIlB,EAAMkB,IAAM,IALnE,MAK2ElB,EAAMmB,MAAM,kBAAC,KAAD,CAAgBzB,SAAS,UAAUuC,MAAO,CAACxC,WAAY,EAAGyC,UAAW,UAAUR,EAAI,UAL1K,KAOA,kBAACjB,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQN,WAA/C,QAEE,kBAACY,GAAA,EAAD,CAAMC,KAAK,IAAIqB,QAhBD,SAACC,GACnBA,EAAIC,iBACJ/B,EAAQgC,QAAQC,KAAKvC,EAAMQ,OAccG,UAAWJ,EAAQL,YAAac,MAAM,uBACzE,kBAAC,KAAD,CAAuBtB,SAAS,YAC/BM,EAAMQ,MAJX,IAMIkB,EANJ,QAMWG,EANX,QAYN,SAASW,GAAMC,GAAQ,IACd/E,EAAmC+E,EAAnC/E,KAAMC,EAA6B8E,EAA7B9E,SAAU+E,EAAmBD,EAAnBC,OAAQC,EAAWF,EAAXE,QACzBpC,EAAUtC,KAEV2E,EAAUC,IAAMC,OAAO,MAC7BD,IAAME,WAAU,WACdH,EAAQN,QAAQU,UAAY5C,GAAK6C,IAAItF,EAASD,GAAMzF,KAAM0F,EAASD,GAAMzB,QACxE,CAAC0B,EAAUD,IAEd,IAAMwF,EAAS,GACf,GAAIR,EAAQ,CAAC,IAAD,gBACUA,GADV,IACV,2BAA4B,CAAC,IAAlB1C,EAAiB,QACrBkD,EAAOlD,EAAMH,SAAUqD,EAAOlD,EAAMH,OAAS,IAClDqD,EAAOlD,EAAMH,OAAOsD,KAAKnD,IAHjB,+BAOZ,OACE,kBAAC,IAAMgC,SAAP,KACE,yBAAKrB,UAAWJ,EAAQ5B,aACtB,kBAAC8B,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQ7C,MAC1C,0BAAM0F,IAAKR,EAASjC,UAAWJ,EAAQhB,OAErC5B,EAASD,GAAMiF,GAAS,KAAOjF,EAC7BA,EAEA,kBAAC,IAAMsE,SAAP,KACE,0BAAMrB,UAAWJ,EAAQnC,SAAUV,GAAaC,EAASD,GAAMiF,GAAS,IAG9E,kBAAC9B,GAAA,EAAD,CAAMC,KAAM,iDAAiDpD,EAAMqD,OAAO,MAAMJ,UAAWJ,EAAQf,MAAOwB,MAAM,aAC9G,kBAAC,KAAD,CAAetB,SAAS,cAG5B,kBAACe,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQZ,MAAOhC,EAASD,GAAMiC,OAEvE,yBAAKgB,UAAWJ,EAAQpB,WACtB,kBAACsB,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQnB,YAA/C,YDjKD,SAAwBvB,GAC7B,OAAQA,GACN,KAAK,EAAG,MAAO,UACf,KAAK,EAAG,MAAO,WACf,KAAK,EAAG,MAAO,QACf,KAAK,EAAG,MAAO,OACf,KAAK,EAAG,MAAO,QACf,KAAK,EAAG,MAAO,SACf,KAAK,EAAG,MAAO,UACf,KAAK,EAAG,MAAO,cACf,KAAK,EAAG,MAAO,OACf,KAAK,GAAI,MAAO,aAChB,QAAS,MAAO,SCqJyDwF,CAAe1F,EAASD,GAAMG,UACnG,kBAAC4C,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQnB,YAA/C,mBAA4EzB,EAASD,GAAME,OAA3F,SAEED,EAASD,GAAMiF,GAAS/H,OAAS,GAC/B,kBAAC,IAAMoH,SAAP,KACE,kBAACvB,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQnB,YAA/C,sBACA,kBAACkE,GAAA,EAAD,CACEC,UAAW,KACXC,SAAU,EACVC,oBAAqB,EACrBC,mBAAoB,EACpBnD,QAAS,CAACgD,UAAWhD,EAAQX,cAC7B+D,UAAU,QAEThG,EAASD,GAAMiF,GAASiB,MAAM,GAAGC,KAAI,SAAAC,GAAG,OAAI,0BAAMC,IAAKD,GAAMA,SAMtEpB,GAAUsB,OAAOC,QAAQf,GAAQW,KAAI,mCAAEhE,EAAF,KAAS6C,EAAT,YACnC,yBAAK/B,UAAWJ,EAAQpB,UAAW4E,IAAKlE,GACtC,kBAACY,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQV,OAAQA,GACtD6C,EAAOmB,KAAI,SAAA7D,GAAK,OAAI,kBAACK,GAAD,eAAW0D,IAAK/D,EAAMY,IAAKZ,MAAOA,GAAWyC,YA4G/DyB,OApGf,YAA6D,IAA5CC,EAA2C,EAA3CA,SAAUlI,EAAiC,EAAjCA,KAAMpE,EAA2B,EAA3BA,MAAOuM,EAAoB,EAApBA,IAAKrN,EAAe,EAAfA,GAAO0L,EAAQ,sDACtDxK,EAAO,UACX,IAAKmM,GAAQ3B,EAAM9E,SAAS8E,EAAM/E,OAAS+E,EAAM9E,SAAS8E,EAAM/E,MAAM0G,GAAK,KAAO3B,EAAM/E,KAAO,CAC7F,IAAM2G,EAAI5B,EAAM9E,SAAS8E,EAAM/E,MAC/BzF,EAAOoM,EAAEpM,MAAQoM,EAAEpI,MAAQ,KAAO,EAAIoI,EAAEpI,MAAQ,IAAO,EAAI,GAE7D,OAAO,IAAIW,GACTuH,EACA,CACEnM,OAAQsM,SAASrI,GAAM,EACvBpE,MAAO,OACPE,UAAWF,EACXI,KAAMA,EACNlB,GAAIA,IAGLwN,WAAU,WACT,IAAIC,EAAMzL,SAASC,cAAc,OAOjC,OANIoL,EACFK,IAASC,OAAO,kBAACjE,EAAA,EAAD,CAAYC,QAAQ,KAAKuB,MAAO,CAACjD,QAAQ,oBAAqByD,EAAM/E,MAAoB8G,GAGxGC,IAASC,OAAO,kBAAClC,GAAUC,GAAW+B,GAEjCA,IACN,CACDG,eAAgB,IAAIhO,KAAEiO,MAAM,GAAI,IAChCC,SAAUT,EAAM,IAAMhL,KAAK0L,IAAI,IAAKC,OAAOC,WAAW,IACtDC,SAAU7L,KAAKC,IAAI,IAAK0L,OAAOC,WAAW,MAE3CE,GAAG,eAAe,SAAC9C,GAClBzL,KAAEwO,SAASC,gBAAgBhD,GAC3B,IAAM9B,EAAU,GAChB,IAAK8D,EAAK,CACR9D,EAAQ6C,KAAK,CACXxD,KAAM,cACNwC,QAAS,WACC4C,OAAOM,KAAK,iDAAiD5C,EAAM/E,KAAM,OAC/E4H,WAGN,IAAMC,EAAa9C,EAAMnC,QAAQgC,QAAQiD,WAAW9C,EAAM/E,MACpD8H,EAAW/C,EAAMnC,QAAQgC,QAAQkD,SAAS/C,EAAM/E,MAClD6H,EACFjF,EAAQ6C,KAAK,CACXxD,KAAM,6BACNwC,QAAS,kBAAMM,EAAMnC,QAAQgC,QAAQmD,SAAS,OAIhDnF,EAAQ6C,KAAK,CACXxD,KAAM,sBACNwC,QAAS,WACHqD,GACF/C,EAAMnC,QAAQgC,QAAQoD,OAAO,IAE/BjD,EAAMnC,QAAQgC,QAAQmD,SAAShD,EAAM/E,SAIvC8H,EACFlF,EAAQ6C,KAAK,CACXxD,KAAM,2BACNwC,QAAS,kBAAMM,EAAMnC,QAAQgC,QAAQoD,OAAO,OAI9CpF,EAAQ6C,KAAK,CACXxD,KAAM,oBACNwC,QAAS,WACHoD,GACF9C,EAAMnC,QAAQgC,QAAQmD,SAAS,IAEjChD,EAAMnC,QAAQgC,QAAQoD,OAAOjD,EAAM/E,SAIrC+E,EAAMnC,QAAQgC,QAAQqD,WAAWlD,EAAM/E,MACzC4C,EAAQ6C,KAAK,CACXxD,KAAM,8BACNwC,QAAS,kBAAMM,EAAMnC,QAAQgC,QAAQsD,aAAanD,EAAM/E,SAI1D4C,EAAQ6C,KAAK,CACXxD,KAAM,yBACNwC,QAAS,kBAAMM,EAAMnC,QAAQgC,QAAQuD,UAAUpD,EAAM/E,SAI3D+E,EAAMnC,QAAQgC,QAAQwD,YAAY,CAChCC,OAAQ3D,EAAI4D,cAAcC,QAC1BC,OAAQ9D,EAAI4D,cAAcG,QAC1BnF,MAAOyB,EAAM/E,KACb4C,QAASA,Q,UC/RF8F,GAtBIzP,KAAE0P,SAASzP,OAAO,CAEnCkG,WAAY,SAASwJ,EAASxO,GAAU,IAAD,OACrCnB,KAAE0P,SAASrJ,UAAUF,WAAWG,KAAKjG,KAAMsP,EAASxO,GACpDd,KAAKkO,GAAG,aAAa,WACnB,EAAKpN,QAAQyO,UAAY,EAAKzO,QAAQD,MACtC,EAAK2F,SAAS,CAAC3F,MAAO,EAAKC,QAAQ0O,eAErCxP,KAAKkO,GAAG,YAAY,WAClB,EAAK1H,SAAS,CAAC3F,MAAO,EAAKC,QAAQyO,gBAIvCrJ,YAAa,WACXlG,KAAKmG,UAAUzC,mBAAmB1D,OAGpCyP,gBAAiB,WACf,OAAOrN,KAAKC,IAAIrC,KAAKc,QAAQ+D,OAAO,EAAG,MCXrCoC,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuI,SAAU,CACRC,UAAWxI,EAAMI,QAAQ,IAE3BgB,KAAM,CACJlB,QAAS,OACTiB,WAAY,UAEdsH,MAAO,CACLlH,SAAU,QACVmH,YAAa1I,EAAMI,QAAQ,QAK/B,SAASuI,GAAT,GAAmC,IAAnBC,EAAkB,EAAlBA,MAAOC,EAAW,EAAXA,IAAKtF,EAAM,EAANA,IACpBnB,EAAUtC,KAChB,OACE,kBAACwC,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQhB,MAC7C,kBAAC,KAAD,CAAgBG,SAAS,UAAUuC,MAAO,CAACC,UAAW,UAAUR,EAAI,SACnEqF,EAAME,WAAa,GAAK,qCAAaF,EAAME,WAAnB,eACxBF,EAAMG,GAAK,GAAK,qCAAaH,EAAMG,GAAnB,OAHnB,SAIWF,EAJX,KAUJ,SAASG,GAAT,GAAuD,IAArCC,EAAoC,EAApCA,IAAKnP,EAA+B,EAA/BA,KAAMoP,EAAyB,EAAzBA,KAAM5B,EAAmB,EAAnBA,SAAUC,EAAS,EAATA,OACrCnF,EAAUtC,KAChB,OACE,6BACE,kBAACwC,EAAA,EAAD,CAAYC,QAAQ,SAAQ,2BAAI0G,EAAIE,SAAR,OAAwB,0BAAM3G,UAAWJ,EAAQqG,OAAQnB,EAAjC,MAA8CC,IAChG0B,EAAIG,OAAS,GAAK,kBAACT,GAAD,CAAOC,MAAK,gBAAI9O,EAAOmP,EAAIG,QAASP,IAAKI,EAAIJ,IAAKtF,IAAK0F,EAAII,YAC7EH,GAAQA,EAAKE,OAAS,GAAK,kBAACT,GAAD,CAAOC,MAAK,gBAAI9O,EAAOoP,EAAKE,QAASP,IAAKK,EAAKL,IAAKtF,IAAK2F,EAAKG,aACxFJ,EAAIK,QAAWJ,GAAQA,EAAKI,SAC7B,6BACE,kBAAChH,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQmG,UAAU,yCACxDU,EAAIK,QAAU,kBAACX,GAAD,CAAOC,MAAOK,EAAIK,OAAQT,IAAKI,EAAIK,OAAOT,IAAKtF,IAAK0F,EAAII,YACtEH,GAAQA,EAAKI,QAAU,kBAACX,GAAD,CAAOC,MAAOM,EAAKI,OAAQT,IAAKK,EAAKI,OAAOT,IAAKtF,IAAK2F,EAAKG,cAoD9EE,OA3Cf,SAAajF,GAGX,OAAO,IAAI2D,GAAW3D,EAAMkF,UAAW,CACrC9L,OAAQ4G,EAAM5G,OACdhE,MAAO4K,EAAM5K,MACb2O,UAAW/D,EAAM+D,UACjB7K,SAAU8G,EAAM4E,OAEfO,aAAY,WACX,IAAIpD,EAAMzL,SAASC,cAAc,OAEjC,OADAyL,IAASC,OAAO,kBAAC,GAAYjC,GAAW+B,GACjCA,IACN,CAACqD,QAAQ,IACX3C,GAAG,eAAe,SAAC9C,GAClBzL,KAAEwO,SAASC,gBAAgBhD,GAC3B,IAAM9B,EAAU,CACd,CACEX,KAAM,sCAAY8C,EAAMgD,SAAlB,WACNtD,QAAS,WACC4C,OAAOM,KAAK,iDAAiD5C,EAAMgD,SAAU,OACnFH,UAGN,CACE3F,KAAM,sCAAY8C,EAAMiD,OAAlB,WACNvD,QAAS,WACC4C,OAAOM,KAAK,iDAAiD5C,EAAMiD,OAAQ,OACjFJ,WAIR7C,EAAMnC,QAAQgC,QAAQwD,YAAY,CAChCC,OAAQ3D,EAAI4D,cAAcC,QAC1BC,OAAQ9D,EAAI4D,cAAcG,QAC1BnF,MAAO,8BAAOyB,EAAMgD,SAAb,MAA0BhD,EAAMiD,OAAhC,IAAwC,kBAAC,KAAD,CAAgBhG,SAAS,UAAUuC,MAAO,CAACC,UAAW,UAAUO,EAAM2E,IAAII,UAAU,UACnIlH,QAASA,QCuDjB,IAqGewH,GArGFjF,IAAMkF,MAAK,SAActF,GAEpC,IAAM9F,EAAI8F,EAAM3K,QAAQkQ,SAClBC,EAAWpF,IAAMC,OAAOnM,KAAEuR,cAC1BC,EAAUtF,IAAMC,OAAOsF,gBACvBC,EAAQxF,IAAMC,QAAO,GA4F3B,OA1FAD,IAAME,WAAU,WAAO,IAAD,EAjJxB,SAAmBuF,EAAMC,GAKvB,IAJA,IAAMC,EAAOxE,OAAOwE,KAAKF,GACrBG,EAAO,GACPpP,EAAM,EAEDqP,EAAIF,EAAK5N,OAAS,EAAG8N,GAAK,EAAGA,IAAK,CACzC,IAAMtB,EAAMkB,EAAKE,EAAKE,IADmB,EAEhBF,EAAKE,GAAGC,MAAM,KAFE,mBAElCC,EAFkC,KAE1BlD,EAF0B,KAGnCtE,EAAK,CAAEC,SAAUkH,EAAK5K,SAASiL,GAAQtH,IAAKC,UAAWgH,EAAK5K,SAASiL,GAAQpH,KAC7EC,EAAK,CAAEJ,SAAUkH,EAAK5K,SAAS+H,GAAQpE,IAAKC,UAAWgH,EAAK5K,SAAS+H,GAAQlE,KAGnF,IAAI/D,GAAYmL,EAAQL,EAAKP,SAASa,WAAYpL,GAAYiI,EAAQ6C,EAAKP,SAASa,aAGhFN,EAAKO,SAAW1B,EAAIE,SAAWiB,EAAKO,YACpCP,EAAKQ,SAAW3B,EAAIE,SAAWiB,EAAKQ,UAGnC3B,EAAI4B,eAAeT,EAAKxB,QAAWK,EAAImB,EAAKxB,OAAOiC,eAAeT,EAAKtQ,OAA5E,CAGA,GAAIsQ,EAAK9C,SAAU,CACjB,IAAMA,EAAW,CAAEpE,SAAUkH,EAAK5K,SAAS4K,EAAK9C,UAAUnE,IAAKC,UAAWgH,EAAK5K,SAAS4K,EAAK9C,UAAUjE,KACvG,GAAoC,KAAhC+G,EAAKP,SAASiB,KAAKC,UACjBnH,uBAAY0D,EAAUhE,GAAIM,uBAAY0D,EAAUrE,GAAM+H,WAAWZ,EAAKP,SAASiB,KAAKC,UAAa,SAEvG,GAAmC,KAA/BX,EAAKP,SAASiB,KAAKF,SACjBjH,2BAAgBC,uBAAY0D,EAAUrE,GAAK,MAAQ+H,WAAWZ,EAAKP,SAASiB,KAAKF,SAAY,SAEnG,GAAiC,KAA7BR,EAAKP,SAASiB,KAAKG,OACjBb,EAAK9C,WAAamD,GAAU,IAAMxP,KAAKiQ,IAAIjQ,KAAKiQ,IAAIzH,+BAAoBR,EAAIK,GAAMG,+BAAoB6D,EAAUrE,IAAO,KAAOkD,SAASiE,EAAKP,SAASiB,KAAKG,OAAU,SAG5K,GAAIb,EAAK7C,OAAQ,CACf,IAAMA,EAAS,CAAErE,SAAUkH,EAAK5K,SAAS4K,EAAK7C,QAAQpE,IAAKC,UAAWgH,EAAK5K,SAAS4K,EAAK7C,QAAQlE,KACjG,GAAkC,KAA9B+G,EAAKP,SAASvG,GAAGyH,UACfnH,uBAAY2D,EAAQtE,GAAIW,uBAAY2D,EAAQjE,GAAM0H,WAAWZ,EAAKP,SAASvG,GAAGyH,UAAa,SAEjG,GAAiC,KAA7BX,EAAKP,SAASvG,GAAGsH,SACfjH,2BAAgBC,uBAAY2D,EAAQjE,GAAK,MAAQ0H,WAAWZ,EAAKP,SAASvG,GAAGsH,SAAY,SAE/F,GAA+B,KAA3BR,EAAKP,SAASvG,GAAG2H,OACfb,EAAK7C,SAAWA,GAAU,IAAMtM,KAAKiQ,IAAIjQ,KAAKiQ,IAAIzH,+BAAoBR,EAAIK,GAAMG,+BAAoBH,EAAIiE,IAAW,KAAOpB,SAASiE,EAAKP,SAASvG,GAAG2H,OAAU,SAGtK,KAAIb,EAAKf,WACH,IAAMpO,KAAKiQ,IAAIjQ,KAAKiQ,IAAIjC,EAAII,UAAYe,EAAKf,WAAa,KAAOlD,SAASiE,EAAKP,SAASR,UAAU4B,QADxG,CAIA,IAAME,EAAelC,EAAImB,EAAKxB,OAAOwB,EAAKtQ,MAAMsR,QAAO,SAAAC,GAErD,QAAIjB,EAAKP,SAAShB,IAAIyC,SAAWD,EAAIxC,IAAMuB,EAAKP,SAAShB,IAAIyC,YAEzDlB,EAAKlP,KAAOmQ,EAAIE,GAAKnB,EAAKlP,QAGhC,KAAIiQ,EAAa1O,OAAS,GAA1B,CApDyC,MAuDnB0O,EAAaK,QAAO,WAAgBH,GAAhB,uBAAEjC,EAAF,KAAUP,EAAV,WAAwB,CAACO,EAAOiC,EAAIE,GAAI1C,EAAIwC,EAAIxC,OAAM,CAAC,EAAG,IAvD3D,mBAuDlCO,EAvDkC,KAuD1BP,EAvD0B,KA0DrCuB,EAAKP,SAAShB,IAAI4C,SAAW5C,EAAMuB,EAAKP,SAAShB,IAAI4C,SAErDrB,EAAKzD,KAAOyC,EAASgB,EAAKzD,MAE9B2D,EAAKD,EAAKE,IAAM,CACdnB,OAAQA,EACRP,IAAKA,EACLQ,UAAWJ,EAAII,UACfF,SAAUF,EAAIE,UAGhBjO,EAAMD,KAAKC,IAAIA,EAAKkO,OAGtB,GAAIgB,EAAKP,SAAShB,IAAI6C,IAAK,CACzB,IAAMC,EAAS,GAEf9F,OAAO8F,OAAOrB,GAAMsB,SAAQ,SAAA3C,GAC1BA,EAAI4C,MAAQ5C,EAAIJ,IAAII,EAAIG,OAAOH,EAAIE,SACnCwC,EAAO3G,KAAKiE,EAAI4C,UAElBF,EAAOG,MAAK,SAAC5F,EAAG6F,GAAJ,OAAU7F,EAAI6F,KAE1B,IAAMC,EAAQ/Q,KAAKgR,MAAMN,EAAOlP,QAAQ,EAAE0J,SAASiE,EAAKP,SAAShB,IAAI6C,KAAK,MAAQ,EAE5EQ,EAAUP,EAAO1Q,KAAK0L,IAAI1L,KAAKC,IAAI8Q,EAAO,GAAIL,EAAOlP,OAAO,IAElEoJ,OAAOwE,KAAKC,GAAMc,QAAO,SAAA7L,GAAI,OAAI+K,EAAK/K,GAAMsM,MAAQK,KAASN,SAAQ,SAAArM,GAAI,cAAW+K,EAAK/K,MAE3F,MAAO,CAAC+K,EAAMpP,GAuDMiR,CAAU7H,EAAM3K,QAAQwQ,KAAM7F,EAAM3K,SAFlC,mBAEf2Q,EAFe,KAETpP,EAFS,KAIdkR,EA7BV,SAAoB9B,EAAMF,GACxB,IAAIgC,EAAU,IAAIC,IAYlB,OAVAxG,OAAOwE,KAAKD,EAAK7F,QAAQqH,SAAQ,SAAAjG,GAAG,OAAIyG,EAAQE,IAAI3G,MAEhDyE,EAAK9C,UAAY8E,EAAQE,IAAIlC,EAAK9C,UAClC8C,EAAK7C,QAAU6E,EAAQE,IAAIlC,EAAK7C,QAEpC1B,OAAOwE,KAAKC,GAAMsB,SAAQ,SAAChG,GACzB,IAAI2G,EAAM3G,EAAI4E,MAAM,KACpB4B,EAAQE,IAAIC,EAAI,IAChBH,EAAQE,IAAIC,EAAI,OAEX,YAAIH,GAgBOI,CADhBlC,EAtDJ,SAAmBA,EAAMH,EAAMC,GAC7B,cAAkBvE,OAAO8F,OAAOxB,GAAhC,eAAuC,CAAlC,IAAMkB,EAAG,KACNpI,EAAK,CAAEC,SAAUkH,EAAK5K,SAAS6L,EAAIoB,UAAUtJ,IAAKC,UAAWgH,EAAK5K,SAAS6L,EAAIoB,UAAUpJ,KACzFC,EAAK,CAAEJ,SAAUkH,EAAK5K,SAAS6L,EAAIqB,aAAavJ,IAAKC,UAAWgH,EAAK5K,SAAS6L,EAAIqB,aAAarJ,KAEjGuC,EAAMyF,EAAIoB,SAAS,IAAIpB,EAAIqB,YAC1BpC,EAAKO,eAAejF,KACvB0E,EAAK1E,GAAO,CACVwD,OAAQ,EACRP,IAAK,EACLQ,UAAWpO,KAAKuI,MAAMC,+BAAoBR,EAAIK,IAC9C6F,SAAUlO,KAAKuI,MAAMG,2BAAgBC,uBAAYX,EAAIK,GAAK,SAGzDgH,EAAK1E,GAAKiF,eAAe,YAC5BP,EAAK1E,GAAK0D,OAAS,CACjBR,WAAY,EACZC,GAAI,EACJF,IAAK,IAGTyB,EAAK1E,GAAK0D,OAAO+B,EAAIsB,QAAUtB,EAAIuB,OACnCtC,EAAK1E,GAAK0D,OAAOT,KAAOwC,EAAIwB,IAE9B,OAAOvC,EA8BEwC,CAAUxC,EAAMhG,EAAM3K,QAAQ2P,OAAQhF,EAAM3K,SAClB2K,EAAM3K,SAGvCmQ,EAAS3F,QAAQ4I,cAIjB,IADA,IAAMC,EAAWnH,OAAOwE,KAAKC,GACpBC,EAAI,EAAGA,EAAIyC,EAASvQ,OAAQ8N,IAAK,CAAC,IAAD,EACvByC,EAASzC,GAAGC,MAAM,KADK,mBACjCvH,EADiC,KAC7BK,EAD6B,KAElC2F,EAAMqB,EAAK0C,EAASzC,IACpBrB,EAAOoB,EAAKhH,EAAG,IAAIL,GAGzB,KAAIiG,GAAQjG,EAAKK,GAAjB,CAGA,IAAM2J,EAAKjC,WAAWxM,EAAE0B,QAAQoK,KAAK4C,QAAgC,eAAxB5I,EAAM3K,QAAQiP,MAAyB,aAAe,UAC7FjC,EAAMrC,EAAM3K,QAAQgN,KAAO,EAC3ByC,EAASF,EAAOjO,KAAKC,IAAI+N,EAAIG,OAAQF,EAAKE,QAAUH,EAAIG,OAC1D1L,EAASsN,WAAWxM,EAAE0B,QAAQoK,KAAK4C,QAAQC,MAC3CF,IACFvP,GAAW0L,EAAOzC,IAAQzL,EAAIyL,IAASsG,EAAKvP,GAAUA,GAIxD,IAAIhE,EAAQ8E,EAAE0B,QAAQoK,KAAK8C,OAA+B,eAAxB9I,EAAM3K,QAAQiP,MAAyB,aAAe,UAGpFK,EAAIK,QAAWJ,GAAQA,EAAKI,UAC9B5P,EAAQ8E,EAAE0B,QAAQoK,KAAK8C,OAAO9D,OAC9B5L,EAASsN,WAAWxM,EAAE0B,QAAQoK,KAAK4C,QAAQ5D,SAG7CC,GAAI,CACFC,UAAW,CAAC,CAAClF,EAAM3K,QAAQ6F,SAASyD,GAAIE,IAAKmB,EAAM3K,QAAQ6F,SAASyD,GAAII,KAAM,CAACiB,EAAM3K,QAAQ6F,SAAS8D,GAAIH,IAAKmB,EAAM3K,QAAQ6F,SAAS8D,GAAID,MAC1I3J,MAAOA,EACP2O,UAAW7J,EAAE0B,QAAQoK,KAAK8C,OAAO/E,UACjC3K,OAAQA,EACRuL,IAAKA,EACLC,KAAMA,EACNpP,KAAMwK,EAAM3K,QAAQiP,MACpBzG,QAASmC,EAAMnC,QACfmF,SAAUrE,EACVsE,OAAQjE,IAEP+J,MAAMvD,EAAS3F,UAIpB,IAAKoG,EAAI,EAAGA,EAAI6B,EAAQ3P,OAAQ8N,IAAK,CACnC,IAAM+C,EAASlB,EAAQ7B,GAGnB7Q,EAAQ8E,EAAE0B,QAAQkM,QAAQgB,OAAOD,KACjCrP,EAAOU,EAAE0B,QAAQkM,QAAQmB,MAAMJ,KAC/B7I,EAAM3K,QAAQ4K,OAAO+I,KACvB5T,EAAQ8E,EAAE0B,QAAQkM,QAAQgB,OAAOI,SACjC1P,EAAOU,EAAE0B,QAAQkM,QAAQmB,MAAMC,UAE7BF,IAAWhJ,EAAM3K,QAAQ2N,UAAYgG,IAAWhJ,EAAM3K,QAAQ4N,SAChE7N,EAAQ8E,EAAE0B,QAAQkM,QAAQgB,OAAOK,SACjC3P,EAAOU,EAAE0B,QAAQkM,QAAQmB,MAAME,UAIjC1H,GAAO,CACLC,SAAU,CAAC1B,EAAM3K,QAAQ6F,SAAS8N,GAAQnK,IAAKmB,EAAM3K,QAAQ6F,SAAS8N,GAAQjK,KAC9EvF,KAAMA,EACNpE,MAAOA,EACP6F,KAAM+N,EACN9N,SAAU8E,EAAM3K,QAAQ6F,SACxB+E,OAAQD,EAAM3K,QAAQ4K,OAAO+I,GAC7B9I,QAAShG,EAAE0B,QAAQ+F,IACnB9D,QAASmC,EAAMnC,QACfvJ,GAAI,OAAOc,IAEV2T,MAAMvD,EAAS3F,SAIf+F,EAAM/F,UACT6F,EAAQ7F,QAAQuJ,eAAeC,SAAS7D,EAAS3F,SACjD+F,EAAM/F,SAAU,KAEjB,CAACG,EAAO9F,IAEJ,QCxIMoP,GApGDlJ,IAAMkF,MAAK,SAAetF,GAEtC,IAAM9F,EAAI8F,EAAM3K,QAAQkQ,SAClBC,EAAWpF,IAAMC,OAAOnM,KAAEuR,cAC1BC,EAAUtF,IAAMC,OAAOsF,gBACvBC,EAAQxF,IAAMC,QAAO,GA2F3B,OAzFAD,IAAME,WAAU,WACd,IAAMiJ,EAAQvJ,EAAMuJ,MAKpB,GAFA/D,EAAS3F,QAAQ4I,cAEZc,EAAL,CAMA,IADA,IAAMvD,EAAO,GACJC,EAAI,EAAGA,EAAIsD,EAAMpF,MAAMhM,OAAQ8N,IAAK,CAC3C,IAAMhD,EAASsG,EAAMpF,MAAM8B,GACrBjD,EAAWuG,EAAMpF,MAAM8B,EAAE,GACzBtH,EAAK,CAAEC,SAAUoB,EAAM3K,QAAQ6F,SAAS8H,GAAUnE,IAAKC,UAAWkB,EAAM3K,QAAQ6F,SAAS8H,GAAUjE,KACnGC,EAAK,CAAEJ,SAAUoB,EAAM3K,QAAQ6F,SAAS+H,GAAQpE,IAAKC,UAAWkB,EAAM3K,QAAQ6F,SAAS+H,GAAQlE,KACjGuC,EAAM0B,EAAS,IAAIC,EAClB+C,EAAKO,eAAejF,KACvB0E,EAAK1E,GAAO,CACVwD,OAAQ,EACRP,IAAK,EACLQ,UAAWpO,KAAKuI,MAAMC,+BAAoBR,EAAIK,IAC9C6F,SAAUlO,KAAKuI,MAAMG,2BAAgBC,uBAAYX,EAAIK,GAAK,OAC1DgG,OAAQ,CACNR,WAAY,EACZC,GAAI,EACJF,IAAK,KAIXyB,EAAK1E,GAAK0D,OAAOP,IAAM8E,EAAMC,OAAOvD,EAAE,GAAGwD,SAASvC,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,EAAMrI,EAAIoD,KAAI,GACrFuB,EAAK1E,GAAK0D,OAAOP,IAAM8E,EAAMC,OAAOvD,EAAE,GAAG0D,IAAIzC,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,EAAMrI,EAAIoD,KAAI,GAChFuB,EAAK1E,GAAK0D,OAAOR,YAAc+E,EAAMC,OAAOvD,EAAE,GAAGwD,SAASvC,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,EAAMrI,EAAIuI,MAAK,GAC9F5D,EAAK1E,GAAK0D,OAAOR,YAAc+E,EAAMC,OAAOvD,EAAE,GAAG0D,IAAIzC,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,EAAMrI,EAAIuI,MAAK,GACzF5D,EAAK1E,GAAK0D,OAAOT,KAAOgF,EAAMC,OAAOvD,EAAE,GAAGwD,SAASvC,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,EAAMrI,EAAIkD,MAAK,GACvFyB,EAAK1E,GAAK0D,OAAOT,KAAOgF,EAAMC,OAAOvD,EAAE,GAAG0D,IAAIzC,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,EAAMrI,EAAIkD,MAAK,GAIpF,IAAMmE,EAAWnH,OAAOwE,KAAKC,GAC7B,IAAKC,EAAI,EAAGA,EAAIyC,EAASvQ,OAAQ8N,IAAK,CAAC,IAAD,EACnByC,EAASzC,GAAGC,MAAM,KADC,mBAC7BvH,EAD6B,KACzBK,EADyB,KAE9B2F,EAAMqB,EAAK0C,EAASzC,IACpBrB,EAAOoB,EAAKhH,EAAG,IAAIL,GAGrBiG,GAAQjG,EAAKK,GAEjBiG,GAAI,CACFC,UAAW,CAAC,CAAClF,EAAM3K,QAAQ6F,SAASyD,GAAIE,IAAKmB,EAAM3K,QAAQ6F,SAASyD,GAAII,KAAM,CAACiB,EAAM3K,QAAQ6F,SAAS8D,GAAIH,IAAKmB,EAAM3K,QAAQ6F,SAAS8D,GAAID,MAC1I3J,MAAO8E,EAAE0B,QAAQoK,KAAK8C,OAAO9D,OAC7BjB,UAAW7J,EAAE0B,QAAQoK,KAAK8C,OAAO/E,UACjC3K,OAAQsN,WAAWxM,EAAE0B,QAAQoK,KAAK4C,QAAQ5D,QAC1CL,IAAKA,EACLC,KAAMA,EACN/G,QAASmC,EAAMnC,QACfmF,SAAUrE,EACVsE,OAAQjE,IAEP+J,MAAMvD,EAAS3F,SAIpB,IAAKoG,EAAI,EAAGA,EAAIsD,EAAMpF,MAAMhM,OAAQ8N,IAAK,CACvC,IAAMhL,EAAOsO,EAAMpF,MAAM8B,GACzBxE,GAAO,CACLC,SAAU,CAAC1B,EAAM3K,QAAQ6F,SAASD,GAAM4D,IAAKmB,EAAM3K,QAAQ6F,SAASD,GAAM8D,KAC1EvF,KAAMU,EAAE0B,QAAQkM,QAAQmB,MAAME,SAC9B/T,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOK,SAChClO,KAAMA,EACNC,SAAU8E,EAAM3K,QAAQ6F,SACxB+E,OAAQD,EAAM3K,QAAQ4K,OAAOhF,GAC7BiF,QAAShG,EAAE0B,QAAQ+F,IACnB9D,QAASmC,EAAMnC,QACfvJ,GAAI,UAEHyU,MAAMvD,EAAS3F,SAKf+F,EAAM/F,UACT6F,EAAQ7F,QAAQuJ,eAAeC,SAAS7D,EAAS3F,SACjD+F,EAAM/F,SAAU,MAGjB,CAACG,EAAO9F,IAEJ,QC5DM2P,GAxCIzJ,IAAMkF,MAAK,SAAoBtF,GAEhD,IAAMwF,EAAWpF,IAAMC,OAAOnM,KAAEuR,cAC1BC,EAAUtF,IAAMC,OAAOsF,gBACvBC,EAAQxF,IAAMC,QAAO,GA+B3B,OA5BAD,IAAME,WAAU,WAGdkF,EAAS3F,QAAQ4I,cAEjBzI,EAAMmE,MAAMmD,SAAQ,SAAArM,GAAI,OAGtB/G,KAAE4V,SACA9J,EAAM9E,SAASD,GAAM8O,KACrB,CACE3Q,OAAQ,EACRhE,MAAO,OACP4U,aAAa,EACb9S,MAAM,IAEP6R,MAAMvD,EAAS3F,YAIf+F,EAAM/F,UACT6F,EAAQ7F,QAAQuJ,eAAeC,SAAS7D,EAAS3F,SACjD+F,EAAM/F,SAAU,KAGjB,CAACG,EAAM5K,MAAO4K,EAAMmE,MAAOnE,EAAM9E,WAG7B,QCsEM+O,GArGO7J,IAAMkF,MAAK,SAAuBtF,GAEtD,IAAMwF,EAAWpF,IAAMC,OAAOnM,KAAEgW,gBAC1BxE,EAAUtF,IAAMC,OAAOsF,gBACvBC,EAAQxF,IAAMC,QAAO,GA6F3B,OA1FAD,IAAME,WAAU,WAMd,GAHAkF,EAAS3F,QAAQ4I,cAGbzI,EAAM5G,OAAQ,CAChB,IADgB,EACZ+Q,EAAW,KACXnE,EAAO,GAFK,cAGGhG,EAAMmE,OAHT,IAGhB,2BAAgC,CAAC,IAAtBlJ,EAAqB,QAC9B,GAAIkP,EAAU,CACZ,IAAMxL,EAAK,CAAEC,SAAUoB,EAAM9E,SAASiP,GAAUtL,IAAKC,UAAWkB,EAAM9E,SAASiP,GAAUpL,KACnFC,EAAK,CAAEJ,SAAUoB,EAAM9E,SAASD,GAAM4D,IAAKC,UAAWkB,EAAM9E,SAASD,GAAM8D,KAC7EuC,EAAM6I,EAAS,IAAIlP,EAClB+K,EAAKO,eAAejF,KACvB0E,EAAK1E,GAAO,CACVwD,OAAQ,EACRP,IAAK,EACLQ,UAAWpO,KAAKuI,MAAMC,+BAAoBR,EAAIK,IAC9C6F,SAAUlO,KAAKuI,MAAMG,2BAAgBC,uBAAYX,EAAIK,GAAK,SAIhEmL,EAAWlP,GAjBG,8BAsBhB,IAFA,IAAMyN,EAAWnH,OAAOwE,KAAKC,GAEpBC,EAAI,EAAGA,EAAIyC,EAASvQ,OAAQ8N,IAAK,CAAC,IAAD,EACvByC,EAASzC,GAAGC,MAAM,KADK,mBACjCvH,EADiC,KAC7BK,EAD6B,KAElC2F,EAAMqB,EAAK0C,EAASzC,IACpBrB,EAAOoB,EAAKhH,EAAG,IAAIL,GAGrBiG,GAAQjG,EAAKK,GAEjBiG,GAAI,CACFC,UAAW,CAAC,CAAClF,EAAM9E,SAASyD,GAAIE,IAAKmB,EAAM9E,SAASyD,GAAII,KAAM,CAACiB,EAAM9E,SAAS8D,GAAIH,IAAKmB,EAAM9E,SAAS8D,GAAID,MAC1G3J,MAAO4K,EAAM5K,MACb2O,UAAW/D,EAAM+D,UACjB3K,OAAQsN,WAAW1G,EAAM5G,QACzBuL,IAAKA,EACLC,KAAMA,EACN/G,QAASmC,EAAMnC,QACfmF,SAAUrE,EACVsE,OAAQjE,IAEP+J,MAAMvD,EAAS3F,UA/CF,oBAoDDG,EAAMmE,OApDL,IAoDpB,2BAAgC,CAAC,IAAtBlJ,EAAqB,QAC1BD,GAAYC,EAAM+E,EAAMoK,gBAC5B3I,GAAO,CACLC,SAAU,CAAC1B,EAAM9E,SAASD,GAAM4D,IAAKmB,EAAM9E,SAASD,GAAM8D,KAC1DvF,KAAMwG,EAAMxG,KACZpE,MAAO4K,EAAM5K,MACb6F,KAAMA,EACNC,SAAU8E,EAAMqK,YAChBxM,QAASmC,EAAMnC,QACfqC,QAASF,EAAME,QACfyB,IAAK3B,EAAM2B,IACXrN,GAAI,MAAM0L,EAAM1L,KAEfyU,MAAMvD,EAAS3F,UAjEA,8BAqEf+F,EAAM/F,UACT6F,EAAQ7F,QAAQuJ,eAAeC,SAAS7D,EAAS3F,SACjD+F,EAAM/F,SAAU,KAGjB,CACDG,EAAM5K,MACN4K,EAAMxG,KACNwG,EAAMmE,MACNnE,EAAM9E,SACN8E,EAAMsK,KACNtK,EAAME,QACNF,EAAM2B,IACN3B,EAAMqK,YACNrK,EAAMnC,QACNmC,EAAM1L,GACN0L,EAAM5G,OACN4G,EAAM+D,UACN/D,EAAMoK,gBAGD,Q,UCxFHG,GAAYhJ,OAAOwE,KAAKxK,IAExBC,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrC2H,YAAa,CACXjB,SAAU,KAEZoI,iBAAkB,CAChB5N,OAAQlB,EAAMI,QAAQ,GACtBG,WAAY,QAEdwO,gBAAiB,CACfC,WAAY,OAkPDC,GA9OAvK,IAAMkF,MAAK,SAAgBtF,GAExC,IAAM9F,EAAI8F,EAAM3K,QAAQkQ,SAClBqF,EAAS5K,EAAM4K,OACf9M,EAAUtC,KACVqP,EAAoBzK,IAAMC,OAAO,IAAIpM,GAAO,CAAEsI,QAAS,MACvDuO,EAAU,CAAC,EAAE,GAAI5Q,EAAE0B,QAAQwF,IAAI2J,OAAO,KAAM,CAAC,GAAI7Q,EAAE0B,QAAQwF,IAAI2J,OAAO,MAN7B,EAOT3K,IAAM4K,SAAS,MAPN,mBAOxC3H,EAPwC,KAO3B4H,EAP2B,OAQT7K,IAAM4K,SAAS,IARN,mBAQxCE,EARwC,KAQ3BC,EAR2B,KAWzCC,EAAYhL,IAAMC,OAAO,MACzBgL,EAAgBjL,IAAMC,OAAO,MACnCD,IAAME,WAAU,WAGV8K,EAAUvL,UACZuL,EAAUvL,QAAQyL,SAClBF,EAAUvL,QAAU,MAIlBG,EAAMuL,SACRH,EAAUvL,QAAU4B,GAAO,CACzBC,SAAU,CAAC1B,EAAM3K,QAAQ6F,SAAS8E,EAAMuL,QAAQ1M,IAAKmB,EAAM3K,QAAQ6F,SAAS8E,EAAMuL,QAAQxM,KAC1FvF,KAAMU,EAAE0B,QAAQkM,QAAQmB,MAAME,SAC9B/T,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOK,SAChClO,KAAM+E,EAAMuL,OACZrQ,SAAU8E,EAAM3K,QAAQ6F,SACxB+E,OAAQD,EAAM3K,QAAQ4K,OAAOD,EAAMuL,QACnCrL,QAAShG,EAAE0B,QAAQ+F,IACnB9D,QAASmC,EAAMnC,QACfvJ,GAAI,WAEHyU,MAAM6B,EAAO/K,QAAQ2L,gBAEpBH,EAAcxL,UAAYG,EAAMuL,QAClCE,YAAW,WAAQL,EAAUvL,SAAWuL,EAAUvL,QAAQ6L,cAAe,KAI7EL,EAAcxL,QAAUG,EAAMuL,SAC7B,CACDvL,EAAMuL,OACNvL,EAAM3K,QAAQ6F,SACd8E,EAAM3K,QAAQ4K,OACd/F,EAAE0B,QAAQ+F,IACVzH,EAAE0B,QAAQkM,QAAQgB,OAAOK,SACzBjP,EAAE0B,QAAQkM,QAAQmB,MAAME,SACxBnJ,EAAMnC,QACN+M,IAIFxK,IAAME,WAAU,WACV8K,EAAUvL,SACZuL,EAAUvL,QAAQ8L,iBAEnB,CAAC3L,EAAM3K,UAGV+K,IAAME,WAAU,WACduK,EAAkBhL,QAAQxL,eACzB,CAAC6F,IAIJkG,IAAME,WAAU,WACd,IAAM6D,EAAQ,IAAI4D,IAClBxG,OAAOwE,KAAK/F,EAAM3K,QAAQwQ,MAAMyB,SAAQ,SAAAhG,GAAG,OAAI6C,EAAM6D,IAAI1G,EAAI4E,MAAM,KAAK,OACxE,IAAM0F,EAAS,YAAIzH,GAAO/C,KAAI,SAAAC,GAAG,OAAIrB,EAAM3K,QAAQ6F,SAASmG,MAC5D,GAAIuK,EAAOzT,OAAS,EAAG,CACrB,IAAMsP,EAAIoE,qBAAUD,GACpBhB,EAAO/K,QAAQ2L,eAAeM,UAAU,CAAC,CAACrE,EAAEsE,OAAQtE,EAAEuE,QAAS,CAACvE,EAAEwE,OAAQxE,EAAEyE,SAAU,CAACC,SAAQ,OAEhG,CAACnM,EAAM3K,QAAQwQ,KAAM7F,EAAM3K,QAAQ6F,SAAU0P,IAGhDxK,IAAME,WAAU,WACd,GAAIN,EAAMuJ,MAAO,CACf,IAAM9B,EAAIoE,qBAAU7L,EAAMuJ,MAAMpF,MAAM/C,KAAI,SAAAC,GAAG,OAAIrB,EAAM3K,QAAQ6F,SAASmG,OAClE+K,EAASlY,KAAEmY,aAAa,CAAC5E,EAAEsE,OAAQtE,EAAEuE,QAAS,CAACvE,EAAEwE,OAAQxE,EAAEyE,SAC3DI,EAAY1B,EAAO/K,QAAQ2L,eAAeK,YAC3CS,EAAUC,SAASH,IACtBxB,EAAO/K,QAAQ2L,eAAeM,UAAUQ,EAAUnY,OAAOiY,OAG5D,CAACpM,EAAMuJ,MAAOvJ,EAAM3K,QAAQ6F,SAAU0P,IAGzCxK,IAAME,WAAU,WACdkM,MAAM,yDAAyDC,MAAK,SAAAC,GAC9DA,EAASC,IACXD,EAASE,OAAOH,MAAK,SAAAxE,GACnBkD,EAAelD,WAIpB,IAGHjI,EAAMnC,QAAQgC,QAAQwD,YAAc4H,EAEpC,IAAM4B,EAAmB,WACvB5B,EAAe,OAIjB,OACE,kBAAC,KAAD,CACEF,OAAQ,CAAC,QAAS,SAClBjW,KAAM,EACN6L,IAAKiK,EACLE,UAAWA,EACXgC,oBAAoB,EACpB9X,QAAS,EACTE,QAAS,GACT6X,SAAUlC,EAAkBhL,QAC5BmN,cAAe,SAACrN,GACdA,EAAI4D,cAAcZ,kBAClBhD,EAAI4D,cAAc3D,iBAClB,IAAMf,EAAMlI,KAAKuI,MAA0C,KAAnCS,EAAIrF,OAAOuE,IAAMoO,OAAOC,UAAoB,IAC9DnO,EAAMpI,KAAKuI,MAA0C,KAAnCS,EAAIrF,OAAO6S,IAAMF,OAAOC,UAAoB,IACpEjC,EAAe,CACb3H,OAAQ3D,EAAI4D,cAAcC,QAC1BC,OAAQ9D,EAAI4D,cAAcG,QAC1BnF,OAAQM,GAAO,EAAIA,EAAI,MAASA,EAAK,OAASE,GAAO,EAAIA,EAAI,KAAOA,EAAK,KACzElB,QAAS,OAIZwF,GACC,kBAAC+J,GAAA,EAAD,CACExK,MAAM,EACNyK,QAASR,EACTS,gBAAgB,iBAChBC,eACE,CAAEnG,IAAK/D,EAAYI,OAAQ+J,KAAMnK,EAAYC,QAE/C0J,cAAe,SAACrN,GAASA,EAAIC,iBAAkBD,EAAIgD,mBACnD7E,QAAS,CAAC2P,MAAM3P,EAAQuF,cAExB,kBAACrF,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQ0M,kBAAmBnH,EAAY9E,OAC7E8E,EAAYxF,QAAQ1F,OAAS,GAC5B,kBAACuV,GAAA,EAAD,CAAUxP,UAAWJ,EAAQ2M,iBACzBpH,EAAYxF,QAAQuD,KAAI,SAACuM,EAAQ1H,GAAT,OACxB,kBAAC2H,GAAA,EAAD,CAAUC,OAAK,EAACvM,IAAK2E,EAAGvG,QAAS,WAAQiO,EAAOjO,UAAWmN,MAAwBc,EAAOzQ,WAMpG,kBAAC4Q,GAAA,EAAD,CACEC,IAAI,uDAEN,kBAACC,GAAA,EAAD,CAAetM,SAAS,WACtB,kBAACsM,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,eAAegR,SAAS,GAClD,kBAACC,GAAD,CACEhK,MAAOnE,EAAMmE,MACbjJ,SAAU8E,EAAM3K,QAAQ6F,SACxBmP,YAAarK,EAAM3K,QAAQ6F,SAC3B9F,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOsF,IAChC5U,KAAMU,EAAE0B,QAAQkM,QAAQmB,MAAMmF,IAC9BhE,cAAelQ,EAAEkM,QACjBlG,QAAShG,EAAE0B,QAAQ+F,IACnB9D,QAASmC,EAAMnC,QACfvJ,GAAG,SAGP,kBAAC0Z,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,eAAegR,SAAS,GAClD,kBAACC,GAAD,CACEhK,MAAO+G,EACPhQ,SAAU8E,EAAM3K,QAAQ6F,SACxBmP,YAAarK,EAAM3K,QAAQ6F,SAC3B9F,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOsF,IAChC5U,KAAMU,EAAE0B,QAAQkM,QAAQmB,MAAMoF,OAC9BjE,cAAelQ,EAAEkM,QACjBlG,QAAShG,EAAE0B,QAAQ+F,IACnB9D,QAASmC,EAAMnC,QACfvJ,GAAG,SAGP,kBAAC0Z,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,gBAAgBgR,SAAS,GACnD,kBAACC,GAAD,CACEhK,MAAOoG,GACPrP,SAAUK,GACV8O,YAAarK,EAAM3K,QAAQ6F,SAC3B9F,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOvN,KAChC/B,KAAMU,EAAE0B,QAAQkM,QAAQmB,MAAM1N,KAC9B2E,QAAShG,EAAE0B,QAAQ+F,IACnBA,IAAI,OACJ9D,QAASmC,EAAMnC,QACfvJ,GAAG,UAGP,kBAAC0Z,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,4BAA4BgR,SAAS,GAC/D,kBAACI,GAAD,CACEnK,MAAOnE,EAAMmE,MACbjJ,SAAU8E,EAAM3K,QAAQ6F,SACxB6R,SAAUlC,EAAkBhL,QAC5BzK,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOD,QAGpC,kBAACmF,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,qBAAqBgR,SAAS,GACxD,kBAAC,GAAD,CACE7Y,QAAS2K,EAAM3K,QACf0X,SAAUlC,EAAkBhL,QAC5BhC,QAASmC,EAAMnC,WAGnB,kBAACmQ,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,eAAegR,SAAS,GAClD,kBAAC,GAAD,CACE7Y,QAAS2K,EAAM3K,QACf0X,SAAUlC,EAAkBhL,QAC5BhC,QAASmC,EAAMnC,QACf0L,MAAOvJ,EAAMuJ,SAGjB,kBAACyE,GAAA,EAAcC,QAAf,CAAuB/Q,KAAK,iBAAiBgR,SAAS,GACpD,kBAACC,GAAD,CACEhK,MAAOnE,EAAMuO,YACbrT,SAAU8E,EAAM3K,QAAQ6F,SACxBmP,YAAarK,EAAM3K,QAAQ6F,SAC3B9F,MAAO8E,EAAE0B,QAAQkM,QAAQgB,OAAOuF,OAChC7U,KAAMU,EAAE0B,QAAQkM,QAAQmB,MAAMoF,OAC9BjV,OAAQc,EAAE0B,QAAQoK,KAAKpK,QAAQyS,OAASnU,EAAE0B,QAAQoK,KAAK4C,QAAQ5D,YAASnK,EACxEkJ,UAAW7J,EAAE0B,QAAQoK,KAAK8C,OAAO/E,UACjC7D,QAAShG,EAAE0B,QAAQ+F,IACnB9D,QAASmC,EAAMnC,QACfvJ,GAAG,iB,oPCvQA,cACb,OAAO,IAAIka,OAAOC,IAA0B,gDCsCxCjT,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCgT,QAAS,CACPC,MAAO,IACPxS,WAAY,OACZyS,UAAW,8BACXC,OAAQ,IACRjT,QAAS,OACTkT,cAAe,UAEjBvQ,MAAO,CACLwQ,UAAW,SACX7K,UAAWxI,EAAMI,QAAQ,GACzBkT,aAActT,EAAMI,QAAQ,GAC5BkB,WAAYtB,EAAMI,QAAQ,GAC1BD,YAAaH,EAAMI,QAAQ,GAC3BG,WAAY,IACZyF,SAAU,YAEZuN,MAAO,CACLF,UAAW,SACX7K,UAAWxI,EAAMI,QAAQ,IAE3BoT,KAAM,CACJ9Z,MAAO,OACP+Z,OAAQ,UACR,UAAW,CACT/Z,MAAO,SAGXga,SAAU,CACRlL,UAAWxI,EAAMI,QAAQ,GACzBkT,aAActT,EAAMI,QAAQ,GAC5BiT,UAAW,UAEbM,QAAS,CACPC,UAAW,SACXC,UAAW,OACXC,eAAgB,OAChBrT,WAAY,QAEdsT,OAAQ,CACNlT,QAASb,EAAMI,QAAQ,GACvB4T,aAAc,iBACdP,OAAQ,UACR,UAAW,CACThT,WAAY,WAEduF,SAAU,YAEZZ,UAAW,CACT9D,WAAY,EACZnB,YAAa,GAEfiB,KAAM,CACJjB,YAAaH,EAAMI,QAAQ,KAE7B6T,KAAM,CACJzL,UAAWxI,EAAMI,QAAQ,GACzBkB,YAAatB,EAAMI,QAAQ,IAE7B8T,SAAU,CACRhU,QAAS,OACTiB,WAAY,SACZgT,eAAgB,UAElBC,YAAa,CACXpO,SAAU,WACV0F,IAAK1L,EAAMI,QAAQ,GACnBiU,MAAOrU,EAAMI,QAAQ,GACrB1G,MAAO,OACP6H,SAAU,SAEZ+S,KAAM,CACJzT,QAASb,EAAMI,QAAQ,IAEzBmU,UAAW,CACTjB,aAActT,EAAMI,QAAQ,KAC5BoI,UAAW,GAEbgM,aAAc,CACZhM,UAAWxI,EAAMI,QAAQ,GACzB4O,WAAYhP,EAAMI,QAAQ,GAC1BqU,UAAW,kBAEbC,YAAa,CACXpB,aAActT,EAAMI,QAAQ,GAC5BoI,UAAWxI,EAAMI,QAAQ,IAE3BuU,KAAM,CACJC,KAAM,IAERC,KAAM,CACJnO,SAAU,GACVnF,SAAU,QACViH,UAAW,QAEbsM,QAAS,CACPpM,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,GAC5B4O,WAAYhP,EAAMI,QAAQ,GAC1B4U,cAAehV,EAAMI,QAAQ,IAE/B6U,OAAQ,CACNzM,UAAWxI,EAAMI,QAAQ,IAE3B8U,WAAY,CACVhV,QAAS,OACTiB,WAAY,SACZgT,eAAgB,UAElBgB,QAAS,CACP3M,UAAWxI,EAAMI,QAAQ,IAE3BgV,KAAM,CACJvU,QAASb,EAAMI,QAAQ,GACvB4T,aAAc,iBACdP,OAAQ,UACRhT,WAAY,OACZP,QAAS,OACT,UAAW,CACTO,WAAY,YAGhB4U,SAAU,CACRC,cAAe,SACfpV,QAAS,eAEXqV,WAAY,CACV9U,WAAY,OACZP,QAAS,OACTiB,WAAY,UAEdqU,UAAW,CACT/U,WAAY,OACZuT,aAAc,iBACdnT,QAASb,EAAMI,QAAQ,IAEzBqV,WAAY,CACVhC,OAAQ,UACRiC,OAAQ,OACR,UAAW,CACTjV,WAAY,YAGhBkV,eAAgB,CACdC,WAAY,GACZvC,UAAW,SACXrE,WAAYhP,EAAMI,QAAQ,GAC1B4U,cAAehV,EAAMI,QAAQ,GAC7BsI,YAAa1I,EAAMI,QAAQ,KAC3B2U,aAAc/U,EAAMI,QAAQ,MAE9ByV,cAAe,CACb7G,WAAYhP,EAAMI,QAAQ,GAC1B4U,cAAehV,EAAMI,QAAQ,GAC7BsI,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,IAE9B0V,UAAW,CACT7C,MAAO,IACP1R,SAAU,SAEZwU,QAAS,CACPjP,SAAU,IACVkI,WAAYhP,EAAMI,QAAQ,GAC1B4U,cAAehV,EAAMI,QAAQ,GAC7BsI,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,IAE9B4V,aAAc,CACZ/C,MAAO,QAETgD,aAAc,CACZzN,UAAWxI,EAAMI,QAAQ,IAE3B8V,YAAa,CACXlQ,SAAU,WACVqO,MAAO,EACP3I,IAAK,EACLhS,MAAOsG,EAAMU,QAAQyV,KAAK,MAE5BC,YAAa,CACX5N,UAAWxI,EAAMI,QAAQ,GACzBkT,aAActT,EAAMI,QAAQ,QAMhC,SAASiW,GAAevI,GAAuB,IAAD,EAAdwI,IAAc,yDACtCC,EAAO,GACTrI,EAAM,EACNnF,EAAK,EAHmC,cAIxB+E,GAJwB,IAI5C,2BAA4B,CAAC,IAAlBlF,EAAiB,QAC1BsF,GAAOtF,EAAMsF,IACRtF,EAAMsF,MAAOoI,IAChBvN,GAAMH,EAAMG,KAP4B,8BAqB5C,OAXImF,IACEA,EAAM,EACRqI,EAAKvR,KAAKkJ,EAAM,eAGhBqI,EAAKvR,KAAK,gBAGV+D,GACFwN,EAAKvR,KAAK+D,EAAK,MAEVwN,EAAKC,KAAK,SAanB,IAAMC,GAAU/R,IAAMkF,MAAK,YAAwE,IAAtE8M,EAAqE,EAArEA,QAAStU,EAA4D,EAA5DA,QAASuU,EAAmD,EAAnDA,WAAYvS,EAAuC,EAAvCA,KAAMwS,EAAiC,EAAjCA,SAAUC,EAAuB,EAAvBA,UAAWC,EAAY,EAAZA,OACpF,OACEJ,EAAQjR,MAAM,EAAGoR,GAAWnR,KAAI,SAAAqO,GAAM,OACpC,yBACEvR,UAAWJ,EAAQ2R,OACnBnO,IAAKmO,EAAOnb,GACZoL,QAAS,kBAAM2S,EAAW5C,IAC1BgD,aAAc,kBAAMH,EAAS7C,KAE7B,kBAAC5O,GAAA,EAAD,CACEC,UAAW,kBAAC,KAAD,CAAkB7D,SAAS,UACtCa,QAAS,CAACgD,UAAUhD,EAAQgD,WAC5BC,SAAU,EACVC,oBAAqB,GAEpByO,EAAOtL,MAAM/C,KAAI,SAACnG,EAAMgL,GAAP,OAChB,kBAAC7H,GAAA,EAAD,CACEC,KAAK,IACLqB,QAAS,SAAAC,GACPA,EAAIgD,kBACJhD,EAAIC,iBACJE,EAAK7E,IAEPqG,IAAK2E,GACLhL,OAGN,kBAACyX,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,EAAGoC,UAAWJ,EAAQ6R,MAC7C,kBAAC+C,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQ8R,UAAU,kBAAC,KAAD,CAAoB1R,UAAWJ,EAAQhB,OAAS2S,EAAOlL,MAElH,kBAACmO,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQ8R,UAAU,kBAAC,IAAD,CAAsB1R,UAAWJ,EAAQhB,OAAS2S,EAAO5K,SAAlH,QAEF,kBAAC6N,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQ8R,UAAU,kBAAC,KAAD,CAAW1R,UAAWJ,EAAQhB,OAAS2S,EAAOqD,QAG3G,kBAAC9U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,EAAQgS,aAhDvD,SAAoB0C,EAAQ/C,GAC1B,OAAO+C,GACL,IAAK,QAAS,MAAO,IAAI7b,KAAKuI,MAAMuQ,EAAOsD,OAAO,MAClD,IAAK,SAAU,MAAO,IAAIpc,KAAKuI,MAAMuQ,EAAOuD,QAAQ,OACpD,IAAK,UAAW,MAAO,IAAIrc,KAAKuI,MAAMuQ,EAAOwD,SAAS,KACtD,IAAK,MAAO,MAAO,GACnB,QAAS,MAAO,IAAIxD,EAAOhI,EAAE,UA0CoCyL,CAAWV,EAAQ/C,WAqzBzE0D,GA9yBC/S,IAAMkF,MAAK,SAACtF,GAC1B,IAAMoS,EAAUhS,IAAMC,OAAO,MACvB+S,EAAgBhT,IAAMC,OAAO,GAC7BgT,EAAajT,IAAMC,OAAO,MAHI,EAIUD,IAAM4K,SAAS,MAJzB,mBAI7BsI,EAJ6B,KAIZC,EAJY,OAKNnT,IAAM4K,UAAS,GALT,mBAK7BwI,EAL6B,KAKpBC,EALoB,OAMIrT,IAAM4K,UAAS,GANnB,mBAM7BkF,EAN6B,KAMfwD,EANe,OAORtT,IAAM4K,SAAS,IAPP,mBAO7B2I,EAP6B,KAOrBC,EAPqB,OAQVxT,IAAM4K,SAAS,IARL,mBAQ7B6I,EAR6B,KAQtBC,EARsB,OASJ1T,IAAM4K,SAAS,IATX,mBAS7BhI,EAT6B,KASnB+Q,EATmB,OAUR3T,IAAM4K,SAAS,IAVP,mBAU7B/H,EAV6B,KAUrB+Q,EAVqB,OAWN5T,IAAM4K,SAAS,GAXT,mBAW7BiJ,EAX6B,KAWpBC,EAXoB,OAYJ9T,IAAM4K,SAAS,GAZX,mBAY7BmJ,EAZ6B,KAYnBC,EAZmB,OAaVhU,IAAM4K,SAAS,KAbL,mBAa7BqJ,GAb6B,KAatBC,GAbsB,QAcQlU,IAAM4K,SAAS,IAdvB,qBAc7BuJ,GAd6B,MAcbC,GAda,SAeZpU,IAAM4K,UAAS,GAfH,qBAe7ByJ,GAf6B,MAevBC,GAfuB,SAgBZtU,IAAM4K,SAAS,QAhBH,qBAgB7BxV,GAhB6B,MAgBvBmf,GAhBuB,SAiBNvU,IAAM4K,SAAS,IAjBT,qBAiB7B4J,GAjB6B,MAiBpBC,GAjBoB,SAkBAzU,IAAM4K,SAAS,GAlBf,qBAkB7B8J,GAlB6B,MAkBjBC,GAlBiB,SAmBR3U,IAAM4K,SAAS,WAnBP,qBAmB7BwH,GAnB6B,MAmBrBwC,GAnBqB,SAoBV5U,IAAM4K,SAAS,MApBL,qBAoB7BnI,GApB6B,MAoBtBoS,GApBsB,SAqBA7U,IAAM4K,SAAS,MArBf,qBAqB7BkK,GArB6B,MAqBjBC,GArBiB,SAsBN/U,IAAM4K,SAAS,IAtBT,qBAsB7B3E,GAtB6B,MAsBpB+O,GAtBoB,SAuBNhV,IAAM4K,SAAS,IAvBT,qBAuB7B1E,GAvB6B,MAuBpB+O,GAvBoB,SAwBRjV,IAAM4K,SAAS,IAxBP,qBAwB7BsK,GAxB6B,MAwBrBC,GAxBqB,SAyBRnV,IAAM4K,SAAS,IAzBP,qBAyB7BwK,GAzB6B,MAyBrBC,GAzBqB,SA0BNrV,IAAM4K,SAAS,IA1BT,qBA0B7B0K,GA1B6B,MA0BpBC,GA1BoB,SA2BNvV,IAAM4K,SAAS,IA3BT,qBA2B7B4K,GA3B6B,MA2BpBC,GA3BoB,SA4BFzV,IAAM4K,SAAS,IA5Bb,qBA4B7BuH,GA5B6B,MA4BlBuD,GA5BkB,SA6BJ1V,IAAM4K,SAAS,GA7BX,qBA6B7B+K,GA7B6B,MA6BnBC,GA7BmB,SA8BR5V,IAAM4K,SAAS,MA9BP,qBA8B7BiL,GA9B6B,MA8BrBC,GA9BqB,MA+B9BpY,GAAUtC,KAEV2a,GAAgB,CACpBpD,MAAO,SAACnR,EAAG6F,GAAJ,OAAUA,EAAEsL,MAAQnR,EAAEmR,OAC7BC,OAAQ,SAACpR,EAAG6F,GAAJ,OAAUA,EAAEuL,OAASpR,EAAEoR,QAC/BC,QAAS,SAACrR,EAAG6F,GAAJ,OAAUA,EAAEwL,QAAUrR,EAAEqR,SACjC1O,IAAK,SAAC3C,EAAG6F,GAAJ,OAAUA,EAAElD,IAAM3C,EAAE2C,KACzB7F,MAAO,SAACkD,EAAG6F,GAAJ,OAAUA,EAAEA,EAAI7F,EAAE6F,IAUrB2O,GAAgB,WACpB,GAAwB,OAApBhE,EAAQvS,QAAkB,CAC5B,IAAIwW,EAAY,KACZC,EAAY,KAChB,GAAIZ,GAAS,CACX,IAAMa,EAAIb,GAAQxP,MAAM,KACP,IAAbqQ,EAAEpe,OACJke,EAAYxU,SAAS0U,EAAE,IAAM1U,SAAS0U,EAAE,IAAI,GAG5CZ,GAAW,IAGf,GAAIC,GAAS,CACX,IAAMW,EAAIX,GAAQ1P,MAAM,KACP,IAAbqQ,EAAEpe,OACJme,EAAYzU,SAAS0U,EAAE,IAAM1U,SAAS0U,EAAE,IAAI,GAG5CV,GAAW,IAIf,IAAMnf,EAAI0b,EAAQvS,QAAQiH,QAAO,SAAAzF,GAC/B,QACMgF,IAAWhF,EAAIwD,SAAWwB,IAC1BC,IAAWjF,EAAIwD,SAAWyB,IAC1BgP,IAAUjU,EAAIkD,IAAM+Q,IACpBE,IAAUnU,EAAIkD,IAAMiR,IACpBa,GAAahV,EAAImV,OAASH,GAC1BC,GAAajV,EAAImV,OAASF,MAGlC5f,EAAE8Q,KAAK2O,GAAc3D,KACrBe,EAAmB7c,GACnBye,GAAc,QAIZ7C,GAAWtS,EAAMsS,SACjBD,GAAajS,IAAMqW,aAAY,SAAChH,GACpC2D,EAAcvT,QAAUwT,EAAWxT,QAAQ6W,UAC3CzB,GAASxF,GACT6C,GAAS7C,GAET,IAAMhI,EAAIoE,qBAAU4D,EAAOtL,MAAM/C,KAAI,SAAAC,GAAG,OAAIrB,EAAM3K,QAAQ6F,SAASmG,OACnErB,EAAM4K,OAAO/K,QAAQ2L,eAAeM,UAAU,CAAC,CAACrE,EAAEsE,OAAQtE,EAAEuE,QAAS,CAACvE,EAAEwE,OAAQxE,EAAEyE,YACjF,CAAClM,EAAM3K,QAAQ6F,SAAU8E,EAAM4K,OAAQ0H,KAG1ClS,IAAME,WAAU,WACA,OAAVuC,IAAkBwQ,EAAWxT,SAC/BwT,EAAWxT,QAAQ8W,SAAS,EAAGvD,EAAcvT,WAE9C,CAACgD,KAGJzC,IAAME,WAAU,WACV+S,EAAWxT,UACbwT,EAAWxT,QAAQ8W,SAAS,EAAG,GAC/Bb,GAAa,OAEd,CAACxC,IAEJ,IAAMsD,GAAc,SAACC,EAAYxhB,GAE/B,IADA,IACS4Q,EAAI,EAAGA,EAAI4Q,EAAW1e,OAAQ8N,IAAK,CAC1C,IAAM6Q,EAAgBD,EAAW5Q,GAAGpB,SAAW0P,IAAgBsC,EAAW5Q,GAAG9B,MAAMhM,OAAO,GACpF2a,EAAO+D,EAAW5Q,GAAGpB,SAASwP,GAAQE,IAAgBsC,EAAW5Q,GAAG9B,MAAMhM,OAAO,IAH9D,GAGkEkc,IAA4B,KAAMwC,EAAW5Q,GAAG9B,MAAMhM,OAAO,GAClJ4e,EAAIpgB,KAAKgR,MAAMmL,GACfzQ,EAAM1L,KAAKuI,MAAe,IAAR4T,EAAKiE,IACzBxS,EAAMsS,EAAW5Q,GAAG1B,IAGxB,GAAa,SAAT/O,GAAiB,CACnB,IADmB,EACfwhB,EAAW,EACXC,EAAW,KACTC,EAAYL,EAAW5Q,GAAG9B,MAAM,GAChCgT,EAAUN,EAAW5Q,GAAG9B,MAAM0S,EAAW5Q,GAAG9B,MAAMhM,OAAO,GAJ5C,cAKC6H,EAAM3K,QAAQ4K,OAAOiX,IALtB,IAKnB,2BAAqD,CAAC,IAA3C3Z,EAA0C,QAC7CmB,EAAQ/H,KAAKuI,OAEbG,2BAAgBC,uBAAYU,EAAM3K,QAAQ6F,SAASic,GAAU9hB,EAAQ6F,SAASqC,EAAMQ,OAAQ,MAE5FsB,2BAAgBC,uBAAYU,EAAM3K,QAAQ6F,SAASgc,GAAY7hB,EAAQ6F,SAASqC,EAAMQ,OAAQ,OAEhGR,EAAMmB,MAAQ,OACbuY,GAAYvY,EAAQsY,KACvBC,EAAW1Z,EACXyZ,EAAWtY,IAfI,8BAkBnBmY,EAAW5Q,GAAG1I,MAAQ0Z,EACtBJ,EAAW5Q,GAAGwB,GAAKuP,EACnBzS,GAAOyS,EAETH,EAAW5Q,GAAG8M,MAAQxO,EAAIuS,EAC1BD,EAAW5Q,GAAG+M,OAASzO,EAAIsS,EAAW5Q,GAAG9B,MAAMhM,OAC/C0e,EAAW5Q,GAAGgN,QAAU1O,EAAIuO,EAC5B+D,EAAW5Q,GAAG6M,KAAOiE,EAAE,KAAK1U,EAAM,EAAIA,EAAM,IAAIA,GAChDwU,EAAW5Q,GAAGuQ,OAAS1D,EACvB+D,EAAW5Q,GAAG1B,IAAM5N,KAAKuI,MAAMqF,GAC/BsS,EAAW5Q,GAAGpB,SAAWlO,KAAKuI,MAAM4X,GACpCD,EAAW5Q,GAAG3R,GAAK2R,EAErB4Q,EAAWrP,KAAK2O,GAAc3D,KAE9BJ,EAAQvS,QAAUgX,EAClBT,KACA3C,GAAW,GACXyC,GAAU,OAiKZ,OAAIlW,EAAMoX,OAAiB,KAGzB,yBAAKlZ,UAAWJ,GAAQ4Q,SACtB,kBAAC1Q,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,GAAQS,OAA5C,eAEE,kBAAC8Y,EAAA,EAAD,CAAYnZ,UAAWJ,GAAQ8T,YAAalS,QAASM,EAAMsX,OACzD,kBAAC,IAAD,QAIHhE,EAECzQ,GAEE,kBAAC,IAAMtD,SAAP,KACE,yBAAKrB,UAAWJ,GAAQgT,KAAMpR,QAAS,kBAAMuV,GAAS,QACpD,kBAACjX,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQiT,UAAU,kBAAC,KAAD,MAAzD,wBAGF,yBAAK7S,UAAWJ,GAAQuR,SACtB,kBAACqD,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,EAAGoC,UAAWJ,GAAQ6S,QAC7C,kBAAC+B,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQ8S,YAAY,kBAAC,KAAD,CAAoB1S,UAAWJ,GAAQhB,OAAS+F,GAAM0B,MAEnH,kBAACmO,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQ8S,YAAY,kBAAC,IAAD,CAAsB1S,UAAWJ,GAAQhB,OAAS+F,GAAMgC,SAAnH,QAEF,kBAAC6N,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQ8S,YAAY,kBAAC,KAAD,CAAW1S,UAAWJ,GAAQhB,OAAS+F,GAAMiQ,QAG5G,kBAACyE,GAAA,EAAD,CAAUC,MAAM,SACb3U,GAAMsB,MAAM/C,KAAI,SAACnG,EAAMgL,GACtB,IAAMwR,EAAUxR,EAAIpD,GAAMsB,MAAMhM,OAAO,EAAI0K,GAAM2G,OAAOvD,GAAGwD,SAASvC,QAAO,SAACwC,EAAKrI,GAAN,OAAcA,EAAImF,OAASvL,EAAOyO,EAApB,sBAA8BA,GAA9B,CAAmCrI,MAAM,IAAM,GACxI,OACE,kBAACqW,GAAA,EAAD,CAAcpW,IAAK2E,GACjB,kBAAC0R,GAAA,EAAD,CAAyBzZ,UAAWJ,GAAQuS,MAClC,IAANpK,GAAWpD,GAAMtF,OACjB,kBAAC,IAAMgC,SAAP,KACE,kBAACvB,EAAA,EAAD,CAAYC,QAAQ,SAApB,QAAkC4E,GAAMtF,MAAMY,IAA9C,MAAsD0E,GAAMtF,MAAMiB,IAAlE,KAAyEqE,GAAMtF,MAAMkB,IAArF,KACA,kBAACT,EAAA,EAAD,CAAYC,QAAQ,QAAQ2Z,WAAS,GAArC,yBAA6D/U,GAAM4E,IAGtExB,EAAIpD,GAAMsB,MAAMhM,OAAO,GAAK0K,GAAM2G,OAAOvD,GAAGwD,SAAStR,OAAS,GAC7D,kBAAC0f,GAAA,EAAD,CAAO5Z,QAAQ,WAAWC,UAAWJ,GAAQ0S,SAC1C3N,GAAM2G,OAAOvD,GAAGwD,SAASrI,KAAI,SAACkD,EAAOwT,GAAR,OAC9BxT,EAAMkC,OAASvL,EACXqJ,EAAMsF,IACJ,kBAAC5L,EAAA,EAAD,CAAYC,QAAQ,QAAQqD,IAAKwW,GAAIxT,EAAMsF,IAA3C,aAA0DtF,EAAMsF,IAAM,EAAI,IAAM,GAAhF,OAAwFtF,EAAMtF,GAA9F,MAAqGsF,EAAMC,IAA3G,KACA,kBAACvG,EAAA,EAAD,CAAYC,QAAQ,QAAQqD,IAAKwW,GAAIxT,EAAMG,GAA3C,SAAqDH,EAAMtF,GAA3D,MAAkEsF,EAAMC,IAAxE,KACF,QAEFkT,EAAQtf,OAAS,GAAK,kBAAC6F,EAAA,EAAD,CAAYC,QAAQ,SAAQ,2BAAI8T,GAAe0F,GAAS,GAA5B,qBACpD,kBAACzZ,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQ+S,SAAS,qCAAxD,IAAuEkB,GAAelP,GAAM2G,OAAOvD,GAAGwD,YAGzGxD,EAAIpD,GAAMsB,MAAMhM,OAAO,GAAK0K,GAAM2G,OAAOvD,GAAG0D,IAAIxR,OAAS,GACxD,kBAAC0f,GAAA,EAAD,CAAO5Z,QAAQ,WAAWC,UAAWJ,GAAQ0S,SAC1C3N,GAAM2G,OAAOvD,GAAG0D,IAAIvI,KAAI,SAACkD,EAAOwT,GAAR,OACzBxT,EAAMsF,IACF,kBAAC5L,EAAA,EAAD,CAAYC,QAAQ,QAAQqD,IAAKwW,GAAIxT,EAAMsF,IAA3C,iBAA8DtF,EAAMsF,IAAM,EAAI,IAAM,GAApF,OAA4FtF,EAAMtF,GAAlG,MAAyGsF,EAAMC,IAA/G,KAEA,kBAACvG,EAAA,EAAD,CAAYC,QAAQ,QAAQqD,IAAKwW,GAAIxT,EAAMG,GAA3C,aAAyDH,EAAMtF,GAA/D,MAAsEsF,EAAMC,IAA5E,QAEJ,kBAACvG,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQ+S,SAAS,qCAAxD,IAAuEkB,GAAelP,GAAM2G,OAAOvD,GAAG0D,QAI5G,kBAACoO,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CACE5iB,MAEM6Q,EAAIpD,GAAMsB,MAAMhM,OAAO,IAIf0K,GAAM2G,OAAOvD,GAAGwD,SAAStR,QAEzB0K,GAAM2G,OAAOvD,GAAGwD,SAASvC,QAAO,SAACwC,EAAKpF,GAAN,OAAgBoF,GAAOpF,EAAMkC,OAASvL,KAAM,KAI3E4H,GAAM2G,OAAOvD,GAAGwD,SAAStR,SAEzB0K,GAAM2G,OAAOvD,GAAG0D,IAAIxR,QAG7B,OAAS,YAGjB,kBAAC8f,GAAA,EAAD,OAEF,kBAACC,GAAA,EAAD,CAAiBha,UAAWJ,GAAQyS,MAClC,kBAACnS,GAAA,EAAD,CAAMC,KAAK,IAAIqB,QAAS,SAAAC,GAAQA,EAAIC,iBAAkBI,EAAMnC,QAAQgC,QAAQC,KAAK7E,KAAUA,WAWzG,kBAAC,IAAMsE,SAAP,KACE,yBAAKrB,UAAWJ,GAAQmT,YACtB,yBACE/S,UAAWJ,GAAQqT,WACnBzR,QAAS,WACP6T,EAAmB,MACnBvT,EAAMsS,SAAS,MACfF,EAAQvS,QAAU,OAGpB,kBAAC7B,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQuT,gBAAgB,kBAAC,KAAD,MAAiB,6BAAhF,eAEF,yBAAKnT,UAAWJ,GAAQyT,eACtB,kBAAC4G,EAAA,EAAD,CACEla,QAAQ,YACRyB,QAAS,SAACC,GAAD,OAASwV,GAAcxV,EAAIyY,gBACpCC,UAAW,kBAAC,KAAD,OAHb,WAOA,kBAACjL,GAAA,EAAD,CACEkL,SAAUpD,GACVqD,aAAW,EACX3V,KAAM4V,QAAQtD,IACd7H,QAAS,kBAAM8H,GAAc,OAC7BrX,QAAS,CAAC2P,MAAO3P,GAAQ2T,UAEzB,kBAACzT,EAAA,EAAD,CAAYC,QAAQ,SAApB,kBACA,kBAACyU,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,eACNza,QAAQ,WACR0a,MAAOtS,GACPuS,SAAU,SAACjZ,GAAD,OAASyV,GAAWzV,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MAClEC,WAAY,CACVC,aAAc,kBAACC,GAAA,EAAD,CAAgBtX,SAAS,OAAzB,OAEhBuX,gBAAiB,CACfC,QAAQ,GAEVtc,OAAO,QACPsB,UAAWJ,GAAQ4T,gBAGvB,kBAACgB,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,eACNza,QAAQ,WACR0a,MAAOrS,GACPsS,SAAU,SAACjZ,GAAD,OAAS0V,GAAW1V,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MAClEC,WAAY,CACVC,aAAc,kBAACC,GAAA,EAAD,CAAgBtX,SAAS,OAAzB,OAEhBuX,gBAAiB,CACfC,QAAQ,GAEVtc,OAAO,QACPsB,UAAWJ,GAAQ4T,gBAGvB,kBAACgB,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,eACNza,QAAQ,WACR0a,MAAOjD,GACPyD,YAAY,OACZP,SAAU,SAACjZ,GACT,IAAMyZ,EAAMzZ,EAAIrB,OAAOqa,MACnBS,EAAIC,MAAM,eACZ1D,GAAWyD,IAGfH,gBAAiB,CACfC,QAAQ,GAEVtc,OAAO,QACPsB,UAAWJ,GAAQ4T,gBAGvB,kBAACgB,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,eACNza,QAAQ,WACR0a,MAAO/C,GACPuD,YAAY,OACZP,SAAU,SAACjZ,GACT,IAAMyZ,EAAMzZ,EAAIrB,OAAOqa,MACnBS,EAAIC,MAAM,eACZxD,GAAWuD,IAGfH,gBAAiB,CACfC,QAAQ,GAEVtc,OAAO,QACPsB,UAAWJ,GAAQ4T,gBAGvB,kBAACgB,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,UACNza,QAAQ,WACR0a,MAAOrD,GACPsD,SAAU,SAACjZ,GAAD,OAAS4V,GAAU5V,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MACjEC,WAAY,CACVQ,eAAgB,kBAACN,GAAA,EAAD,CAAgBtX,SAAS,SAAzB,MAElBuX,gBAAiB,CACfC,QAAQ,GAEVtc,OAAO,QACPsB,UAAWJ,GAAQ4T,gBAGvB,kBAACgB,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,UACNza,QAAQ,WACR0a,MAAOnD,GACPoD,SAAU,SAACjZ,GAAD,OAAS8V,GAAU9V,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MACjEC,WAAY,CACVQ,eAAgB,kBAACN,GAAA,EAAD,CAAgBtX,SAAS,SAAzB,MAElBuX,gBAAiB,CACfC,QAAQ,GAEVtc,OAAO,QACPsB,UAAWJ,GAAQ4T,iBAIzB,kBAACyG,EAAA,EAAD,CAAQla,QAAQ,YAAY7I,MAAM,UAAUsK,QAAS0W,GAAelY,UAAWJ,GAAQ6T,cAAvF,WAGJ,yBAAKzT,UAAWJ,GAAQyT,eACtB,kBAACkH,GAAA,EAAD,CACEE,MAAOnG,GACPoG,SAzgBK,SAACjZ,GACpBqV,GAAUrV,EAAIrB,OAAOqa,OACG,OAApBvG,EAAQvS,UACVyT,EAAgB9L,KAAK2O,GAAcxW,EAAIrB,OAAOqa,QAC9CpF,EAAmB,YAAID,MAsgBXoF,MAAM,UACNza,QAAQ,WACRzE,KAAK,QACL+f,QAAM,EACNrb,UAAWJ,GAAQ0T,UACnBsH,WAAY,CAACtZ,MAAM,CAACvC,SAAS,QAC7Bgc,gBAAiB,CAACzZ,MAAM,CAACvC,SAAS,SAElC,kBAAC2Q,GAAA,EAAD,CAAU+K,MAAM,SAAhB,cACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAM,UAAhB,eACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAM,WAAhB,uBACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAM,OAAhB,aACU,SAATnjB,IAAmB,kBAACoY,GAAA,EAAD,CAAU+K,MAAM,SAAhB,kBAI1B,yBAAKza,UAAWJ,GAAQoT,WAEpBoC,EAAgBnb,OAAS,EACvB,kBAAC6F,EAAA,EAAD,CAAYC,QAAQ,SAASqV,EAAgBnb,OAA7C,kBAEA,kBAAC6F,EAAA,EAAD,CAAYC,QAAQ,SAApB,oBAGN,yBACE0C,IAAK0S,EACLnV,UAAWJ,GAAQuR,QACnBmK,SAAU,WACJnG,EAAWxT,QAAQ4Z,aAAepG,EAAWxT,QAAQ6W,UAAYrD,EAAWxT,QAAQ6Z,aAAe,KAAOnH,GAAYe,EAAgBnb,QACxI2d,GAAavD,GAAY,MAI7B,kBAACJ,GAAD,CACEC,QAASkB,EACTxV,QAASA,GACTuU,WAAYA,GACZvS,KAAME,EAAMnC,QAAQgC,QAAQC,KAC5BwS,SAAUtS,EAAMsS,SAChBC,UAAWA,GACXC,OAAQA,OAOhB,yBAAKtU,UAAWJ,GAAQuR,QAAQ,IAAIvR,GAAQkS,MAC1C,kBAAChS,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQmS,WAA/C,8BACA,kBAACyC,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,iBACNS,YAAY,KACZlb,QAAQ,WACR0b,UAAQ,EACRhB,MAAOhF,EACPiF,SAAU,SAACjZ,GAAD,OAASiU,EAAUjU,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,SAGrE,kBAACnG,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,aACNza,QAAQ,WACRkb,YAAY,OACZQ,UAAQ,EACRb,WAAY,CACVC,aAAc,kBAACC,GAAA,EAAD,CAAgBtX,SAAS,OAAzB,OAEhBiX,MAAO9E,EACP+E,SAAU,SAACjZ,GAAD,OAASmU,EAASnU,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,UAMtE,kBAACe,EAAA,EAAD,CACEjB,MAAOnjB,GACPqkB,WAAS,EACTjB,SAAU,SAACjZ,EAAKma,GACE,OAAZA,IACFnF,GAAQmF,GACQ,SAAZA,GAAiC,UAAXtH,IACxBwC,GAAU,aAIhB9W,UAAWJ,GAAQsS,aAEnB,kBAAC2J,EAAA,EAAD,CAAcpB,MAAM,QAApB,gBACA,kBAACoB,EAAA,EAAD,CAAcpB,MAAM,QAApB,gBAGS,SAATnjB,GACA,kBAACwkB,GAAA,EAAD,CACEC,QAAS,kBAACC,GAAA,EAAD,CAAQhM,QAASuG,GAAMmE,SAAU,SAACjZ,GAAD,OAAS+U,GAAQ/U,EAAIrB,OAAO4P,YACtEwK,MAAM,qCAGR,kBAAC,IAAMnZ,SAAP,KACE,kBAACvB,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQmS,WAA/C,sCACA,kBAACyC,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,OACNS,YAAY,OACZlb,QAAQ,WACR0a,MAAO3V,EACP4V,SAAU,SAACjZ,GAAD,OAASoU,EAAYpU,EAAIrB,OAAOqa,MAAMwB,gBAChDR,UAAQ,KAGZ,kBAACjH,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAAC4F,GAAA,EAAD,CACEC,MAAM,KACNza,QAAQ,WACRkb,YAAY,OACZR,MAAO1V,EACP2V,SAAU,SAACjZ,GAAD,OAASqU,EAAUrU,EAAIrB,OAAOqa,MAAMwB,sBAQtDjK,GACA,kBAAClS,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQmR,OAC7C,0BAAM/Q,UAAWJ,GAAQoR,KAAMxP,QAAS,kBAAMgU,GAAgB,KAA9D,oBAIHxD,GACC,6BACE,yBAAKhS,UAAWJ,GAAQoS,cACtB,kBAAClS,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQmS,WAA/C,wCACA,kBAACyC,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAACnO,EAAA,EAAD,CAASnG,MAAM,sHACb,kBAACka,GAAA,EAAD,CACEC,MAAM,aACNS,YAAY,IACZlb,QAAQ,WACR0a,MAAO1E,EACP2E,SAAU,SAACjZ,GAAD,OAASuU,EAAWvU,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MAClEc,UAAQ,MAId,kBAACjH,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAACnO,EAAA,EAAD,CAASnG,MAAM,qHACb,kBAACka,GAAA,EAAD,CACEC,MAAM,YACNza,QAAQ,WACRkb,YAAY,IACZR,MAAOxE,EACPyE,SAAU,SAACjZ,GAAD,OAASyU,EAAYzU,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MACnEc,UAAQ,OAKhB,kBAACjH,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,EAAG0D,MAAO,CAAC0E,UAAU,KAC5C,kBAACwO,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAACnO,EAAA,EAAD,CAASnG,MAAM,oDACb,kBAACka,GAAA,EAAD,CACEC,MAAM,iBACNS,YAAY,KACZlb,QAAQ,WACR0a,MAAO/D,GACPgE,SAAU,SAACjZ,GAAD,OAASkV,GAAWlV,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MAClEc,UAAQ,EACRb,WAAY,CACVC,aAAc,kBAACC,GAAA,EAAD,CAAgBtX,SAAS,OAAzB,UAKtB,kBAACgR,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAACnO,EAAA,EAAD,CAASnG,MAAM,0DACb,kBAACka,GAAA,EAAD,CACEC,MAAM,eACNza,QAAQ,WACRkb,YAAY,IACZR,MAAO7D,GACP8D,SAAU,SAACjZ,GAAD,OAASoV,GAAcpV,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MACrEc,UAAQ,QAOlB,yBAAKzb,UAAWJ,GAAQoS,cACtB,kBAAClS,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAWJ,GAAQmS,WAA/C,+BACA,kBAACyC,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAACnO,EAAA,EAAD,CAASnG,MAAM,iDACb,kBAACka,GAAA,EAAD,CACEC,MAAM,iBACNS,YAAY,MACZlb,QAAQ,WACR0a,MAAOtE,GACPuE,SAAU,SAACjZ,GAAD,OAAS2U,GAAS3U,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MAChEc,UAAQ,EACRb,WAAY,CACVC,aAAc,kBAACC,GAAA,EAAD,CAAgBtX,SAAS,OAAzB,YAKtB,kBAACgR,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,kBAACnO,EAAA,EAAD,CAASnG,MAAM,yEACb,kBAACka,GAAA,EAAD,CACEC,MAAM,oBACNS,YAAY,KACZlb,QAAQ,WACR0a,MAAOpE,GACPqE,SAAU,SAACjZ,GAAD,OAAS6U,GAAkB7U,EAAIrB,OAAOqa,MAAME,QAAQ,UAAW,MACzEc,UAAQ,EACRb,WAAY,CACVC,aAAc,kBAACC,GAAA,EAAD,CAAgBtX,SAAS,OAAzB,cAU9B,yBAAKxD,UAAWJ,GAAQsR,WACpBoE,GACA,kBAAC2E,EAAA,EAAD,CAAQla,QAAQ,YAAY7I,MAAM,UAAUoE,KAAK,QAAQkG,QA3nBjD,WAIlB,GAHAsW,GAAY,GACZvC,GAAW,GAEE,SAATje,GAAiB,CACnB,IAAKwK,EAAM3K,QAAQ6F,SAAS8H,GAG1B,OAFAoX,MAAM,0BACN3G,GAAW,IACJ,EAET,GAAIxQ,IAAWjD,EAAM3K,QAAQ6F,SAAS+H,GAGpC,OAFAmX,MAAM,4BACN3G,GAAW,IACJ,EAIX,IADA,IAAM5N,EAAO,GACb,MAAqBtE,OAAOC,QAAQxB,EAAM3K,QAAQwQ,MAAlD,eAAyD,CAAC,IAAD,sBAA7CwU,EAA6C,KAA1CC,EAA0C,OACtCD,EAAEnU,MAAM,KAD8B,mBAChDvH,EADgD,KAC5CK,EAD4C,KAEvD,IAAIhE,GAAY2D,EAAIqB,EAAM3K,QAAQkQ,SAASa,WAAYpL,GAAYgE,EAAIgB,EAAM3K,QAAQkQ,SAASa,SAA9F,CACA,IAAMmU,EAAM,CACV/Q,OAAQ,CACNC,SAAU,GACVE,IAAK,IAEP9E,SAAUyV,EAAEzV,SACZE,UAAWuV,EAAEvV,WAEf,GAAIuV,EAAE7V,GAAI,CACR,GAAI6V,EAAE7V,GAAG,aAAc,CAAC,IAAD,gBACL6V,EAAE7V,GAAG,cADA,IACrB,2BAAmC,CAAC,IAAzB+V,EAAwB,QAC7BA,EAAEvT,GAAK4M,GACX0G,EAAI/Q,OAAOC,SAAS/I,KAAK,CAACkJ,IAAK,EAAGnF,GAAI+V,EAAEvT,GAAI1C,IAAKiW,EAAEjW,IAAKiC,KAAM7H,EAAIK,GAAIA,KAHnD,+BAMvB,GAAIsb,EAAE7V,GAAF,IAAa,CAAC,IAAD,gBACC6V,EAAE7V,GAAF,KADD,IACf,2BAA6B,CAAC,IAAnB+V,EAAkB,QACvBA,EAAEvT,GAAK4M,GACX0G,EAAI/Q,OAAOG,IAAIjJ,KAAK,CAACkJ,IAAK,EAAGnF,GAAI+V,EAAEvT,GAAI1C,IAAKiW,EAAEjW,IAAKiC,KAAM7H,EAAIK,GAAIA,KAHpD,gCAOnB,GAAIsb,EAAE9V,WAAY,CAChB,GAAI8V,EAAE9V,WAAW,aAAc,CAAC,IAAD,gBACb8V,EAAE9V,WAAW,cADA,IAC7B,2BAA2C,CAAC,IAAjCgW,EAAgC,QAChC,GAALA,EAAEvT,GAAQ4M,GAAS2G,EAAEvT,GAAK0M,GAC9B4G,EAAI/Q,OAAOC,SAAS/I,KAAK,CAACkJ,IAAK4Q,EAAEvT,GAAIxC,GAAS,GAAL+V,EAAEvT,GAAO1C,IAAKiW,EAAEjW,IAAKiC,KAAM7H,EAAIK,GAAIA,KAHjD,+BAM/B,GAAIsb,EAAE9V,WAAF,IAAqB,CAAC,IAAD,gBACP8V,EAAE9V,WAAF,KADO,IACvB,2BAAqC,CAAC,IAA3BgW,EAA0B,QAC1B,GAALA,EAAEvT,GAAQ4M,GAAS2G,EAAEvT,GAAK0M,GAC9B4G,EAAI/Q,OAAOG,IAAIjJ,KAAK,CAACkJ,IAAK4Q,EAAEvT,GAAIxC,GAAS,GAAL+V,EAAEvT,GAAO1C,IAAKiW,EAAEjW,IAAKiC,KAAM7H,EAAIK,GAAIA,KAHlD,iCAOvBub,EAAI/Q,OAAOC,UAAY8Q,EAAI/Q,OAAOG,OAC/B9D,EAAKlH,KAAOkH,EAAKlH,GAAM,IAAI8b,KAChC5U,EAAKlH,GAAI+b,IAAI1b,EAAIub,KAIrB,IAAMllB,EAAU,CACdwe,MAAOA,EACPF,OAAQA,EACRgH,WAAYhH,EAAOiB,GAAQ,IAC3BgG,UAAW/G,EAAMe,GAAQ,IACzBT,SAAUA,EACVhQ,MAAO5C,OAAOwE,KAAKF,GACnB3K,SAAU8E,EAAM3K,QAAQ6F,UAG1B,GAAa,SAAT1F,GAAiB,CAAC,IAmCXyQ,GAnCU,WACnB,IAAM9B,EAAQ5C,OAAOwE,KAAK/F,EAAM3K,QAAQ4K,QAClC4a,EAAa1W,EAAM+C,QAAO,SAACwC,EAAKrI,GAAN,OAAcqI,GAAO7D,EAAKxE,GAAO,EAAI,KAAI,GACnEyZ,EAAaC,UAAUC,qBAAuB,EAC9CC,EAAkB,GACpBC,EAAO,EACPrE,EAAa,GA4BXsE,EAAU,GAlCG,aAoCjB,IAAMC,EAAS,IAAIC,GACnBD,EAAOE,UAAY,SAAC3b,GAAD,OA9BH,SAAC,EAAQyb,GAAY,IAAnBG,EAAkB,EAAlBA,KAClB,GAAoB,aAAhBA,EAAKC,OAAuB,CAC9B3E,EAAaA,EAAW4E,OAAOF,EAAKnJ,SACpC,IAAMnX,EAAOkJ,EAAMuX,MACfzgB,EACFmgB,EAAOO,YAAY,CACjB3Y,SAAU/H,EACVgI,OAAQwR,GAAOxZ,EAAO,KACtB4K,KAAMA,EACNxQ,QAASA,EACT4e,QAASA,EACTa,WAAYA,GACZmG,gBAAiBA,KAInBG,EAAOQ,aACPV,GAAQ,KACKJ,GACXlE,GAAYC,EAAYxhB,QAIL,aAAhBkmB,EAAKC,QACZxF,IAAY,SAAA6F,GAAI,OAAIA,EAAMN,EAAKxF,SAAS8E,KAMdS,CAAU3b,EAAKyb,IAC3C,IAAIngB,EAAOkJ,EAAMuX,MACjB,IAAKzgB,EAAQ,cACbmgB,EAAOO,YAAY,CACjB3Y,SAAU/H,EACVgI,OAAQwR,GAAOxZ,EAAO,KACtB4K,KAAMA,EACNxQ,QAASA,EACT4e,QAASA,EACTa,WAAYA,GACZmG,gBAAiBA,IAEnBE,EAAQza,KAAK0a,IAdf,IAASnV,EAAI,EAAGA,EAAI6U,EAAY7U,IAAK,kBAItB,MAYfiQ,GAAUiF,GAnDS,OAqDhB,CACH,IAAMC,EAAS,IAAIC,GACnBD,EAAOE,UAAY,YAAa,IAAXC,EAAU,EAAVA,KACC,aAAhBA,EAAKC,QACP5E,GAAY2E,EAAKnJ,QAAS/c,GAC1B+lB,EAAOQ,aAEgB,aAAhBL,EAAKC,QACZxF,IAAY,SAAA6F,GAAI,OAAIA,EAAKN,EAAKxF,aAGlCqF,EAAOO,YAAY,CACjB3Y,SAAUA,EACVC,OAAQA,GAAkB,KAC1B4C,KAAMA,EACNxQ,QAASA,EACT4e,QAASA,EACTa,WAAYA,GACZmG,gBAAiB,KAEnB/E,GAAU,CAACkF,MA0e4EU,UAAWnI,IAAWE,IAAUI,IAAYE,IAAaS,KAAYE,KAAeT,KAAUE,IAA4B,SAAT/e,KAAoBwN,GAApN,oBAIDwQ,GAAW,kBAACuI,GAAA,EAAD,CAAgB9d,QAAQ,cAAc0a,MAAO5C,GAAU7X,UAAWJ,GAAQgU,cAC1E,OAAXmE,IACC,kBAACkC,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QA3ehB,WAAO,IAAD,gBACLuW,IADK,IAC1B,2BAA6B,SACpB2F,aAFiB,8BAI1BnI,GAAW,GACXyC,GAAU,QAseA,gB,iKChlCR8F,I,2DACJ,WAAYhc,GAAQ,IAAD,+BACjB,cAAMA,IACDoB,IAAMpB,EAAM0F,QAAQtE,IACzB,EAAKmZ,IAAM,KAHM,E,iEAKE,IAAD,OAClBhmB,KAAKgmB,IAAMrmB,KAAE+nB,UAAU1nB,KAAKyL,MAAMoM,OAAQ,CAAC3M,WAAW,EAAMyc,WAAW,IAAQnT,MAAMxU,KAAK6M,KAE1F7M,KAAKgmB,IAAI9a,UAAU0c,OAAO,CAACC,UAAU,EAAOC,SAAS,EAAMC,gBAAgB,IAC3E/nB,KAAKgmB,IAAIgC,SAASJ,SAEd5nB,KAAKyL,MAAMwc,UACbjoB,KAAKgmB,IAAI9X,GAAG,eAAe,kBAAM,EAAKzC,MAAMwc,SAAS,EAAKjC,IAAI1O,kB,6CAK5DtX,KAAKgmB,KACPhmB,KAAKgmB,IAAIjP,W,+BAKX,OAAO,S,GAxBsBmR,cA4BlBC,gBAAYV,IClBrBxgB,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCkW,YAAa,CACXlQ,SAAU,WACVqO,MAAOrU,EAAMI,QAAQ,GACrBsL,IAAK1L,EAAMI,QAAQ,GACnB1G,MAAOsG,EAAMU,QAAQyV,KAAK,MAE5B8K,MAAO,CACLvL,OAAQ,QAEVwL,aAAc,CACZhhB,QAAS,YAGPihB,GAAgB,CAAC1Q,SAAQ,GAqDhB2Q,OAnDf,SAAyB9c,GAEvB,IAAM+c,EAAc/c,EAAMoM,QAAUlY,KAAEmY,aAAa,CAAC,CAAC,MAAQ,OAAQ,CAAC,MAAS,SAEzE2Q,EAAc,WAClBC,EAAUF,GACV/c,EAAMgd,eAGFlf,EAAUtC,KATc,EAUF4E,IAAM4K,UAAS,kBAAM+R,KAVnB,mBAUvB3Q,EAVuB,KAUf6Q,EAVe,KAYxBnS,EAAU,CAAC,EAAE,GAAI9K,EAAMuF,SAAS3J,QAAQwF,IAAI2J,OAAO,KAAM,CAAC,GAAI/K,EAAMuF,SAAS3J,QAAQwF,IAAI2J,OAAO,MAEhGH,EAASxK,IAAMqW,aAAY,SAAAyG,GAClB,OAATA,GACFA,EAAK1R,eAAe2R,WAAWD,EAAK1R,eAAe4R,cAActS,GAAW,MAE7E,CAACA,IAEJ,OAEE,kBAACuS,GAAA,EAAD,CAAQhQ,QAAS2P,EAAapa,KAAM5C,EAAM4C,KAAM0a,WAAW,EAAM9a,SAAS,KAAK1E,QAAS,CAAC2P,MAAO3P,EAAQ6e,QACtG,kBAACY,GAAA,EAAD,0BAEE,kBAAClG,EAAA,EAAD,CAAYnZ,UAAWJ,EAAQ8T,YAAalS,QAASsd,GACnD,kBAAC,IAAD,QAGJ,kBAACQ,GAAA,EAAD,CAAetf,UAAWJ,EAAQ8e,cAChC,kBAAC,KAAD,CAAKjc,IAAKiK,EAAQwB,OAAQ2Q,EAAaF,cAAeA,GAAe/R,UAAWA,EAAW9V,QAAS,GAClG,kBAAC8Y,GAAA,EAAD,CACEC,IAAI,uDAEN,kBAAC,GAAD,CAAoB3B,OAAQA,EAAQoQ,SAAU,SAACpQ,GAAD,OAAY6Q,EAAU7Q,QAGxE,kBAACqR,GAAA,EAAD,KACE,kBAACtF,EAAA,EAAD,CAAQzY,QAASsd,EAAa5nB,MAAM,WAApC,UAGA,kBAAC+iB,EAAA,EAAD,CAAQzY,QAAS,WAAOM,EAAM0d,QAAQtR,GAASpM,EAAMgd,eAAiB5nB,MAAM,UAAU6I,QAAQ,aAA9F,wBCxBO0f,G,WA9Cb,aAAe,qBACb,IACMC,EAAaC,aAAaC,QAAQ,WAExC,GAHgBC,UAGAH,EAAY,CAC1B,IAAKA,GAAcA,EAAa,QAAS,CACvC,IAAMI,EAAazpB,KAAKiM,IAAI,aAAc,IACtCwd,GACFzpB,KAAKmmB,IAAI,aAAc,CAACsD,IAE1BzpB,KAAK+W,OAAO,UACZ/W,KAAK+W,OAAO,QAEVsS,EAAa,SACfrpB,KAAK+W,OAAO,YAEduS,aAAaI,QAAQ,UAfPF,U,iDAmBdnL,GAA4B,IAAtBsL,EAAqB,uDAAN,KACnBvF,EAAQkF,aAAaC,QAAQlL,GACjC,OAAc,OAAV+F,EAAyBuF,EACD,kBAAjBA,GAA8C,OAAjBA,EAC/BC,KAAKC,MAAMzF,GAEbA,I,0BAGL/F,EAAM+F,GACR,IAEE,OADAkF,aAAaI,QAAQrL,EAAuB,kBAAV+F,EAAqBwF,KAAKE,UAAU1F,GAASA,IACxE,EAET,MAAM2F,GAEJ,OADAlE,MAAM,gEACC,K,6BAIJxH,GACLiL,aAAaU,WAAW3L,O,eCZtB4L,GAAU,IAAIb,GAiBpB,SAASc,GAAYC,EAAWtS,EAAQlR,EAAUiJ,GAChD,IAAIyH,EAAS,KAEb,GAAI8S,EAAUrjB,SAAS,eAAgB,CAAC,IAAD,EAChB,CAAC+Q,EAAOuS,WAAYvS,EAAOwS,UAAWxS,EAAOyS,WAAYzS,EAAO0S,WAA9EC,EAD8B,KAC3BC,EAD2B,KACxB9kB,EADwB,KACrB+kB,EADqB,KAErCrT,EAAS,CACP,CAAEhN,SAAUmgB,EAAGjgB,UAAWmgB,GAC1B,CAAErgB,SAAUmgB,EAAGjgB,UAAWkgB,GAC1B,CAAEpgB,SAAU1E,EAAG4E,UAAWkgB,GAC1B,CAAEpgB,SAAU1E,EAAG4E,UAAWmgB,IAG9B,IAZuD,EAYnDhZ,EAAI,GAZ+C,cAapC9B,GAboC,IAavD,2BAA0B,CAAC,IAAhBlJ,EAAe,SAEpB2Q,GAAUsT,4BAAiB,CAAEtgB,SAAU1D,EAASD,GAAM4D,IAAKC,UAAW5D,EAASD,GAAM8D,KAAM6M,IAK9D,kBAA3B1Q,EAASD,GAAMkkB,SAA+BT,EAAUrjB,SAAS,QAAQH,EAASD,GAAMmkB,QAGnFV,EAAUrjB,SAASH,EAASD,GAAMkkB,WAP3ClZ,EAAEvF,KAAKzF,IAhB4C,8BA+BvD,IAHA,IAAIokB,EAAWpZ,EAAEiM,KAAK,KAEhBoN,EAAO,KACA,CACX,IAAIC,EAAQF,EAASle,MAAM,EAAG,KAExBuG,GADN2X,EAAWA,EAASle,MAAM,MACHqe,QAAQ,KAC/B,IAAe,IAAX9X,EAAc,CAChB4X,EAAK5e,KAAK6e,EAAMF,GAChB,MAEFC,EAAK5e,KAAK6e,EAAMF,EAASle,MAAM,EAAGuG,IAClC2X,EAAWA,EAASle,MAAMuG,EAAM,GAElC,OAAO4X,EAgET,IAAM9jB,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCkW,YAAa,CACXlQ,SAAU,WACVqO,MAAOrU,EAAMI,QAAQ,GACrBsL,IAAK1L,EAAMI,QAAQ,GACnB1G,MAAOsG,EAAMU,QAAQyV,KAAK,MAE5BuI,MAAO,CACLpL,aAActT,EAAMI,QAAQ,IAE9B2jB,eAAgB,CACd/d,SAAU,WACV0F,IAAK,MACLoG,KAAM,MACNtJ,WAAY,GACZlH,YAAa,IAEf0iB,KAAM,CACJ9jB,QAAS,OACTK,WAAY,QAEd0jB,QAAS,CACP/iB,OAAQlB,EAAMI,QAAQ,GAAK,QAE7B8jB,OAAQ,CACNrjB,QAASb,EAAMI,QAAQ,IAEzB+jB,WAAY,CACVhjB,WAAY,UAEdijB,WAAY,CACVhR,cAAe,UAEjBvQ,MAAO,CACLwhB,SAAU,OAIRjZ,GAASkZ,cAicAC,OA9bf,SAAqBjgB,GAAQ,IAAD,EAEJI,IAAM4K,SAASwT,GAAQhe,IAAI,MAAO,KAF9B,mBAEnBc,EAFmB,KAEd4e,EAFc,OAGQ9f,IAAM4K,SAASwT,GAAQhe,IAAI,YAAa,KAHhD,mBAGnB2f,EAHmB,KAGRC,EAHQ,OAIUhgB,IAAM4K,UAAS,WACjD,IAAMvD,EAAI+W,GAAQhe,IAAI,aAAc,IACpC,OAAIiH,GAAKA,EAAE4Y,WAAqBnsB,KAAEmY,aAAa5E,EAAE4Y,WAAY5Y,EAAE6Y,YACxD,QAPiB,mBAInBC,EAJmB,KAIPC,EAJO,OASMpgB,IAAM4K,SAASwT,GAAQhe,IAAI,aATjC,mBASnBigB,EATmB,KASTC,EATS,OAUctgB,IAAM4K,UAAS,kBAAMyT,GAAY0B,EAAWI,EAAYvgB,EAAM9E,SAAU8E,EAAMmE,OAAOhM,UAVnG,mBAUnBwoB,EAVmB,KAULC,EAVK,OAWUxgB,IAAM4K,SAASwT,GAAQhe,IAAI,aAAc,KAXnD,mBAWnBwd,EAXmB,KAWP6C,EAXO,OAYUzgB,IAAM4K,SAASwT,GAAQhe,IAAI,eAZrC,mBAYnBsgB,EAZmB,KAYPC,EAZO,OAakB3gB,IAAM4K,SAASgT,EAAW7lB,QAb5C,mBAanB6oB,EAbmB,KAaHC,EAbG,OAcU7gB,IAAM4K,SAASwT,GAAQhe,IAAI,eAdrC,mBAcnB0gB,EAdmB,KAcPC,EAdO,OAeI/gB,IAAM4K,UAAS,GAfnB,mBAenBwI,EAfmB,KAeVC,EAfU,OAgBUrT,IAAM4K,UAAS,GAhBzB,mBAgBnBoW,EAhBmB,KAgBPC,GAhBO,QAiBMjhB,IAAM4K,UAAS1J,GAAc,UAjBnC,qBAiBnBggB,GAjBmB,MAiBTC,GAjBS,SAkBkBnhB,IAAM4K,SAAShL,EAAMuO,YAAY2D,KAAK,MAlBxD,qBAkBnBsP,GAlBmB,MAkBHC,GAlBG,MAmBpB3jB,GAAUtC,KAEVkmB,GAAQthB,IAAM4K,UAAS,kBArL/B,SAAkB9P,EAAUiJ,GAE1B,IADA,IAAIvC,EAAI,IAAImG,IACH9B,EAAI9B,EAAMhM,OAAS,EAAG8N,GAAK,EAAGA,IAAK,CAC1C,IAAMkZ,EAAUjkB,EAASiJ,EAAM8B,IAAIkZ,QACnB,kBAAZA,GACFvd,EAAEoG,IAAI,QAAQ9M,EAASiJ,EAAM8B,IAAImZ,OAEnCxd,EAAEoG,IAAImX,GAER,MAAM,CAAE,eAAR,mBAA0B,YAAIvd,GAAG4F,SA4KEma,CAAS3hB,EAAM9E,SAAU8E,EAAMmE,UAAQ,GAGpE6Y,GAAc,WAClBhd,EAAM4hB,gBAAe,IAIjBC,GAAoBzhB,IAAMC,OAAOL,EAAM4hB,gBAC7CxhB,IAAME,WAAU,WACTke,GAAQhe,IAAI,QACfqhB,GAAkBhiB,SAAQ,KAE3B,IAGHO,IAAME,WAAU,WACdmhB,GAAkBzhB,EAAMuO,YAAY2D,KAAK,QACxC,CAAClS,EAAMuO,cAGV,IAsNMuT,GAAc,SAACC,GAAD,OAAW,SAACC,EAAOC,GACrCV,KAAYU,GAAaF,KAG3B,OACE,kBAAC1E,GAAA,EAAD,CAAQhQ,QAAS2P,GAAapa,KAAM5C,EAAM4C,KAAM0a,WAAW,EAAM9a,SAAS,MACxE,kBAAC+a,GAAA,EAAD,0BAEE,kBAAClG,EAAA,EAAD,CAAYnZ,UAAWJ,GAAQ8T,YAAalS,QAASsd,IACnD,kBAAC,IAAD,QAGJ,kBAACQ,GAAA,EAAD,CAAe0E,UAAQ,EAAChkB,UAAWJ,GAAQ8hB,QAEzC,kBAACuC,GAAA,EAAD,CAAOC,SAAS,UAAUlkB,UAAWJ,GAAQsc,OAA7C,+EAEA,kBAACiI,GAAA,EAAD,CAAWf,SAAuB,WAAbA,GAAuB1I,SAAUkJ,GAAY,UAAWQ,YAAU,SACrF,kBAACC,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAACxkB,EAAA,EAAD,6BAEF,kBAACykB,GAAA,EAAD,CAAkBvkB,UAAWJ,GAAQgiB,YACnC,kBAACrH,GAAA,EAAD,CACEC,MAAM,kBACNljB,KAAK,OACLojB,SAAU,SAACjZ,GACT,IAAI0a,EAAI1a,EAAIrB,OAAOqa,MACnBuH,EAAO7F,GACPmE,GAAQ9D,IAAI,MAAOL,IAErB1B,MAAOrX,EACPohB,WAAY,8CAAmB,kBAACtkB,GAAA,EAAD,CAAMC,KAAK,6CAA6CC,OAAO,UAA/D,SAC/BL,QAAQ,WACRqf,WAAS,MAKf,kBAAC+E,GAAA,EAAD,CAAWf,SAAuB,WAAbA,GAAuB1I,SAAUkJ,GAAY,UAAWQ,YAAU,SACrF,kBAACC,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,MAAoB1kB,QAAS,CAACuR,QAASvR,GAAQ+hB,aAC3E,kBAAC7hB,EAAA,EAAD,CAAYE,UAAWJ,GAAQS,OAA/B,QACA,kBAAC4Z,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QA1MlB,SAACC,GACjBA,EAAIgD,kBACJ8Q,GAAW,GAEXzT,EAAM2iB,QAAQ,IACdnE,GAAQlT,OAAO,QACfkT,GAAQlT,OAAO,YACfoV,EAAY,MAEZjN,GAAW,GACXuJ,OAgMQ,SAFF,OAME,kBAACtY,EAAA,EAAD,CAASnG,MAAO,+CAAqBkiB,EAAa,IAAImC,KAAKnC,GAAWoC,iBAAoB,UACxF,8BACE,kBAAC1K,EAAA,EAAD,CAAQla,QAAQ,YAAY7I,MAAM,UAAUsK,QAvOvC,SAACC,GAClBA,EAAIgD,kBACJ8Q,GAAW,GA/Ba,SAApBqP,EAAqBC,EAAWld,EAAMmd,GAC1C,GAAKD,EAAU5qB,OAAf,CAIA,IAAM4V,EAAM,gBAAgBzM,EAAI,gDAAgDyhB,EAAUrH,MAE1FlP,MAAMuR,6CAA4BhQ,GACjCtB,MAAK,SAASC,GACb,IAAKA,EAASC,GACZ,MAAM,IAAIsW,MAAM,iBAElB,OAAOvW,EAASuF,UAEjBxF,MAAK,SAASyW,GAEb,IAAM9E,EAAQ+E,aAAWD,EAAK,CAACE,QAAQ,EAAMC,eAAgB,SAAUC,eAAe,IACtF,GAAIlF,EAAMmF,OAAOprB,OAAS,EACxB,MAAM,IAAI8qB,MAAM,iBAElBH,EAAkBC,EAAD,sBAAgBld,GAAhB,YAAyBuY,EAAM7C,OAAOyH,MAExDQ,OAAM,SAASlF,GACdmF,QAAQC,IAAIpF,GACZlE,MAAM,oGACN3G,GAAW,WAvBXuP,EAASnd,GAgCXid,CADkBrE,GAAY0B,EAAWI,EAAYvgB,EAAM9E,SAAU8E,EAAMmE,OAC9C,IAAI,SAACmb,GAChC,IAAMzZ,EAvJZ,SAAmByZ,EAAMpkB,GACvB,IADiC,EAC3B2K,EAAO,GADoB,cAEfyZ,GAFe,IAEjC,2BAAwB,CAAC,IAAdvY,EAAa,QAEtB,GAAKA,EAAIwB,IAAT,CAEA,IAAMjH,EAAMyF,EAAIoB,SAAS,IAAIpB,EAAI4c,OAGjC,IAAK9d,EAAKU,eAAejF,GAAM,CAC7B,IAAM3C,EAAK,CAAEC,SAAU1D,EAAS6L,EAAIoB,UAAUtJ,IAAKC,UAAW5D,EAAS6L,EAAIoB,UAAUpJ,KAC/EC,EAAK,CAAEJ,SAAU1D,EAAS6L,EAAI4c,QAAQ9kB,IAAKC,UAAW5D,EAAS6L,EAAI4c,QAAQ5kB,KACjF8G,EAAKvE,GAAO,CACVyD,UAAWpO,KAAKuI,MAAMC,+BAAoBR,EAAIK,IAC9C6F,SAAUlO,KAAKuI,MAAMG,2BAAgBC,uBAAYX,EAAIK,GAAK,QAGzD6G,EAAKvE,GAAKiF,eAAeQ,EAAI6c,YAChC/d,EAAKvE,GAAKyF,EAAI6c,UAAY,IAEvB/d,EAAKvE,GAAKyF,EAAI6c,UAAU7c,EAAI8c,QAC/Bhe,EAAKvE,GAAKyF,EAAI6c,UAAU7c,EAAI8c,MAAQ,IAGtChe,EAAKvE,GAAKyF,EAAI6c,UAAU7c,EAAI8c,MAAMnjB,KAAK,CACrCuG,GAAIF,EAAIuB,OACR/D,IAAKwC,EAAIwB,QA1BoB,8BA6BjC,OAAO1C,EA0HUie,CAAUxE,EAAMtf,EAAM9E,UAEnCsjB,GAAQ9D,IAAI,OAAQ7U,GACpB7F,EAAM2iB,QAAQ9c,GAEd,IAAIke,GAAO,IAAInB,MAAOoB,WACtBxF,GAAQ9D,IAAI,WAAYqJ,GACxBrD,EAAYqD,GAEZvF,GAAQ9D,IAAI,YAAayF,GACzB3B,GAAQ9D,IAAI,aAAc6F,GAE1B9M,GAAW,GACXuJ,SAoN2ElB,SAAUtI,IAAYlS,IAAQ6e,EAAUhoB,QAAUwoB,EAAe,IAAlI,SAEGnN,GAAW,kBAACyQ,GAAA,EAAD,CAAkBzqB,KAAM,GAAI0E,UAAWJ,GAAQ2hB,qBAKnE,kBAACgD,GAAA,EAAD,CAAkBvkB,UAAWJ,GAAQgiB,YACnC,kBAACoE,EAAA,EAAD,CACEC,UAAQ,EACRC,UAAW,EACX/uB,QAASqsB,GACT2C,YAAa,SAACC,GAAD,OACX3D,EAAe,EACb,kBAAClI,GAAA,EAAD,iBAAe6L,EAAf,CAAuB5L,MAAM,qBAAqBza,QAAQ,WAAWqgB,OAAK,EAACoE,WAAY,gDAAgD/B,EAAa,wBAEpJ,kBAAClI,GAAA,EAAD,iBAAe6L,EAAf,CAAuB5L,MAAM,qBAAqBza,QAAQ,eAE9D2a,SAAU,SAACjZ,EAAKgZ,GACVA,EAAMtd,SAAS,iBAAmB8kB,EAAU9kB,SAAS,eACvDgmB,IAAc,IAGdjB,EAAazH,GACbiI,EAAgBnC,GAAY9F,EAAO4H,EAAYvgB,EAAM9E,SAAU8E,EAAMmE,OAAOhM,UAGhFwgB,MAAOwH,EACPoE,cAAe,SAAClvB,EAASivB,GACvB,IAAME,EAAW1d,GAAOzR,EAASivB,GAIjC,OAHKE,EAASnpB,SAAS,gBACrBmpB,EAASC,QAAQ,eAEZD,GAETE,eAAa,EACbC,aAAW,EACXC,mBAAiB,EACjBC,aAAc,SAAAC,GAAM,MAAgB,gBAAXA,EAA4B,0BAAM5mB,UAAWJ,GAAQ4hB,MAAM,kBAAC,KAAD,MAA/B,iCAA2FoF,KAElJ,kBAACC,GAAD,CACEniB,KAAMwe,EACNpE,YAAa,kBAAMqE,IAAc,IACjC3D,QAAS,SAACtR,GACR,IAAMxK,EAAC,sBAAOue,GAAP,CAAkB,gBACzBK,EAAcpU,GACdgU,EAAaxe,GACbgf,EAAgBnC,GAAY7c,EAAGwK,EAAQpM,EAAM9E,SAAU8E,EAAMmE,OAAOhM,SAEtEiU,OAAQmU,EACRhb,SAAUvF,EAAMuF,aAKtB,kBAAC8c,GAAA,EAAD,CAAWf,SAAuB,WAAbA,GAAuB1I,SAAUkJ,GAAY,UAAWQ,YAAU,SACrF,kBAACC,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,MAAoB1kB,QAAS,CAACuR,QAASvR,GAAQ+hB,aAC3E,kBAAC7hB,EAAA,EAAD,CAAYE,UAAWJ,GAAQS,OAA/B,mBACA,kBAAC4Z,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QAzMhB,SAACC,GACnBA,EAAIgD,kBACJ8Q,GAAW,GAEXzT,EAAMglB,UAAU,IAChBxG,GAAQlT,OAAO,UACfkT,GAAQlT,OAAO,cACfyV,EAAc,MAEdtN,GAAW,GACXuJ,OA+LQ,SAFF,OAME,kBAACtY,EAAA,EAAD,CAASnG,MAAO,+CAAqBuiB,EAAe,IAAI8B,KAAK9B,GAAa+B,iBAAoB,UAC5F,8BACE,kBAAC1K,EAAA,EAAD,CAAQla,QAAQ,YAAY7I,MAAM,UAAUsK,QApOrC,SAACC,GACpBA,EAAIgD,kBACJ8Q,GAAW,GAhCe,SAAtBwR,EAAuBxkB,EAAQR,EAAQ+iB,GAC3C,GAAKviB,EAAOtI,OAAZ,CAIA,IAAM4V,EAAM,gBAAgBzM,EAAI,yDAAyD4jB,UAAUzkB,EAAOib,OAE1GlP,MAAMuR,6CAA4BhQ,GACjCtB,MAAK,SAASC,GACb,IAAKA,EAASC,GACZ,MAAM,IAAIsW,MAAM,iBAElB,OAAOvW,EAASuF,UAEjBxF,MAAK,SAASyW,GAEb,IAAM9E,EAAQ+E,aAAWD,EAAK,CAACE,QAAQ,EAAMC,eAAgB,SAAUC,eAAe,IACtF,GAAIlF,EAAMmF,OAAOprB,OAAS,EACxB,MAAM,IAAI8qB,MAAM,iBAGlBgC,EAAoBxkB,EAAD,sBAAaR,GAAb,YAAwBme,EAAM7C,OAAOyH,MAEzDQ,OAAM,SAASlF,GACdmF,QAAQC,IAAIpF,GACZlE,MAAM,oGACN3G,GAAW,WAxBXuP,EAAS/iB,GA+BXglB,CAAoBjH,EAAW7c,QAAS,IAAI,SAACme,GAE3C,IAAMrf,EApPZ,SAAqBqf,GACnB,IADyB,EACnBrf,EAAS,GADU,cAEPqf,GAFO,IAEzB,2BAAwB,CAAC,IAAd/E,EAAa,QAEE,IAApBA,EAAI4K,cAEa,cAAjB5K,EAAIpS,UACa,gBAAjBoS,EAAI6K,WACH7K,EAAI8K,WAAc9K,EAAI+K,aACvB/K,EAAIgL,UAGHtlB,EAAOsG,eAAegU,EAAIiL,aAAcvlB,EAAOsa,EAAIiL,WAAa,IAChEvlB,EAAOsa,EAAIiL,WAAWjf,eAAegU,EAAIpS,YAAalI,EAAOsa,EAAIiL,WAAWjL,EAAIpS,UAAY,IAEjGlI,EAAOsa,EAAIiL,WAAWjL,EAAIpS,UAAUzH,KAAK,CACvCpM,GAAIimB,EAAIkL,aACRtnB,IAAKoc,EAAImL,aACT3nB,KAAMwc,EAAIoL,KACVlnB,IAAK8b,EAAI+K,UACT9mB,IAAK+b,EAAI8K,UACT3mB,MAAO6b,EAAIqL,YArBU,8BAwBzB,OAAO3lB,EA4NY4lB,CAAYvG,GAE3Bd,GAAQ9D,IAAI,SAAUza,GACtBD,EAAMglB,UAAU/kB,GAEhB,IAAI8jB,GAAO,IAAInB,MAAOoB,WACtBxF,GAAQ9D,IAAI,aAAcqJ,GAC1BhD,EAAcgD,GAEdvF,GAAQ9D,IAAI,aAAcsD,GAE1BvK,GAAW,GACXuJ,SAmN6ElB,SAAUtI,IAAYlS,IAAQ0c,EAAW7lB,QAAU6oB,EAAiB,IAAvI,SAEGxN,GAAW,kBAACyQ,GAAA,EAAD,CAAkBzqB,KAAM,GAAI0E,UAAWJ,GAAQ2hB,qBAKnE,kBAACgD,GAAA,EAAD,CAAkBvkB,UAAWJ,GAAQgiB,YACnC,kBAACoE,EAAA,EAAD,CACEC,UAAQ,EACRC,UAAW,EACX/uB,QAASkM,OAAOwE,KAAK+f,IACrBzB,YAAa,SAACC,GAAD,OACXtD,EAAiB,EACf,kBAACvI,GAAA,EAAD,iBAAe6L,EAAf,CAAuB5L,MAAM,iBAAiBza,QAAQ,WAAWqgB,OAAK,EAACoE,WAAY1B,EAAe,qCAAqCA,EAAe,wBAEtJ,kBAACvI,GAAA,EAAD,iBAAe6L,EAAf,CAAuB5L,MAAM,iBAAiBza,QAAQ,eAE1D2a,SAAU,SAACjZ,EAAKgZ,GACdkI,EAAclI,GACdsI,EAAkBtI,EAAMxgB,SAE1BwgB,MAAOqF,MAKb,kBAACqE,GAAA,EAAD,CAAWf,SAAuB,WAAbA,GAAuB1I,SAAUkJ,GAAY,WAChE,kBAACS,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,MAAoB1kB,QAAS,CAACuR,QAASvR,GAAQ+hB,aAC3E,kBAAC7hB,EAAA,EAAD,CAAYE,UAAWJ,GAAQS,OAA/B,aACA,kBAAC4Z,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QAtLhB,SAACC,GACnBA,EAAIgD,kBACJ8Q,GAAW,GAEXzT,EAAM+lB,UAAU,IAChBvH,GAAQlT,OAAO,UACfkT,GAAQlT,OAAO,cACf6V,EAAc,MAEd1N,GAAW,GACXuJ,OA4KQ,SAFF,OAME,kBAACtY,EAAA,EAAD,CAASnG,MAAO,+CAAqB2iB,EAAe,IAAI0B,KAAK1B,GAAa2B,iBAAoB,UAC5F,8BACE,kBAAC1K,EAAA,EAAD,CAAQla,QAAQ,YAAY7I,MAAM,UAAUsK,QArOrC,SAACC,GACpBA,EAAIgD,kBACJ8Q,GAAW,GAIXjH,MAAMuR,8CAFM,gBAAgBzc,EAAI,0DAA0DA,IAGzFmL,MAAK,SAASC,GACb,IAAKA,EAASC,GACZ,MAAM,IAAIsW,MAAM,iBAElB,OAAOvW,EAASuF,UAEjBxF,MAAK,SAASyW,GAEb,IAAM9E,EAAQ+E,aAAWD,EAAK,CAACE,QAAQ,EAAMC,eAAgB,SAAUC,eAAe,IACtF,GAAIlF,EAAMmF,OAAOprB,OAAS,EACxB,MAAM,IAAI8qB,MAAM,iBAGlB,IAAIpd,EAAOuY,EAAM7C,KAAKrU,QAAO,SAACqT,EAAK3H,GAEjC,OADA2H,EAAI3H,EAAKoT,IAAMpT,EACR2H,IACN,IAEHiE,GAAQ9D,IAAI,SAAU7U,GACtB7F,EAAM+lB,UAAUlgB,GAEhB,IAAIke,GAAO,IAAInB,MAAOoB,WACtBxF,GAAQ9D,IAAI,aAAcqJ,GAC1B5C,EAAc4C,GAEdtQ,GAAW,GACXuJ,QAEDwG,OAAM,SAASlF,GACdlE,MAAM,mDACN3G,GAAW,OAgMkEqI,SAAUtI,IAAYlS,GAAzF,SAEGkS,GAAW,kBAACyQ,GAAA,EAAD,CAAkBzqB,KAAM,GAAI0E,UAAWJ,GAAQ2hB,sBAOrE,kBAAC4C,GAAA,EAAD,CAAWf,SAAuB,WAAbA,GAAuB1I,SAAUkJ,GAAY,WAChE,kBAACS,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,MAAoB1kB,QAAS,CAACuR,QAASvR,GAAQ+hB,aAC3E,kBAAC7hB,EAAA,EAAD,CAAYE,UAAWJ,GAAQS,OAA/B,kBACA,kBAAC4Z,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QAvKhB,SAACC,GACnBA,EAAIgD,kBACJ8Q,GAAW,GACXgO,GAAkB,IAClBzhB,EAAMimB,eAAe,IACrBzH,GAAQlT,OAAO,eACfmI,GAAW,KAiKH,SAFF,OAME,8BACE,kBAAC0E,EAAA,EAAD,CAAQla,QAAQ,YAAY7I,MAAM,UAAUsK,QA/LnC,SAACC,GACpBA,EAAIgD,kBACJ8Q,GAAW,GACX,IAH4B,EAGtByS,EAAO1E,GAAetb,MAAM,WAC5B/B,EAAQ,GAJc,cAMV+hB,GANU,IAM5B,2BAAwB,CAAC,IAAd7kB,EAAa,QAClBrB,EAAM9E,SAASmG,IACjB8C,EAAMzD,KAAKW,IARa,8BAY5BogB,GAAkBtd,EAAM+N,KAAK,MAC7BlS,EAAMimB,eAAe9hB,GAGrBsP,GAAW,GACXuJ,MA8K6ElB,SAAUtI,GAA7E,SAEGA,GAAW,kBAACyQ,GAAA,EAAD,CAAkBzqB,KAAM,GAAI0E,UAAWJ,GAAQ2hB,oBAIjE,kBAACgD,GAAA,EAAD,CAAkBvkB,UAAWJ,GAAQgiB,YACnC,kBAACrH,GAAA,EAAD,CACEC,MAAM,oBACNyN,WAAS,EACTC,KAAM,EACNnoB,QAAQ,WACRkb,YAAY,uBACZuJ,WAAW,iEACX/J,MAAO6I,GACP5I,SAAU,SAACjZ,GACT8hB,GAAkB9hB,EAAIrB,OAAOqa,e,mDCvlBvC6F,GAAU,IAAIb,GAGdniB,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCkW,YAAa,CACXlQ,SAAU,WACVqO,MAAOrU,EAAMI,QAAQ,GACrBsL,IAAK1L,EAAMI,QAAQ,GACnB1G,MAAOsG,EAAMU,QAAQyV,KAAK,MAE5B+N,OAAQ,CACNrjB,QAASb,EAAMI,QAAQ,QAK3B,SAASuqB,GAAT,GAAoD,IAAlCxT,EAAiC,EAAjCA,GAAIyT,EAA6B,EAA7BA,QAASpsB,EAAoB,EAApBA,EAAGqsB,EAAiB,EAAjBA,KAASvmB,EAAQ,2CACjD,OACE,kBAAC0S,GAAA,EAAD,CAAME,MAAI,EAACC,GAAIA,GAAM,GACnB,kBAAC4F,GAAA,EAAD,iBACMzY,EADN,CAEE/B,QAAQ,WACRqf,WAAS,EACT9jB,KAAK,QACLmf,MAAO2N,EAAQpgB,MAAM,KAAKgB,QAAO,SAACtF,EAAG6F,GAAJ,OAAU7F,EAAE6F,KAAIvN,GACjD0e,SAAU,SAACjZ,GACT,IAAM4a,EAAMhZ,OAAOilB,OAAO,GAAItsB,GAC9BusB,KAAKlM,EAAK+L,EAAS3mB,EAAIrB,OAAOqa,OAC9B4N,EAAKhM,QAMf,SAASmM,GAAT,GAAiE,IAAzC7T,EAAwC,EAAxCA,GAAIyT,EAAoC,EAApCA,QAASpsB,EAA2B,EAA3BA,EAAGqsB,EAAwB,EAAxBA,KAAM7N,EAAkB,EAAlBA,MAAkB,mDAC9D,OACE,kBAAChG,GAAA,EAAD,CAAME,MAAI,EAACC,GAAIA,GAAM,GACnB,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,SAASya,EAA7B,KACA,kBAACiO,GAAA,EAAD,CACEzI,aAAc,EACd7b,KAAM,IACNzL,IAAK,IACLgwB,KAAM,GACNC,MAAO,CAAC,CAAClO,MAAO,EAAGD,MAAO,iBAAkB,CAACC,MAAO,IAAKD,MAAO,gBAAiB,CAACC,OAAQ,IAAKD,MAAO,YACtGoO,OAAO,EACPnO,MAAO9W,SAASykB,EAAQpgB,MAAM,KAAKgB,QAAO,SAACtF,EAAG6F,GAAJ,OAAU7F,EAAE6F,KAAIvN,IAC1D6sB,kBAAkB,OAClBnO,SAAU,SAACjZ,EAAKgZ,GACd,IAAM4B,EAAMhZ,OAAOilB,OAAO,GAAItsB,GAC9BusB,KAAKlM,EAAK+L,EAAS3N,GACnB4N,EAAKhM,OAMf,SAASyM,GAAT,GAAiE,IAAzCnU,EAAwC,EAAxCA,GAAIyT,EAAoC,EAApCA,QAASpsB,EAA2B,EAA3BA,EAAGqsB,EAAwB,EAAxBA,KAAM7N,EAAkB,EAAlBA,MAAkB,mDAC9D,OACE,kBAAChG,GAAA,EAAD,CAAME,MAAI,EAACC,GAAIA,GAAM,GACnB,kBAACmH,GAAA,EAAD,CACEC,QACE,kBAACC,GAAA,EAAD,CACEhM,SAA0D,IAAjDoY,EAAQpgB,MAAM,KAAKgB,QAAO,SAACtF,EAAG6F,GAAJ,OAAU7F,EAAE6F,KAAIvN,GACnD0e,SAAU,SAACjZ,EAAKgZ,GACd,IAAM4B,EAAMhZ,OAAOilB,OAAO,GAAItsB,GAC9BusB,KAAKlM,EAAK+L,EAAS3N,GACnB4N,EAAKhM,IAEPnlB,MAAM,YAGVsjB,MAAOA,KAKf,SAASuO,GAAT,GAAkE,IAAzCpU,EAAwC,EAAxCA,GAAIyT,EAAoC,EAApCA,QAASpsB,EAA2B,EAA3BA,EAAGqsB,EAAwB,EAAxBA,KAAM7N,EAAkB,EAAlBA,MACvCU,GADyD,mDACnDkN,EAAQpgB,MAAM,KAAKgB,QAAO,SAACtF,EAAG6F,GAAJ,OAAU7F,EAAE6F,KAAIvN,IAChDgtB,EAAa,SAAA9N,GAAG,OAAIA,EAAM,KAAO,MAAMA,EAAI,MAAM,GAAKA,GACtD+N,EAAa,SAAA/N,GAAG,OAAIA,EAAM,KAAO,KAAgB,IAAVA,EAAI,MAAWA,GAC5D,OACE,kBAAC1G,GAAA,EAAD,CAAME,MAAI,EAACC,GAAIA,GAAM,GACnB,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,SAASya,EAA7B,KACA,kBAACiO,GAAA,EAAD,CACEtkB,IAAK,EACLzL,IAAK,KACL+hB,MAAO,CAACuO,EAAW9N,EAAI,IAAK8N,EAAW9N,EAAI,KAC3CgO,iBAAkBD,EAClBJ,kBAAkB,OAClBnO,SAAU,SAACjZ,EAAKgZ,GACd,IAAM4B,EAAMhZ,OAAOilB,OAAO,GAAItsB,GAC9BusB,KAAKlM,EAAK+L,EAAS,CAACa,EAAWxO,EAAM,IAAKwO,EAAWxO,EAAM,MAC3D4N,EAAKhM,IAEPsM,MAAO,CAAC,CAAClO,MAAO,EAAGD,MAAO,SAAU,CAACC,MAAO,IAAMD,MAAO,UAAW,CAACC,MAAO,KAAMD,MAAO,cAKjG,SAAS2O,GAAT,GAAkE,IAAzCxU,EAAwC,EAAxCA,GAAIyT,EAAoC,EAApCA,QAASpsB,EAA2B,EAA3BA,EAAGqsB,EAAwB,EAAxBA,KAAM7N,EAAkB,EAAlBA,MACvCU,GADyD,mDACnDkN,EAAQpgB,MAAM,KAAKgB,QAAO,SAACtF,EAAG6F,GAAJ,OAAU7F,EAAE6F,KAAIvN,IAChDgtB,EAAa,SAAA9N,GAAG,OAAIA,EAAM,KAAQ,KAAQA,GAC1C+N,EAAa,SAAA/N,GAAG,OAAY,OAARA,EAAgB,IAAQA,GAClD,OACE,kBAAC1G,GAAA,EAAD,CAAME,MAAI,EAACC,GAAIA,GAAM,GACnB,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,SAASya,EAA7B,KACA,kBAACiO,GAAA,EAAD,CACEtkB,IAAK,EACLzL,IAAK,KACL+hB,MAAO,CAACuO,EAAW9N,EAAI,IAAK8N,EAAW9N,EAAI,KAC3CgO,iBAAkBD,EAClBJ,kBAAkB,OAClBnO,SAAU,SAACjZ,EAAKgZ,GACd,IAAM4B,EAAMhZ,OAAOilB,OAAO,GAAItsB,GAC9BusB,KAAKlM,EAAK+L,EAAS,CAACa,EAAWxO,EAAM,IAAKwO,EAAWxO,EAAM,MAC3D4N,EAAKhM,IAEPsM,MAAO,CAAC,CAAClO,MAAO,IAAMD,MAAO,aAAc,CAACC,MAAO,IAAOD,MAAO,cAAe,CAACC,MAAO,KAAOD,MAAO,gBAK9G,SAAS4O,GAAT,GAA0D,IAAlCzU,EAAiC,EAAjCA,GAAIyT,EAA6B,EAA7BA,QAASpsB,EAAoB,EAApBA,EAAGqsB,EAAiB,EAAjBA,KAASvmB,EAAQ,2CACvD,OACE,kBAAC0S,GAAA,EAAD,CAAME,MAAI,EAACC,GAAIA,GAAM,GACnB,kBAAC4F,GAAA,EAAD,iBACMzY,EADN,CAEE/B,QAAQ,WACRqf,WAAS,EACT9jB,KAAK,QACLmf,MAAO2N,EAAQpgB,MAAM,KAAKgB,QAAO,SAACtF,EAAG6F,GAAJ,OAAU7F,EAAE6F,KAAIvN,GACjDqf,QAAM,EACNgO,YAAa,CAACpD,UAAU,GACxBvL,SAAU,SAACjZ,GACT,IAAM4a,EAAMhZ,OAAOilB,OAAO,GAAItsB,GAC9BusB,KAAKlM,EAAK+L,EAAS3mB,EAAIrB,OAAOqa,OAC9B4N,EAAKhM,MAGP,kBAAC3M,GAAA,EAAD,CAAU+K,MAAO,GAAjB,WACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,YACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,SACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,QACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,SACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,UACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,WACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,eACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,GAAjB,QACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,IAAjB,cACA,kBAAC/K,GAAA,EAAD,CAAU+K,MAAO,IAAjB,WAmLO6O,OA7Kf,SAAuBxnB,GAAQ,IAAD,EAEII,IAAM4K,UAAS,GAFnB,mBAErBsW,EAFqB,KAEXC,EAFW,KAGtBkG,EAAe,SAAC1F,GAAD,OAAW,SAACC,EAAOC,GACtCV,IAAYU,GAAaF,KAJC,EAMV3hB,IAAM4K,UAAS,kBAAM0c,IAAO1nB,EAAMuF,aANxB,mBAMrBrL,EANqB,KAMlBqsB,EANkB,KAOtBzoB,EAAUtC,KAEVwhB,EAAc,WAElBuJ,EAAKmB,IAAO1nB,EAAMuF,WAClBgc,GAAY,GAEZvhB,EAAMgd,eAGR,OACE,kBAACK,GAAA,EAAD,CAAQhQ,QAAS2P,EAAapa,KAAM5C,EAAM4C,KAAM0a,WAAW,EAAM9a,SAAS,MACxE,kBAAC+a,GAAA,EAAD,gBAEE,kBAAClG,EAAA,EAAD,CAAYnZ,UAAWJ,EAAQ8T,YAAalS,QAASsd,GACnD,kBAAC,IAAD,QAGJ,kBAACQ,GAAA,EAAD,CAAe0E,UAAQ,EAAChkB,UAAWJ,EAAQ8hB,QACzC,kBAACyC,GAAA,EAAD,CAAWf,SAAuB,WAAbA,EAAuB1I,SAAU6O,EAAa,WACjE,kBAAClF,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAACxkB,EAAA,EAAD,0BAEF,kBAACykB,GAAA,EAAD,KACE,kBAAC/P,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAACuqB,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,yBAAyB4N,QAAQ,gCAClE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,wBAAwB4N,QAAQ,+BACjE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,oCAAoC4N,QAAQ,oCAC7E,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,mCAAmC4N,QAAQ,mCAC5E,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,4BAA4B4N,QAAQ,oCACrE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,2BAA2B4N,QAAQ,mCACpE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,oBAAoB4N,QAAQ,+BAC7D,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,mBAAmB4N,QAAQ,8BAC5D,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,qBAAqB4N,QAAQ,gCAC9D,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,oBAAoB4N,QAAQ,+BAC7D,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,8BAA8B4N,QAAQ,kCACvE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,6BAA6B4N,QAAQ,iCACtE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,sBAAsB4N,QAAQ,iCAAiCzT,GAAI,IACpG,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,kBAAkB4N,QAAQ,4BAA4BzT,GAAI,IAC3F,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,sBAAsB4N,QAAQ,6BAA6BzT,GAAI,IAChG,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,2BAA2B4N,QAAQ,kCAAkC5D,WAAW,2CAA2C7P,GAAI,IAChK,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,uBAAuB4N,QAAQ,6BAA6B5D,WAAW,2CAA2C7P,GAAI,IACvJ,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,uBAAuB4N,QAAQ,8BAA8BzT,GAAI,IAClG,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,wBAAwB4N,QAAQ,kCACjE,kBAACD,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,iBAAiB4N,QAAQ,4BAA4B5D,WAAW,iDACjG,kBAACgE,GAAD,CAAexsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,aAAa4N,QAAQ,qBAAqBzT,GAAI,KACrF,kBAACmU,GAAD,CAAe9sB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,kDAAkD4N,QAAQ,8BAA8BzT,GAAI,QAIzI,kBAACwP,GAAA,EAAD,CAAWf,SAAuB,WAAbA,EAAuB1I,SAAU6O,EAAa,WACjE,kBAAClF,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAAC,IAAD,MADF,OAC6B,kBAACxkB,EAAA,EAAD,4BAE7B,kBAACykB,GAAA,EAAD,KACE,kBAAC/P,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACD,WAAS,EAACE,GAAI,GACvB,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,SAApB,6FACA,kBAACooB,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,QAAQ4N,QAAQ,eAAezT,GAAI,GAAIsG,YAAY,SACpF,kBAACkN,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,UAAU4N,QAAQ,gBAAgBzT,GAAI,GAAIsG,YAAY,QACvF,kBAACkN,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,aAAQ4N,QAAQ,aAAazT,GAAI,GAAIsG,YAAY,YAEpF,kBAACzG,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,yBAAK8U,IAAI,wBAAwBC,IAAI,eAK7C,kBAACvF,GAAA,EAAD,CAAWf,SAAuB,WAAbA,EAAuB1I,SAAU6O,EAAa,WACjE,kBAAClF,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAAC,IAAD,MADF,OAC0B,kBAACxkB,EAAA,EAAD,0BAE1B,kBAACykB,GAAA,EAAD,KACE,kBAAC/P,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAAC4W,GAAA,EAAD,CAAME,MAAI,EAACD,WAAS,EAACE,GAAI,GACvB,kBAAC7U,EAAA,EAAD,CAAYC,QAAQ,SAApB,6FACA,kBAACooB,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,QAAQ4N,QAAQ,aAAazT,GAAI,GAAIsG,YAAY,SAClF,kBAACkN,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,UAAU4N,QAAQ,cAAczT,GAAI,GAAIsG,YAAY,QACrF,kBAACkN,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,aAAQ4N,QAAQ,WAAWzT,GAAI,GAAIsG,YAAY,YAElF,kBAACzG,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GACb,yBAAK8U,IAAI,sBAAsBC,IAAI,eAK3C,kBAACvF,GAAA,EAAD,CAAWf,SAAuB,WAAbA,EAAuB1I,SAAU6O,EAAa,WACjE,kBAAClF,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAAC,IAAD,MADF,OACuB,kBAACxkB,EAAA,EAAD,4BAEvB,kBAACykB,GAAA,EAAD,KACE,kBAAC/P,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAACuqB,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,0BAA0B4N,QAAQ,uBAIzE,kBAACjE,GAAA,EAAD,CAAWf,SAAuB,WAAbA,EAAuB1I,SAAU6O,EAAa,WACjE,kBAAClF,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAAC,KAAD,MADF,OAC8B,kBAACxkB,EAAA,EAAD,sBAE9B,kBAACykB,GAAA,EAAD,KACE,kBAAC/P,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAACuqB,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,yBAAyB4N,QAAQ,cAAczT,GAAI,IACpF,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,yBAAyB4N,QAAQ,cAAczT,GAAI,IACpF,kBAACwT,GAAD,CAASnsB,EAAGA,EAAGqsB,KAAMA,EAAM7N,MAAM,+BAA+B4N,QAAQ,UAAUzT,GAAI,OAI5F,kBAACwP,GAAA,EAAD,CAAWf,SAAuB,WAAbA,EAAuB1I,SAAU6O,EAAa,WACjE,kBAAClF,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC5B,kBAAC,KAAD,MADF,OACwB,kBAACxkB,EAAA,EAAD,2BAExB,kBAACykB,GAAA,EAAD,KACE,kBAAC/P,GAAA,EAAD,CAAMC,WAAS,EAAC7W,QAAS,GACvB,kBAACmrB,GAAD,CAAgB/sB,EAAGA,EAAGqsB,KAAM,SAACrsB,GAAOA,EAAEkM,QAAUshB,IAAOxtB,EAAEkM,SAAUmgB,EAAKrsB,IAAKwe,MAAM,0DAA0D4N,QAAQ,eAAezT,GAAI,KACxK,kBAACwU,GAAD,CAAgBntB,EAAGA,EAAGqsB,KAAM,SAACrsB,GAAOA,EAAEkM,QAAUshB,IAAOxtB,EAAEkM,SAAUmgB,EAAKrsB,IAAKwe,MAAM,mCAAmC4N,QAAQ,iBAAiBzT,GAAI,KACnJ,kBAACyU,GAAD,CAAeptB,EAAGA,EAAGqsB,KAAM,SAACrsB,GAAOA,EAAEkM,QAAUshB,IAAOxtB,EAAEkM,SAAUmgB,EAAKrsB,IAAKwe,MAAM,yBAAyB4N,QAAQ,kBAAkBzT,GAAI,KACzI,kBAACmU,GAAD,CAAe9sB,EAAGA,EAAGqsB,KAAM,SAACrsB,GAAOA,EAAEkM,QAAUshB,IAAOxtB,EAAEkM,SAAUmgB,EAAKrsB,IAAKwe,MAAM,gDAAgD4N,QAAQ,mBAAmBzT,GAAI,SAKzK,kBAAC4K,GAAA,EAAD,KACE,kBAACtF,EAAA,EAAD,CACEzY,QAASsd,EACT5nB,MAAM,WAFR,UAMA,kBAAC+iB,EAAA,EAAD,CACEzY,QAAS,WACH4C,OAAOulB,QAAQ,sEAEjB7nB,EAAM8nB,YAAY9nB,EAAM+nB,iBACxBxB,EAAKvmB,EAAM+nB,iBAEXvJ,GAAQ9D,IAAI,WAAY1a,EAAM+nB,iBAE9BxG,GAAY,GACZvhB,EAAMgd,gBAGV5nB,MAAM,aAbR,kBAiBA,kBAAC+iB,EAAA,EAAD,CACEzY,QAAS,WAEPM,EAAM8nB,YAAY5tB,GAElBskB,GAAQ9D,IAAI,WAAYxgB,GAExBqnB,GAAY,GACZvhB,EAAMgd,eAER5nB,MAAM,UACN6I,QAAQ,aAXV,oB,wCClUFzC,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCkW,YAAa,CACXlQ,SAAU,WACVqO,MAAOrU,EAAMI,QAAQ,GACrBsL,IAAK1L,EAAMI,QAAQ,GACnB1G,MAAOsG,EAAMU,QAAQyV,KAAK,MAE5B8K,MAAO,CACLvL,OAAQ,SAEVwO,OAAQ,CACNxb,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,GAC5B4O,WAAY,GAEd2E,QAAS,CACPnL,UAAWxI,EAAMI,QAAQ,GACzBkT,aAActT,EAAMI,QAAQ,GAC5BS,QAASb,EAAMI,QAAQ,IAEzBksB,QAAS,CACPhZ,aAActT,EAAMI,QAAQ,QAKhC,SAASmsB,GAAT,GAA0B,IAAN3zB,EAAK,EAALA,GAClB,OAAO,kBAAC8J,GAAA,EAAD,CAAMC,KAAM,uDAAuD/J,EAAIgK,OAAO,UAA9E,IAAyFhK,GA2QnF4zB,OAvQf,SAAsBloB,GAAQ,IAAD,EAEKI,IAAM4K,SAAS,GAFpB,mBAEpBsW,EAFoB,KAEVC,EAFU,KAYrBzjB,EAAUtC,KAEVwhB,EAAc,WAClBuE,EAAY,GAEZvhB,EAAMgd,eAGR,OACE,kBAACK,GAAA,EAAD,CAAQhQ,QAAS2P,EAAapa,KAAM5C,EAAM4C,KAAM0a,WAAW,EAAM9a,SAAS,KAAK1E,QAAS,CAAC2P,MAAO3P,EAAQ6e,QACtG,kBAACY,GAAA,EAAD,KACE,kBAAC4K,GAAA,EAAD,CACExP,MAAO2I,EACP1I,SAtBa,SAACmJ,EAAOqG,GACV,IAAbA,GACFpL,IACAhd,EAAMqoB,gBAGN9G,EAAY6G,IAiBRE,eAAe,UACfC,UAAU,UACVC,UAAQ,GAER,kBAACC,GAAA,EAAD,CAAK/P,MAAM,cACX,kBAAC+P,GAAA,EAAD,CAAK/P,MAAM,YACX,kBAAC+P,GAAA,EAAD,CAAK/P,MAAM,cAEb,kBAACrB,EAAA,EAAD,CAAYnZ,UAAWJ,EAAQ8T,YAAalS,QAASsd,GACnD,kBAAC,IAAD,QAGJ,kBAACQ,GAAA,EAAD,CAAe0E,UAAQ,EAAChkB,UAAWJ,EAAQ8hB,QACzC,yBAAKxI,OAAqB,IAAbkK,GACX,kBAACzJ,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,+CAAiD,kBAACV,GAAD,CAAW3zB,GAAI,KAAhE,OAIJ,kBAACujB,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,8DAAgE,kBAACV,GAAD,CAAW3zB,GAAI,KAA/E,MAEF,kBAAC0J,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,yDACA,kBAACA,GAAA,EAAD,mFAAqF,kBAACV,GAAD,CAAW3zB,GAAI,KAApG,MAEF,kBAAC0J,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,sDAAwD,kBAACV,GAAD,CAAW3zB,GAAI,KAAvE,KACA,kBAACq0B,GAAA,EAAD,8BAAgC,kBAACV,GAAD,CAAW3zB,GAAI,KAA/C,KACA,kBAACq0B,GAAA,EAAD,gDAAkD,kBAACV,GAAD,CAAW3zB,GAAI,KAAjE,OAIJ,kBAACujB,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,0DACA,kBAACA,GAAA,EAAD,+HAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,uDAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,wDACA,kBAACA,GAAA,EAAD,qCAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,sCACA,kBAACA,GAAA,EAAD,+BAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,+BAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,gDAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAC7F,GAAA,EAAD,CAAO3iB,MAAO,CAAC5C,OAAO,IAAKwlB,SAAS,WAApC,iCACA,kBAACpkB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,6EACA,kBAACA,GAAA,EAAD,2EACA,kBAACA,GAAA,EAAD,yGACA,kBAACA,GAAA,EAAD,mHACA,kBAACA,GAAA,EAAD,oDACA,kBAACA,GAAA,EAAD,iGAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,iDACA,kBAACA,GAAA,EAAD,qCACA,kBAACA,GAAA,EAAD,uBACA,kBAACA,GAAA,EAAD,2EAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,2CACA,kBAACA,GAAA,EAAD,gFACA,kBAACA,GAAA,EAAD,4CAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,4CACA,kBAACA,GAAA,EAAD,6CACA,kBAACA,GAAA,EAAD,yDACA,kBAACA,GAAA,EAAD,gCACA,kBAACA,GAAA,EAAD,sCACA,kBAACA,GAAA,EAAD,4KACA,kBAACA,GAAA,EAAD,8EACA,kBAACA,GAAA,EAAD,uFACA,kBAACA,GAAA,EAAD,uGACA,kBAACA,GAAA,EAAD,4DACA,kBAACA,GAAA,EAAD,qFACA,kBAACA,GAAA,EAAD,qCAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,qEACA,kBAACA,GAAA,EAAD,iCACA,kBAACA,GAAA,EAAD,6BACA,kBAACA,GAAA,EAAD,uCAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,gDACA,kBAACA,GAAA,EAAD,4FAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,gDACA,kBAACA,GAAA,EAAD,yCACA,kBAACA,GAAA,EAAD,mDAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,+BAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,wCACA,kBAACA,GAAA,EAAD,2BACA,kBAACA,GAAA,EAAD,2CACA,kBAACA,GAAA,EAAD,eAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,sJAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,oCACA,kBAACA,GAAA,EAAD,wEACA,kBAACA,GAAA,EAAD,8EACA,kBAACA,GAAA,EAAD,mFAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,WACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,0DACA,kBAACA,GAAA,EAAD,mDAEF,kBAAC3qB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,+CAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,yBACA,kBAACA,GAAA,EAAD,gEACA,kBAACA,GAAA,EAAD,6CAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,8FACA,kBAACA,GAAA,EAAD,+DACA,kBAACA,GAAA,EAAD,mFACA,kBAACA,GAAA,EAAD,wEAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,uBACA,kBAAChqB,EAAA,EAAD,CAAYC,QAAQ,MAApB,SACA,kBAACyqB,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,mCACA,kBAACA,GAAA,EAAD,mCACA,kBAACA,GAAA,EAAD,2CACA,kBAACA,GAAA,EAAD,sDACA,kBAACA,GAAA,EAAD,oEAIN,yBAAKvR,OAAqB,IAAbkK,GACX,kBAACzJ,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,gBACA,kBAACU,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,iCAIJ,kBAAC9Q,GAAA,EAAD,CAAO3Z,UAAWJ,EAAQuR,SACxB,kBAACrR,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQkqB,SAA5C,OACA,kBAACU,GAAA,EAAD,CAAM7a,OAAK,GACT,kBAAC8a,GAAA,EAAD,KAAU,kBAACvqB,GAAA,EAAD,CAAMC,KAAK,0BAAX,YACV,kBAACsqB,GAAA,EAAD,gBAAsB,kBAACvqB,GAAA,EAAD,CAAMC,KAAK,2CAAX,iBAAtB,0B,UCrSRmgB,GAAU,IAAIb,GAGdniB,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrC6C,MAAO,CACLyQ,aAActT,EAAMI,QAAQ,GAC5B2U,aAAc/U,EAAMI,QAAQ,IAE9B8sB,QAAS,CACP1kB,UAAWxI,EAAMI,QAAQ,IAE3B+sB,OAAQ,CACNhtB,YAAaH,EAAMI,QAAQ,IAE7BrG,EAAG,CACDuZ,aAActT,EAAMI,QAAQ,QAIhC,SAASgtB,GAAS9oB,GAEhB,IAAMlC,EAAUtC,KAehB,OACE,6BACGwE,EAAMzB,OAAS,kBAACP,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,EAAQS,OAAQyB,EAAMzB,OACnD,kBAAfyB,EAAMiS,KACZ,kBAACjU,EAAA,EAAD,CAAYC,QAAQ,SAAS+B,EAAMiS,MAEnC,kBAAC,IAAM1S,SAAP,KACGS,EAAMiS,KAAK7Q,KAAI,SAAC6Q,EAAM3d,GAAP,OAAc,kBAAC0J,EAAA,EAAD,CAAYsD,IAAKhN,EAAI2J,QAAQ,QAAQC,UAAWJ,EAAQrI,GAAIwc,OAG9F,yBAAK/T,UAAWJ,EAAQ8qB,SACrB5oB,EAAM4mB,KAAO,GAAK,kBAACzO,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QAlBhC,WACbM,EAAM+oB,QACR/oB,EAAM+oB,SAER/oB,EAAMF,KAAKE,EAAM4mB,KAAK,IAcgDoC,oBAAoB,EAAM9qB,UAAWJ,EAAQ+qB,QAA5F,QAClB7oB,EAAMipB,MAAQ,kBAAC9Q,EAAA,EAAD,CAAQ/iB,MAAM,YAAYsK,QAASM,EAAMipB,KAAMD,oBAAoB,EAAM9qB,UAAWJ,EAAQ+qB,QAA5F,iBACd7oB,EAAMkpB,IACL,kBAAC/Q,EAAA,EAAD,CAAQ/iB,MAAM,UAAU6I,QAAQ,YAAYyB,QAASM,EAAMkpB,IAAKF,oBAAoB,EAAM9qB,UAAWJ,EAAQ+qB,QAA7G,QAEA,kBAAC1Q,EAAA,EAAD,CAAQ/iB,MAAM,UAAU6I,QAAQ,YAAYyB,QA7BjC,WACbM,EAAMmpB,QACRnpB,EAAMmpB,SAERnpB,EAAMF,KAAKE,EAAM4mB,OAyBsDoC,oBAAoB,EAAM9qB,UAAWJ,EAAQ+qB,QAA9G,UAyKKO,OAhKf,YAA2E,IAA3DxH,EAA0D,EAA1DA,eAAgByH,EAA0C,EAA1CA,YAAaC,EAA6B,EAA7BA,WAAYC,EAAiB,EAAjBA,cAEjDC,EAAoBppB,IAAMC,QAAO,GACjCopB,EAAqBrpB,IAAMC,QAAO,GAClCqpB,EAActpB,IAAMC,QAAO,GACjCD,IAAME,WAAU,WACdkpB,EAAkB3pB,QAAUwpB,IAC3B,CAACA,IACJjpB,IAAME,WAAU,WACVgpB,GACFG,EAAmB5pB,QAAU2pB,EAAkB3pB,QAC/C6pB,EAAY7pB,SAAU,EACtB+hB,GAAe,IAER8H,EAAY7pB,SACnB+hB,EAAe6H,EAAmB5pB,WAEnC,CAACypB,EAAY1H,IAEhB,IAAM+H,EAAO,CACX,CACEta,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACNroB,MAAM,8BACN0T,KAAK,uEACLnS,KAAMA,EACNmpB,KAAM,kBAAMnpB,EAAK,SAGvB,CACE8pB,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACNroB,MAAM,uBACN0T,KAAK,mFACLnS,KAAMA,EACNqpB,OAAQ,kBAAMvH,GAAe,QAGnC,CACEvS,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACN3U,KAAK,4EACLnS,KAAMA,EACNipB,OAAQ,kBAAMnH,GAAe,QAGnC,CACEgI,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACN3U,KAAK,oDACLnS,KAAMA,MAGZ,CACE8pB,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACN3U,KAAK,8FACLnS,KAAMA,MAGZ,CACE8pB,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACN3U,KAAK,uEACLnS,KAAMA,EACNqpB,OAAQ,kBAAMvH,GAAe,QAGnC,CACEgI,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACNroB,MAAM,yBACN0T,KAAM,CACJ,iMACA,uFAEFnS,KAAMA,EACNipB,OAAQ,kBAAMnH,GAAe,QAGnC,CACEgI,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACN3U,KAAK,yDACLnS,KAAMA,MAGZ,CACE8pB,SAAU,0BACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,EACNroB,MAAM,aACN0T,KAAK,uGACLnS,KAAMA,MAGZ,CACE8pB,SAAU,uBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,GACNroB,MAAM,gBACN0T,KAAM,CACJ,uCACA,8FAEFnS,KAAMA,MAGZ,CACE8pB,SAAU,sBACVva,QAAS,gBAAEvP,EAAF,EAAEA,KAAF,OACP,kBAACgpB,GAAD,CACElC,KAAM,GACNroB,MAAM,aACN0T,KAAK,+EACLnS,KAAMA,EACNopB,IAAK,WACHppB,EAAK,GACLypB,GAAc,GACd/K,GAAQ9D,IAAI,WAAYqD,eAMlC,OACE,kBAAC,KAAD,CACE4L,MAAOA,EACPE,OAAQP,EACRQ,eAAgB,kBAAMP,GAAc,IACpCQ,gBAAgB,EAChBC,oBAAoB,EACpBC,aAAa,EACbC,eAAe,EACfC,iBAAiB,KCrLjBC,GAAiB7oB,OAAO8F,OAAOgjB,IAG/BtC,GAAkB,CACtBnsB,QAAS,CACPkM,QAAS,CACPgB,OAAQ,CACND,KAAM,QACNK,SAAU,MACVC,SAAU,UACViF,IAAK,QACL7S,KAAM,gBACN8S,OAAQ,YAEVpF,MAAO,CACLJ,KAAM,KACNK,SAAU,KACVC,SAAU,KACViF,IAAK,IACL7S,KAAM,IACN8S,OAAQ,OAGZrI,KAAM,CACJ8C,OAAQ,CACNtE,WAAY,UACZF,MAAO,UACPP,UAAW,SACXiB,OAAQ,WAEV4D,QAAS,CACPC,KAAM,MACNrE,WAAY,IACZF,MAAO,IACPU,OAAQ,KAEVpJ,QAAS,CACPyS,QAAQ,IAGZjN,IAAK,CACH2J,OAAQ,GAEVpJ,IAAK,QAEP6E,KAAM,CACJC,SAAU,GACVE,MAAO,KACPL,QAAS,IAEXtH,GAAI,CACFyH,SAAU,GACVE,MAAO,KACPL,QAAS,IAEXvB,UAAW,CACT4B,MAAO,MAETpC,IAAK,CACHyC,QAAS,GACTG,QAAS,GACTC,IAAK,IAEPhB,QAAS,CACP5M,KAAM,CAAC,EAAG,OACV4B,QAAS,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,IACzCD,OAAQ,CAAC,EAAG,KACZG,UAAU,IAIR6I,GAAQ5C,OAAOwE,KAAKskB,IAGpBvjB,GAASkZ,YAAoB,CAACsK,MAAO,IACrCC,GAAW,SAAUvqB,GACzB,OAAQ,kBAACwqB,EAAA,EAAD,iBAAYxqB,EAAZ,CAAmBR,MAAO,CAAEmP,MAAO,KAAO8b,UAAU,mBAc9D,IAAMjvB,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCgvB,MAAO,CACLt1B,MAAO,2BACPu1B,YAAa,4BAEfC,cAAe,CACbx1B,MAAO,qCAETy1B,IAAK,CACH7tB,WAAYtB,EAAMI,QAAQ,GAC1BoI,UAAWxI,EAAMI,QAAQ,GAAG,EAC5BkT,aAActT,EAAMI,QAAQ,GAAG,GAEjCgvB,MAAO,CACLC,gBAAiB,2BACjB31B,MAAO,OACPkI,aAAc5B,EAAMsvB,MAAM1tB,aAC1B8G,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,GAC5B6S,MAAO,QAETsc,QAAS,CACPF,gBAAiB,2BACjB31B,MAAO,OACPkI,aAAc5B,EAAMsvB,MAAM1tB,aAC1B8G,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,GAC5B6S,MAAO,QAETuc,YAAa,CACXH,gBAAiB,qBACjB31B,MAAO,OACPkI,aAAc5B,EAAMsvB,MAAM1tB,aAC1B8G,YAAa1I,EAAMI,QAAQ,GAC3B4O,WAAYhP,EAAMI,QAAQ,GAC1B4U,cAAehV,EAAMI,QAAQ,GAC7B6S,MAAO,SAETwc,UAAW,CACT7tB,aAAc5B,EAAMsvB,MAAM1tB,aAC1B8tB,OAAQ,YACRT,YAAa,2BACbvmB,YAAa1I,EAAMI,QAAQ,GAC3B2U,aAAc/U,EAAMI,QAAQ,GAC5B4O,WAAY,MACZgG,cAAe,MACf1T,WAAYtB,EAAMI,QAAQ,GAC1BoI,UAAWxI,EAAMI,QAAQ,GAAG,EAC5BkT,aAActT,EAAMI,QAAQ,GAAG,EAC/BF,QAAS,OACTiB,WAAY,UAEdC,KAAM,CACJ1H,MAAO,2BACP,UAAW,CACTA,MAAO,QAET8O,UAAWxI,EAAMI,QAAQ,GACzBkT,aAActT,EAAMI,QAAQ,IAE9BuvB,QAAS,CACP9uB,QAASb,EAAMI,QAAQ,GACvBoI,UAAW,QAEbonB,QAAS,CACPP,gBAAiBrvB,EAAMU,QAAQC,QAAQkvB,KACvCH,OAAQ,iBACRnuB,SAAU,QACVhB,WAAY,SACZiI,UAAW,OAEbsnB,aAAc,CACZp2B,MAAOsG,EAAMU,QAAQC,QAAQkvB,KAC7B,WAAY,CACVH,OAAQ,mBAGZ7sB,MAAO,CACLwhB,SAAU,EACVnkB,QAAS,OACTiB,WAAY,WACZ4uB,SAAU,QAEZC,GAAI,CACFpa,WAAY,GAEd0W,QAAS,CACPhrB,WAAYtB,EAAMI,QAAQ,GAC1BsI,YAAa,MACbqM,aAAc,MACd/F,WAAYhP,EAAMI,QAAQ,IAC1B4U,cAAehV,EAAMI,QAAQ,IAC7BG,WAAY,SACZ7G,MAAO,OACPu2B,cAAe,SACfC,cAAe,OACfxpB,SAAU,QAEZqP,QAAS,CACP7V,QAAS,OACT6vB,SAAU,OACV7uB,OAAQlB,EAAMI,QAAQ,GAAG,EACzB+T,eAAgB,YAElBtE,OAAQ,CACN3P,QAAS,OACTiB,WAAY,UAEdgvB,aAAc,CACZjwB,QAAS,OACTiB,WAAY,SACZivB,SAAU,UAEZC,YAAa,CACXnwB,QAAS,OACTkT,cAAe,SACf9R,WAAYtB,EAAMI,QAAQ,GAC1BgwB,SAAU,UAEZE,eAAgB,CACdC,aAAc,WACdH,SAAU,SACVI,WAAY,SACZ92B,MAAO,QAET+2B,WAAY,CACVF,aAAc,WACdH,SAAU,SACVI,WAAY,UAEdE,WAAY,CACVhqB,SAAU,GACV2M,UAAW,UAEbsd,KAAM,CACJzwB,QAAS,OACT6vB,SAAU,SACV1L,SAAU,IACV+L,SAAU,cAIRQ,GAAsB,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAUhuB,EAAb,EAAaA,MAAOiuB,EAApB,EAAoBA,SAAaxsB,EAAjC,sDAC1B,kBAAC0E,EAAA,EAAD,CAASnG,MAAOA,EAAOT,QAAS0uB,EAAUC,OAAK,GAC7C,kBAAC1S,EAAA,EAAiB/Z,EAAQusB,KAK9B,SAASG,GAAgBj3B,GAEvB,IADA,IAAMwK,EAAS,GACf,MAAoBsB,OAAOwE,KAAKtQ,GAAhC,eACE,IADG,IAAM2H,EAAK,KACd,MAAmBmE,OAAOwE,KAAKtQ,EAAE2H,IAAjC,eAA0C,CAArC,IAAMnC,EAAI,KACRgF,EAAOhF,KAASgF,EAAOhF,GAAQ,IADI,oBAEpBxF,EAAE2H,GAAOnC,IAFW,IAExC,2BAAoC,CAAC,IAA1BsC,EAAyB,QAClCA,EAAMH,MAAQA,EACd6C,EAAOhF,GAAMyF,KAAKnD,IAJoB,+BAQ5C,OAAO0C,EAGT,IAAMue,GAAU,IAAIb,GA6ZLgP,OA1Zf,WAAgB,IAAD,EAEWvsB,IAAM4K,SAAS,aAF1B,mBAENxV,EAFM,KAEAmf,EAFA,OAGavU,IAAM4K,SAAS,cAH5B,mBAGN1G,EAHM,KAGCsoB,EAHD,OAI6BxsB,IAAM4K,SAAS,IAJ5C,mBAIN6hB,EAJM,KAISC,EAJT,OAKmB1sB,IAAM4K,SAAS,MALlC,mBAKNhI,EALM,KAKI+Q,EALJ,OAMyB3T,IAAM4K,SAAS,IANxC,mBAMN+hB,EANM,KAMOC,EANP,OAOe5sB,IAAM4K,SAAS,MAP9B,mBAON/H,EAPM,KAOE+Q,EAPF,OAQS5T,IAAM4K,SAAS,IARxB,mBAQN3I,EARM,KAQD4qB,GARC,QASS7sB,IAAM4K,SAAS,IATxB,qBASNpU,GATM,MASDs2B,GATC,SAUiB9sB,IAAM4K,SAAS,IAVhC,qBAUN3E,GAVM,MAUG+O,GAVH,SAWiBhV,IAAM4K,SAAS,IAXhC,qBAWN1E,GAXM,MAWG+O,GAXH,SAYqBjV,IAAM4K,SAAS,IAZpC,qBAYNjG,GAZM,MAYKooB,GAZL,SAayB/sB,IAAM4K,UAAS,GAbxC,qBAaNqe,GAbM,MAaOzH,GAbP,SAc6BxhB,IAAM4K,UAAS,GAd5C,qBAcNoiB,GAdM,MAcSC,GAdT,SAe2BjtB,IAAM4K,UAAS,GAf1C,qBAeNsiB,GAfM,MAeQC,GAfR,SAgBWntB,IAAM4K,SAASwT,GAAQhe,IAAI,OAAQ,KAhB9C,qBAgBNqF,GAhBM,MAgBA8c,GAhBA,SAiBeviB,IAAM4K,UAAS,WACzC,OAAO0hB,GAAgBlO,GAAQhe,IAAI,SAAU,QAlBlC,qBAiBNP,GAjBM,MAiBE+kB,GAjBF,SAoBe5kB,IAAM4K,SAASwT,GAAQhe,IAAI,SAAU,KApBpD,qBAoBNwE,GApBM,MAoBE+gB,GApBF,SAqBmB3lB,IAAM4K,UAAS,WAC7C,OAAOwiB,IAAchP,GAAQhe,IAAI,WAAY,IAAKunB,OAtBvC,qBAqBNxiB,GArBM,MAqBIuiB,GArBJ,SAwBe1nB,IAAM4K,SAAS,MAxB9B,qBAwBNO,GAxBM,MAwBEkiB,GAxBF,SAyByBrtB,IAAM4K,SAAS,IAzBxC,qBAyBN0iB,GAzBM,MAyBOC,GAzBP,SA0B6BvtB,IAAM4K,SAASwT,GAAQhe,IAAI,gBAAiB,KA1BzE,qBA0BNotB,GA1BM,MA0BSC,GA1BT,SA2BmBztB,IAAM4K,SAASqf,IA3BlC,qBA2BNnvB,GA3BM,MA2BI4yB,GA3BJ,SA4BuB1tB,IAAM4K,SAAqC,OAA5BwT,GAAQhe,IAAI,aA5BlD,qBA4BN8oB,GA5BM,MA4BMC,GA5BN,SA6ByBnpB,IAAM4K,SAASwT,GAAQhe,IAAI,cAAe,KA7BnE,qBA6BN+N,GA7BM,MA6BO0X,GA7BP,SA8ByB7lB,IAAM4K,UAAS,GA9BxC,qBA8BN+iB,GA9BM,MA8BOC,GA9BP,SA+Ba5tB,IAAM4K,SAAS,MA/B5B,qBA+BNzB,GA/BM,MA+BC+I,GA/BD,MAgCP1H,GAASxK,IAAMC,SACfvC,GAAUtC,KAEVnG,GAAU+K,IAAM6tB,SAAQ,iBAAO,CACnC5rB,IAAKA,EACLzL,IAAKA,GACLyP,QAASA,GACTC,QAASA,GACTvB,UAAWA,GACXvP,KAAMA,EACN8O,MAAOA,EACPtB,SAAUA,EACVC,OAAQA,EACR4C,KAAMA,GACN5F,OAAQA,GACR+E,OAAQA,GACRO,SAAUA,GACVrK,SAAUA,MACR,CAAC1F,EAAM8O,EAAOtB,EAAUC,EAAQZ,EAAKzL,GAAKyP,GAASC,GAASvB,GAAWc,GAAM5F,GAAQ+E,GAAQO,GAAUrK,KAE3GkF,IAAME,WAAU,WACd,IAAMia,EAAMmN,IAAO2C,IACnBlmB,GAAMmD,SAAQ,SAACrM,GACb,IAxOQizB,EAAKnjB,EAwOP9D,GAxOEinB,EAwOQ3T,EAAItf,GAAM8D,IAxObgM,EAwOkBxF,GAAS3J,QAAQwF,IAAI2J,OAvOpDmjB,EAAMnjB,EAAO,IAAc,IAC3BmjB,GAAOnjB,EAAO,KAAe,IAC1B,GAsOHwP,EAAItf,GAAM8D,KAAOkI,EApOvB,SAAkB8C,EAAMokB,EAAUC,EAAMrjB,GACtC,IAAK,IAAI9E,EAAI,EAAGA,EAAI8D,EAAK5R,OAAQ8N,IAC/B8D,EAAK9D,GAAG,IAAMmoB,EAmOZC,CAAS9T,EAAItf,GAAM8O,KAAMwQ,EAAItf,GAAM8D,IAAKkI,EAAI1B,GAAS3J,QAAQwF,IAAI2J,WAEnE+iB,GAAYvT,KACX,CAAChV,GAAS3J,QAAQwF,IAAI2J,SAEzB3K,IAAME,WAAU,WACd,IAAMguB,EAAO9P,GAAQhe,IAAI,YACrB8tB,GAAiBvQ,UAATuQ,IACVf,IAAgB,GAChB/O,GAAQ9D,IAAI,WAAYqD,UAI1B,IACM9iB,EADY,IAAIszB,gBAAgBjsB,OAAOksB,SAASjjB,QAC/B/K,IAAI,QACvBvF,GACFwyB,GAAUxyB,KAEX,IAIH,IAAMwzB,GAAUruB,IAAMC,OAAO,MACvBP,GAAOM,IAAMqW,aAAY,SAACxb,GAC9BwyB,IAAU,SAAAtjB,GAAQ,OAAIA,IAAalP,EAAO,KAAOA,KACjDwzB,GAAQ5uB,QAAU5E,EAClBqH,OAAOosB,QAAQC,aAAa,CAAC1zB,KAAKA,GAAO,GAAI,SAASA,KACrD,IACHmF,IAAME,WAAU,WACd,GAAImuB,GAAQ5uB,QAAS,CACnB,IAAM5E,EAAOwzB,GAAQ5uB,QACrB4uB,GAAQ5uB,QAAU,KAClB4tB,GAAUxyB,MAEX,CAACsQ,KAGJnL,IAAME,WAAU,WACdsK,GAAO/K,QAAQ2L,eAAeojB,eAAe,CAACC,KAAI,MACjD,CAACd,KAEJ,IAAMe,GAAU1uB,IAAMqW,aAAY,SAACxb,GACjCA,EAAOA,EAAKkf,cACZ2S,EAAiB7xB,GACbC,GAASqL,eAAetL,GAC1B8Y,EAAY9Y,GAGZ8Y,EAAY,QAEb,CAAC7Y,KACE4H,GAAa1C,IAAMqW,aAAY,SAACxb,GAAD,OAAU+H,IAAa/H,IAAM,CAAC+H,IAC7D+rB,GAAQ3uB,IAAMqW,aAAY,SAACxb,GAC/BA,EAAOA,EAAKkf,cACZ6S,EAAe/xB,GACXC,GAASqL,eAAetL,GAC1B+Y,EAAU/Y,GAGV+Y,EAAU,QAEX,CAAC9Y,KACE6H,GAAW3C,IAAMqW,aAAY,SAACxb,GAAD,OAAUgI,IAAWhI,IAAM,CAACgI,IACzDG,GAAY,SAACnI,GAAD,OAAUgrB,IAAe,SAAApK,GAAI,4BAAQA,GAAR,CAAc5gB,QACvDkI,GAAe,SAAClI,GAAD,OAAUgrB,IAAe,SAAApK,GAAI,OAAIA,EAAK/U,QAAO,SAAAzF,GAAG,OAAIA,IAAQpG,SAC3EiI,GAAa9C,IAAMqW,aAAY,SAACxb,GAAD,OAAUsT,GAAYlT,SAASJ,KAAO,CAACsT,KAC5EnO,IAAME,WAAU,WACdke,GAAQ9D,IAAI,cAAenM,MAC1B,CAACA,KAGJ,IAAM1Q,GAAUuC,IAAMC,OAAO,MACvB2uB,GAAa,WACjBnxB,GAAQgC,QAAU,CAChBC,KAAMA,GACNkD,SAAU8rB,GACVhsB,WAAYA,GACZC,SAAUA,GACVE,OAAQ8rB,GACR3rB,UAAWA,GACXD,aAAcA,GACdD,WAAYA,GACZG,YAAcxF,GAAQgC,SAAWhC,GAAQgC,QAAQwD,YAAexF,GAAQgC,QAAQwD,iBAAcxI,IAOlG,OAJKgD,GAAQgC,SAAWmvB,KACxB5uB,IAAME,UAAU0uB,GAAY,CAAClvB,GAAMgvB,GAAShsB,GAAYisB,GAAOhsB,GAAUK,GAAWD,GAAcD,KAIhG,yBAAK1D,MAAO,CACV5D,QAAS,OACTqzB,SAAU,SACV7d,OAAQ,UAER,kBAAC8d,EAAA,EAAD,CAAQxtB,SAAS,UACf,kBAACytB,EAAA,EAAD,KACE,yBAAKjxB,UAAWJ,GAAQS,OACtB,kBAACP,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAWJ,GAAQ4tB,IAA5C,eAGA,kBAAChnB,EAAA,EAAD,CAASnG,MAAM,uBACb,kBAAC4Z,EAAA,EAAD,CAAQja,UAAWJ,GAAQkqB,QAAStoB,QAAS,kBAAM6tB,IAAgB,IAAOjL,YAAU,QAAQ9oB,KAAK,SAAjG,IACIukB,WAIR,yBAAK7f,UAAWJ,GAAQ2T,SACtB,yBAAKvT,UAAWJ,GAAQyN,QACtB,kBAAC2Y,EAAA,EAAD,CACE7uB,QAAS+0B,GACTgF,eAAgB,SAACxtB,GAAD,OAAOA,EAAE3G,KAAO2G,EAAE3G,KAAO,IACzC4pB,aAAc,SAACjjB,GAAD,OACZ,0BAAM1D,UAAWJ,GAAQ+tB,cACvB,uBAAG3tB,UAAWJ,GAAQsuB,YAAaxqB,EAAE3G,MACrC,0BAAMiD,UAAWJ,GAAQiuB,aACvB,0BAAM7tB,UAAWJ,GAAQquB,YAAavqB,EAAE1E,MACxC,kBAACc,EAAA,EAAD,CAAYC,QAAQ,UAAUC,UAAWJ,GAAQkuB,gBAAiBpqB,EAAEytB,KAApE,KAA4EztB,EAAEwd,MAAQxd,EAAEwd,MAAM,KAAO,GAAIxd,EAAEud,YAIjHoF,cAAe,SAAClvB,EAASivB,GAEvB,IAAKoJ,IAAeE,GAAcz1B,OAAS,EACzC,OAAOy1B,GAAcxsB,KAAI,SAAAnG,GAAI,OAAIC,GAASD,MAG5C,IAAIupB,EAAW1d,GAAOzR,EAAS,CAAEi6B,WAAY5B,GAAa0B,eAAgB,SAACxtB,GAAD,OAAOA,EAAE3G,QAEnF,GAAIupB,EAASrsB,OAAS,EAAG,CACvB,IAAM6P,EAAMlB,GAAOzR,EAAS,CAAEi6B,WAAY5B,GAAa0B,eAAgB,SAACxtB,GAAD,OAAOA,EAAE1E,QAChFsnB,EAAWA,EAAS/I,OAAOzT,EAAI7G,MAAM,EAAG,EAAEqjB,EAASrsB,SAErD,OAAOqsB,GAETH,YAAa,SAACC,GAAD,OACX,kBAACiL,EAAA,EAAD,CACEpW,YAAY,YACZjb,UAAWJ,GAAQotB,YACnBvqB,IAAK2jB,EAAOxL,WAAWnY,IACvB6uB,WAAYlL,EAAOkL,WACnBzW,aAAcuL,EAAOkL,WAAW7W,MAC5B,kBAACtB,EAAA,EAAD,CACE7d,KAAK,QACLkG,QAAS,WACP+tB,GAAU,MACVE,GAAe,IACfrrB,OAAOosB,QAAQC,aAAa,KAAM,GAAI,OAGxC,kBAAC,IAAD,OAGF,QAIRc,gBAAiBlF,GACjB3R,SAAU,SAACjZ,EAAKgZ,GACd,GAAIA,EAAO,CACT8U,GAAU9U,EAAM1d,MAChB,IAAMqkB,EAAO,YAAK,IAAIvX,IAAJ,CAAS4Q,EAAM1d,MAAf,mBAAwB2yB,OAAkBzsB,MAAM,EAAG,GACrE0sB,GAAiBvO,GACjBd,GAAQ9D,IAAI,gBAAiB4E,GAC7Bhd,OAAOosB,QAAQC,aAAa,CAAC1zB,KAAK0d,EAAM1d,MAAO,GAAI,SAAS0d,EAAM1d,WAGlEwyB,GAAU,MACVnrB,OAAOosB,QAAQC,aAAa,KAAM,GAAI,MAG1ChW,MAAOpN,GAAS8e,GAAY9e,IAAU,KACtC+jB,WAAY5B,GACZgC,cAAe,SAAC/vB,EAAKgZ,GAAN,OAAgBgV,GAAehV,IAC9CgX,eAAe,EACfjL,eAAe,KAGnB,kBAAChgB,EAAA,EAAD,CAASnG,MAAM,mCAAmCT,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GACvH,yBAAKvuB,UAAWJ,GAAQqtB,UAAW7I,YAAU,SAC3C,kBAAC,IAAD,CAAmBpkB,UAAwB,OAAb8E,EAAoBlF,GAAQ4sB,MAAQ,OADpE,WAGE,kBAAC6E,EAAA,EAAD,CACEpW,YAAY,OACZjb,UAAWJ,GAAQgtB,MACnB0E,WAAY,CAACI,UAAU,GACvBjX,MAAOkU,EACPjU,SAAU,SAAAjZ,GAAG,OAAImvB,GAAQnvB,EAAIrB,OAAOqa,YAI1C,kBAACjU,EAAA,EAAD,CAASnG,MAAM,iCAAiCT,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GACrH,yBAAKvuB,UAAWJ,GAAQqtB,WACtB,kBAAC,IAAD,CAAgBjtB,UAAsB,OAAX+E,EAAkBnF,GAAQ4sB,MAAQ,OAD/D,WAGE,kBAAC6E,EAAA,EAAD,CACEpW,YAAY,OACZjb,UAAWJ,GAAQgtB,MACnB0E,WAAY,CAACI,UAAU,GACvBjX,MAAOoU,EACPnU,SAAU,SAAAjZ,GAAG,OAAIovB,GAAMpvB,EAAIrB,OAAOqa,YAIxC,kBAACjU,EAAA,EAAD,CAASnG,MAAM,4CAAyCT,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GAC7H,yBAAKvuB,UAAWJ,GAAQqtB,WACtB,kBAAC,IAAD,CAAajtB,UAAyB,KAAd6G,GAAmBjH,GAAQ4sB,MAAQ,OAD7D,WAGE,kBAAC6E,EAAA,EAAD,CACEpW,YAAY,UACZjb,UAAWJ,GAAQgtB,MACnB0E,WAAY,CAACI,UAAU,GACvBjX,MAAO5T,GACP6T,SAAU,SAAAjZ,GAASwtB,GAAaxtB,EAAIrB,OAAOqa,YAIjD,kBAACiB,EAAA,EAAD,CAAmBjB,MAAOnjB,EAAMojB,SAAU,SAACjZ,EAAKyZ,GAASzE,EAAQyE,IAAOlb,UAAWJ,GAAQ+sB,IAAKhR,WAAS,GACvG,kBAAC,GAAD,CAAqBlB,MAAM,YAAYpa,MAAM,YAAYT,QAAS,CAAC+xB,KAAM/xB,GAAQ4sB,MAAOvhB,SAAUrL,GAAQ8sB,eAAgB4B,SAAU,CAAClB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,eAC5K,kBAAC,IAAD,OAEF,kBAAC,GAAD,CAAqB7S,MAAM,MAAMpa,MAAM,MAAMT,QAAS,CAAC+xB,KAAM/xB,GAAQ4sB,MAAOvhB,SAAUrL,GAAQ8sB,eAAgB4B,SAAU,CAAClB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,eAChK,kBAAC,IAAD,OAEF,kBAAC,GAAD,CAAqB7S,MAAM,SAASpa,MAAM,SAAST,QAAS,CAAC+xB,KAAM/xB,GAAQ4sB,MAAOvhB,SAAUrL,GAAQ8sB,eAAgB4B,SAAU,CAAClB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,eACtK,kBAAC,IAAD,QAGJ,kBAAC5R,EAAA,EAAD,CAAmBjB,MAAOrU,EAAOsU,SAAU,SAACjZ,EAAKyZ,GAASwT,EAASxT,GAAK6T,GAAO,IAAIC,GAAO,KAAOhvB,UAAWJ,GAAQ+sB,IAAKhR,WAAS,GAChI,kBAAC,GAAD,CAAqBlB,MAAM,aAAapa,MAAM,aAAaT,QAAS,CAAC+xB,KAAM/xB,GAAQ4sB,MAAOvhB,SAAUrL,GAAQ8sB,eAAgB4B,SAAU,CAAClB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,eAC9K,kBAAC,IAAD,OAEF,kBAAC,GAAD,CAAqB7S,MAAM,KAAKpa,MAAM,QAAQT,QAAS,CAAC+xB,KAAM/xB,GAAQ4sB,MAAOvhB,SAAUrL,GAAQ8sB,eAAgB4B,SAAU,CAAClB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,eACjK,kBAAC,IAAD,QAGJ,yBAAKttB,UAAWJ,GAAQqtB,WACX,eAAV7mB,EACC,kBAAC,IAAD,CAAYpG,UAAmB,KAARmE,GAAsB,KAARzL,GAAakH,GAAQ4sB,MAAQ,OAElE,kBAAC,IAAD,CAAoBxsB,UAAmB,KAARmE,GAAsB,KAARzL,GAAakH,GAAQ4sB,MAAQ,OAJ9E,OAOE,kBAAChmB,EAAA,EAAD,CAASnG,MAAiB,eAAV+F,EAAyB,2CAA6C,6BAA8BxG,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GACzL,kBAAC8C,EAAA,EAAD,CACEpW,YAAY,MACZjb,UAAWJ,GAAQmtB,QACnBtS,MAAOtW,EACPuW,SAAU,SAAAjZ,GAAS,IAAIsH,EAAKpF,SAASlC,EAAIrB,OAAOqa,QAAU,GAAIsU,GAAOhmB,OAZ3E,IAgBE,kBAACvC,EAAA,EAAD,CAASnG,MAAiB,eAAV+F,EAAyB,uCAAyC,yBAA0BxG,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GACjL,kBAAC8C,EAAA,EAAD,CACEpW,YAAY,MACZjb,UAAWJ,GAAQmtB,QACnBtS,MAAO/hB,GACPgiB,SAAU,SAAAjZ,GAAS,IAAIsH,EAAKpF,SAASlC,EAAIrB,OAAOqa,QAAU,GAAIuU,GAAOjmB,QAI3E,yBAAK/I,UAAWJ,GAAQqtB,WACtB,kBAAC,IAAD,CAAsBjtB,UAAuB,KAAZmI,IAA8B,KAAZC,GAAiBxI,GAAQ4sB,MAAQ,OADtF,OAGE,kBAAChmB,EAAA,EAAD,CAASnG,MAAM,6BAA6BT,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GACjH,kBAAC8C,EAAA,EAAD,CACEpW,YAAY,MACZjb,UAAWJ,GAAQmtB,QACnBtS,MAAOtS,GACPuS,SAAU,SAAAjZ,GAAS,IAAIsH,EAAKpF,SAASlC,EAAIrB,OAAOqa,QAAU,GAAIvD,GAAWnO,OAR/E,IAYE,kBAACvC,EAAA,EAAD,CAASnG,MAAM,6BAA6BT,QAAS,CAACwtB,QAASxtB,GAAQwtB,QAASmB,MAAO3uB,GAAQ0tB,cAAeiB,OAAK,GACjH,kBAAC8C,EAAA,EAAD,CACEpW,YAAY,MACZjb,UAAWJ,GAAQmtB,QACnBtS,MAAOrS,GACPsS,SAAU,SAAAjZ,GAAS,IAAIsH,EAAKpF,SAASlC,EAAIrB,OAAOqa,QAAU,GAAItD,GAAWpO,QAI/E,kBAACoQ,EAAA,EAAD,CAAYnZ,UAAWJ,GAAQhB,KAAK,IAAIgB,GAAQ+sB,IAAKrxB,KAAK,QAAQkG,QAAS,kBAAM2tB,IAAiB,IAAO/K,YAAU,SACjH,kBAAC5d,EAAA,EAAD,CAASnG,MAAM,gBACb,kBAAC,IAAD,QAGJ,kBAAC8Y,EAAA,EAAD,CAAYnZ,UAAWJ,GAAQhB,KAAK,IAAIgB,GAAQ+sB,IAAKrxB,KAAK,QAAQkG,QAAS,kBAAMsuB,IAAgBD,KAAczL,YAAU,UACvH,kBAAC5d,EAAA,EAAD,CAASnG,MAAM,gBACb,kBAAC,IAAD,QAGJ,kBAAC8Y,EAAA,EAAD,CAAYnZ,UAAWJ,GAAQhB,KAAK,IAAIgB,GAAQ+sB,IAAKrxB,KAAK,QAAQkG,QAAS,kBAAMkiB,IAAe,IAAOU,YAAU,SAC/G,kBAAC5d,EAAA,EAAD,CAASnG,MAAM,sBACb,kBAAC,IAAD,WAMV,yBAAKL,UAAWJ,GAAQuuB,MACtB,kBAAC,GAAD,CACEh3B,QAASA,GACTid,SAAUA,GACV8E,QAAS2W,GACTnjB,OAAQA,GACR0M,MAAO,kBAAM0W,IAAe,IAC5BnwB,QAASA,KAEX,kBAAC,GAAD,CACExI,QAASA,GACTkW,OAAQA,GACRpH,MAAOA,GACPoK,YAAaA,GACbhF,MAAOA,GACPqB,OAAQA,GACR/M,QAASA,MAGb,kBAAC,GAAD,CACE+E,KAAMymB,GACNzH,eAAgBA,GAChBe,QAASA,GACTqC,UAAW,SAAC/kB,GAAD,OAAY+kB,GAAU0H,GAAgBzsB,KACjD8lB,UAAWA,GACX7qB,SAAUA,GACViJ,MAAOA,GACPoB,SAAUA,GACVgJ,YAAaA,GACb0X,eAAgBA,KAElB,kBAAC6J,GAAD,CACEltB,KAAMwqB,GACNpQ,YAAa,kBAAMqQ,IAAiB,IACpC9nB,SAAUA,GACVuiB,YAAaA,GACbC,gBAAiBA,KAEnB,kBAACgI,GAAD,CACEntB,KAAM0qB,GACNtQ,YAAa,kBAAMuQ,IAAgB,IACnClF,aAAc,kBAAMkB,IAAc,MAEpC,kBAAC,GAAD,CACED,WAAYA,GACZC,cAAeA,GACfF,YAAaA,GACbzH,eAAgBA,OCtrBxB5f,IAASC,OACP,kBAAC,IAAM+tB,WAAP,KACE,kBAAC,GAAD,OAEF15B,SAAS25B,eAAe,W","file":"static/js/main.72a52c2d.chunk.js","sourcesContent":["import L from \"leaflet\";\r\n\r\n\r\nconst Canvas = L.Canvas.extend({\r\n\r\n  _icons: {},\r\n\r\n  clearCache: function(id = null) {\r\n    if (!id) {\r\n      this._icons = {};\r\n    }\r\n    else {\r\n      delete this._icons[id];\r\n    }\r\n    if (!this._map) { return; }\r\n    this._redraw();\r\n  },\r\n\r\n  _updateAirportIcon: function (layer) {\r\n    if (!this._drawing || layer._empty()) { return; }\r\n\r\n    const zoom = this._map._zoom;\r\n    const minZoom = this._map._layersMinZoom;\r\n    const maxZoom = this._map._layersMaxZoom;\r\n    const color = layer.options.color;\r\n    const fillColor = layer.options.fillColor;\r\n    const radius = layer.options.radius;\r\n    const type = layer.options.type;\r\n    const id = layer.options.id;\r\n    const p = layer._point;\r\n\r\n    // Build the image if does not exists yet\r\n    if (!this._icons[id]) {\r\n      this._icons[id] = {\r\n        civil1: {},\r\n        civil2: {},\r\n        civil3: {},\r\n        water1: {},\r\n        water2: {},\r\n        water3: {},\r\n        military1: {},\r\n        military2: {},\r\n        military3: {},\r\n        default: {}\r\n      }\r\n    }\r\n    if (!this._icons[id][type][zoom]) {\r\n      const offscreen = document.createElement(\"canvas\");\r\n      const octx = offscreen.getContext(\"2d\");\r\n\r\n      let r = null;\r\n      if (zoom <= 7) {\r\n        r = (radius - 0.5)/(7 - minZoom)*(zoom - minZoom) + 0.5;\r\n      }\r\n      else {\r\n        const maxRadius = Math.max(radius, 15);\r\n        r = (maxRadius - radius)/(maxZoom - 7)*(zoom - 7) + radius;\r\n      }\r\n\r\n      octx.scale(r/10, r/10);\r\n\r\n      // Draw out circle\r\n      octx.beginPath();\r\n      octx.arc(10, 10, 10, 0, (2*Math.PI));\r\n      octx.fillStyle = fillColor;\r\n      octx.fill();\r\n      octx.closePath();\r\n\r\n      // Draw inside pattern\r\n      octx.beginPath();\r\n      switch(type) {\r\n        case \"civil1\":\r\n          octx.arc(10, 10, 8, 0, (2*Math.PI));\r\n          break;\r\n        case \"civil2\":\r\n          octx.moveTo(4.343, 14.243);\r\n          octx.lineTo(14.642, 3.944);\r\n          octx.lineTo(16.056, 5.358);\r\n          octx.lineTo(5.757, 15.657);\r\n          octx.lineTo(4.343, 14.243);\r\n          break;\r\n        case \"civil3\":\r\n          octx.moveTo(2.649, 10.645);\r\n          octx.lineTo(14.774, 3.645);\r\n          octx.lineTo(15.774, 5.377);\r\n          octx.lineTo(3.649, 12.377);\r\n          octx.lineTo(2.649, 10.645);\r\n          octx.moveTo(9.219, 3.438);\r\n          octx.lineTo(16.219, 15.562);\r\n          octx.lineTo(14.487, 16.562);\r\n          octx.lineTo(7.487, 4.438);\r\n          octx.lineTo(9.219, 3.438);\r\n          break;\r\n        case \"water1\":\r\n        case \"water2\":\r\n        case \"water3\":\r\n          octx.arc(10, 10, 6.5, 0+0.5, Math.PI-0.5);\r\n          octx.strokeStyle = color;\r\n          octx.lineWidth = 1.5;\r\n          octx.stroke();\r\n          octx.closePath();\r\n          octx.beginPath();\r\n          octx.rect(9, 4, 2, 13);\r\n          octx.moveTo(5.000, 8.000);\r\n          octx.lineTo(5.000, 7.000);\r\n          octx.lineTo(15.000, 7.000);\r\n          octx.lineTo(15.000, 8.000);\r\n          octx.lineTo(5.000, 8.000);\r\n          octx.moveTo(4.000, 12.000);\r\n          break;\r\n        case \"military1\":\r\n        case \"military2\":\r\n        case \"military3\":\r\n          octx.moveTo(12.706, 5.462);\r\n          octx.lineTo(11.814, 5.462);\r\n          octx.lineTo(9.796, 11.888);\r\n          octx.lineTo(7.732, 5.462);\r\n          octx.lineTo(6.833, 5.462);\r\n          octx.lineTo(4.913, 15.007);\r\n          octx.lineTo(6.547, 15.007);\r\n          octx.lineTo(7.576, 9.863);\r\n          octx.lineTo(9.496, 15.130);\r\n          octx.lineTo(10.102, 15.130);\r\n          octx.lineTo(12.022, 9.863);\r\n          octx.lineTo(13.012, 15.007);\r\n          octx.lineTo(14.653, 15.007);\r\n          octx.lineTo(12.706, 5.462);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n      octx.fillStyle = color;\r\n      octx.fill();\r\n      octx.closePath();\r\n\r\n      octx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n      this._icons[id][type][zoom] = {r: r, canvas: offscreen};\r\n    }\r\n\r\n    const {r, canvas} = this._icons[id][type][zoom];\r\n    this._ctx.globalAlpha = 1;\r\n    this._ctx.drawImage(canvas, p.x - r, p.y - r);\r\n\r\n    return r;\r\n\r\n  },\r\n\r\n  _updateArrowedPath: function(layer) {\r\n    if (!layer._parts.length) { return; }\r\n\r\n    const zoom = this._map._zoom;\r\n    const minZoom = this._map._layersMinZoom;\r\n    const maxZoom = this._map._layersMaxZoom;\r\n    let ratio;\r\n    if (zoom <= 7) {\r\n      ratio = (1 - 0.05)/(7 - minZoom)*(zoom - minZoom) + 0.05;\r\n    }\r\n    else {\r\n      ratio = (2 - 1)/(maxZoom - 7)*(zoom - 7) + 1;\r\n    }\r\n\r\n    const p1 = layer._parts[0][0];\r\n    const p2 = layer._parts[0][1];\r\n    const dx = p1.x - p2.x;\r\n    const dy = p1.y - p2.y;\r\n    const norm = Math.sqrt(dx*dx+dy*dy);\r\n    const udx = dx/norm;\r\n    const udy = dy/norm;\r\n\r\n    const ax = udx * Math.sqrt(3)/2 - udy * 1/2;\r\n    const ay = udx * 1/2 + udy * Math.sqrt(3)/2;\r\n    const bx = udx * Math.sqrt(3)/2 + udy * 1/2;\r\n    const by =  - udx * 1/2 + udy * Math.sqrt(3)/2;\r\n    \r\n    this._ctx.beginPath();\r\n\r\n    this._ctx.moveTo(p1.x, p1.y);\r\n    this._ctx.lineTo(p2.x, p2.y);\r\n\r\n    const l = 20*ratio;\r\n\r\n    this._ctx.moveTo(p1.x - dx/2 + l * ax, p1.y - dy/2 + l * ay);\r\n    this._ctx.lineTo(p1.x - dx/2, p1.y - dy/2);\r\n    this._ctx.lineTo(p1.x - dx/2 + l * bx, p1.y - dy/2 + l * by);\r\n\r\n    if (layer.options.bothWays) {\r\n      this._ctx.moveTo(p1.x - dx/2 - l * ax, p1.y - dy/2 - l * ay);\r\n      this._ctx.lineTo(p1.x - dx/2, p1.y - dy/2);\r\n      this._ctx.lineTo(p1.x - dx/2 - l * bx, p1.y - dy/2 - l * by);\r\n    }\r\n\r\n    this._ctx.globalAlpha = layer.options.opacity;\r\n    this._ctx.strokeStyle = layer.options.color;\r\n    this._ctx.lineWidth = layer.options.weight*ratio;\r\n    this._ctx.stroke();\r\n    this._ctx.closePath();\r\n  }\r\n\r\n});\r\nexport default Canvas;","// SVG icon for normal airports\r\nfunction civilSVG3(color1, color2, size) {\r\n  return '<svg width=\"'+size+'\" height=\"'+size+'\" viewBox=\"0 0 20 20\"><circle cx=\"10\" cy=\"10\" r=\"10\" class=\"cls-1\" fill=\"'+color1+'\"/><path d=\"M2.649,10.645 L14.774,3.645 L15.774,5.377 L3.649,12.377 L2.649,10.645 Z\" fill=\"'+color2+'\"/><path d=\"M9.219,3.438 L16.219,15.562 L14.487,16.562 L7.487,4.438 L9.219,3.438 Z\" fill=\"'+color2+'\"/></svg>';\r\n}\r\nfunction civilSVG2(color1, color2, size) {\r\n  return '<svg width=\"'+size+'\" height=\"'+size+'\" viewBox=\"0 0 20 20\"><circle cx=\"10\" cy=\"10\" r=\"10\" class=\"cls-1\" fill=\"'+color1+'\"/><path d=\"M4.343,14.243 L14.642,3.944 L16.056,5.358 L5.757,15.657 L4.343,14.243 Z\" fill=\"'+color2+'\"/></svg>';\r\n}\r\nfunction civilSVG1(color1, color2, size) {\r\n  return '<svg width=\"'+size+'\" height=\"'+size+'\" viewBox=\"0 0 20 20\"><circle cx=\"10\" cy=\"10\" r=\"8\" class=\"cls-1\" fill=\"none\" stroke=\"'+color1+'\" stroke-width=\"4px\"/><circle cx=\"10\" cy=\"10\" r=\"8\" class=\"cls-1\" fill=\"'+color2+'\"/></svg>';\r\n}\r\n\r\n// SVG icon for military airports\r\nfunction militarySVG(color1, color2, size) {\r\n  return '<svg width=\"'+size+'\" height=\"'+size+'\" viewBox=\"0 0 20 20\"><circle cx=\"10\" cy=\"10\" r=\"10\" class=\"cls-1\" fill=\"'+color1+'\"/><path d=\"M12.706,5.462 L11.814,5.462 L9.796,11.888 L7.732,5.462 L6.833,5.462 L4.913,15.007 L6.547,15.007 L7.576,9.863 L9.496,15.130 L10.102,15.130 L12.022,9.863 L13.012,15.007 L14.653,15.007 L12.706,5.462 Z\" fill=\"'+color2+'\"/></svg>';\r\n}\r\n\r\n// SVG icon for marine airports\r\nfunction waterSVG(color1, color2, size) {\r\n  return '<svg width=\"'+size+'\" height=\"'+size+'\" viewBox=\"0 0 20 20\"><circle cx=\"10\" cy=\"10\" r=\"10\" class=\"cls-1\" fill=\"'+color1+'\"/><rect x=\"9\" y=\"4\" width=\"2\" height=\"13\" fill=\"'+color2+'\"/><path d=\"M5.000,8.000 L5.000,7.000 L15.000,7.000 L15.000,8.000 L5.000,8.000 Z\" fill=\"'+color2+'\"/><path d=\"M4.000,12.000 C4.000,12.000 7.038,15.066 10.000,15.000 C12.763,14.938 15.000,12.000 15.000,12.000 \" stroke=\"'+color2+'\" stroke-width=\"1.5\" fill=\"none\"/></svg>';\r\n}\r\n\r\nexport class AirportSVG {\r\n  constructor(color1, color2, size) {\r\n    this.icons = {\r\n      civil: [\r\n        civilSVG1(color1, color2, size),\r\n        civilSVG2(color1, color2, size),\r\n        civilSVG3(color1, color2, size)\r\n      ],\r\n      military: [\r\n        militarySVG(color1, color2, size),\r\n        militarySVG(color1, color2, size),\r\n        militarySVG(color1, color2, size)\r\n      ],\r\n      water: [\r\n        waterSVG(color1, color2, size),\r\n        waterSVG(color1, color2, size),\r\n        waterSVG(color1, color2, size)\r\n      ]\r\n    }\r\n  }\r\n\r\n  get(type, size) {\r\n    const s = (size >= 3500) ? 2 : (size >= 1000) ? 1 : 0;\r\n    return this.icons[type][s];\r\n  }\r\n}","import L from \"leaflet\";\r\n\r\n\r\nconst AirportIcon = L.CircleMarker.extend({\r\n\r\n  options: {\r\n    type: 'default',\r\n    id: 'default'\r\n  },\r\n\r\n  initialize: function(latlng, options) {\r\n    L.CircleMarker.prototype.initialize.call(this, latlng, options);\r\n  },\r\n\r\n  _updatePath: function() {\r\n    const radius = this._renderer._updateAirportIcon(this);\r\n    if (radius) {\r\n      this._radius = radius;\r\n    }\r\n  },\r\n\r\n  setRadius: undefined,\r\n  getRadius: undefined,\r\n  setStyle: undefined\r\n\r\n});\r\nexport default AirportIcon;","import icaodata from \"./data/icaodata-with-zones.json\";\r\n\r\nexport function hideAirport(icao, s) {\r\n  return (\r\n      s\r\n    &&\r\n      (\r\n          icaodata[icao].size < s.size[0]\r\n        ||\r\n          icaodata[icao].size > s.size[1]\r\n        ||\r\n          icaodata[icao].runway < s.runway[0]\r\n        ||\r\n          icaodata[icao].runway > s.runway[1]\r\n        ||\r\n          !s.surface.includes(icaodata[icao].surface)\r\n        ||\r\n          (\r\n              s.onlyMSFS\r\n            &&\r\n              icaodata[icao].msfs[0] === null\r\n          )\r\n      )\r\n  );\r\n}\r\n\r\nexport function airportSurface(surface) {\r\n  switch (surface) {\r\n    case 1: return \"Asphalt\"\r\n    case 2: return \"Concrete\"\r\n    case 3: return \"Coral\"\r\n    case 4: return \"Dirt\"\r\n    case 5: return \"Grass\"\r\n    case 6: return \"Gravel\"\r\n    case 7: return \"Helipad\"\r\n    case 8: return \"Oil Treated\"\r\n    case 9: return \"Snow\"\r\n    case 10: return \"Steel Mats\"\r\n    default: return \"Water\"\r\n  }\r\n}","import React from 'react';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Link from '@material-ui/core/Link';\r\nimport OpenInNewIcon from '@material-ui/icons/OpenInNew';\r\nimport NavigationIcon from '@material-ui/icons/Navigation';\r\nimport CenterFocusStrongIcon from '@material-ui/icons/CenterFocusStrong';\r\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { getDistance, getRhumbLineBearing, convertDistance } from \"geolib\";\r\nimport ReactDOM from \"react-dom\";\r\nimport L from \"leaflet\";\r\n\r\nimport { AirportSVG } from \"./Icons.js\";\r\nimport AirportIcon from \"./AirportIcon.js\";\r\nimport { airportSurface } from \"../../utility.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  striked: {\r\n    display: 'inline-block',\r\n    marginRight: theme.spacing(1),\r\n    textDecoration: 'line-through',\r\n    textDecorationStyle: 'double',\r\n    fontWeight: 300\r\n  },\r\n  popupHeader: {\r\n    background: theme.palette.primary.main,\r\n    color: '#fff',\r\n    padding: '3px 32px 6px 8px',\r\n    borderTopLeftRadius: 3,\r\n    borderTopRightRadius: 3\r\n  },\r\n  popupPart: {\r\n    padding: '6px 8px 12px 8px'\r\n  },\r\n  popupLabel: {\r\n    margin: '8px 0 0 0 !important'\r\n  },\r\n  icao: {\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  icon: {\r\n    display: 'inline-flex',\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  toFSE: {\r\n    display: 'inline-flex',\r\n    alignItems: 'center',\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(2),\r\n    color: 'rgba(255, 255, 255, 0.5) !important',\r\n    fontSize: '0.8em',\r\n    '&:hover': {\r\n      color: '#fff !important'\r\n    }\r\n  },\r\n  name: {\r\n    margin: '0 0 0 28px !important',\r\n    fontWeight: 300,\r\n  },\r\n  simSeparator: {\r\n    marginLeft: 4,\r\n    marginRight: 4\r\n  },\r\n  model: {\r\n    background: theme.palette.primary.light,\r\n    color: '#fff',\r\n    margin: '0 !important',\r\n    padding: '2px 4px',\r\n    borderRadius: 3\r\n  },\r\n  plane: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    margin: '6px 0 0 12px !important'\r\n  },\r\n  planeHome: {\r\n    margin: '0 0 0 24px !important',\r\n    fontSize: '0.7rem',\r\n    color: '#aaa',\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  planeSearch: {\r\n    display: 'inline-flex',\r\n    alignItems: 'center',\r\n    marginLeft: theme.spacing(0.5),\r\n    marginRight: theme.spacing(0.5),\r\n    '&:hover': {\r\n      textDecoration: 'none'\r\n    }\r\n  },\r\n  toFSEPlane: {\r\n    display: 'inline-flex',\r\n    alignItems: 'center',\r\n    marginRight: theme.spacing(0.2),\r\n    marginLeft: theme.spacing(0.2)\r\n  },\r\n}));\r\n\r\nconst SVGs = new AirportSVG('#fff', '#3f51b5', 20);\r\n\r\n\r\nfunction PlaneHome({plane, icaodata, icao, actions}) {\r\n  const classes = useStyles();\r\n\r\n  if (plane.home === icao) {\r\n    return (\r\n      <Typography variant=\"body2\" className={classes.plane}>\r\n        {plane.reg}\r\n        <Link href={\"https://server.fseconomy.net//aircraftlog.jsp?id=\"+plane.id} target=\"fse\" className={classes.toFSEPlane} title=\"Go to FSE\">\r\n          <OpenInNewIcon fontSize=\"inherit\" />\r\n        </Link>\r\n        : {plane.dry ? '$'+plane.dry : '-'}/{plane.wet ? '$'+plane.wet : '-'} (${plane.bonus})\r\n      </Typography>\r\n    );\r\n  }\r\n\r\n  const fr = { latitude: icaodata[icao].lat, longitude: icaodata[icao].lon };\r\n  const to = { latitude: icaodata[plane.home].lat, longitude: icaodata[plane.home].lon };\r\n  const dir = Math.round(getRhumbLineBearing(fr, to));\r\n  const dist = Math.round(convertDistance(getDistance(fr, to), 'sm'));\r\n\r\n  const handleClick = (evt) => {\r\n    evt.preventDefault();\r\n    actions.current.goTo(plane.home);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Typography variant=\"body2\" className={classes.plane}>\r\n        {plane.reg}\r\n        <Link href={\"https://server.fseconomy.net//aircraftlog.jsp?id=\"+plane.id} target=\"fse\" className={classes.toFSEPlane} title=\"Go to FSE\">\r\n          <OpenInNewIcon fontSize=\"inherit\" />\r\n        </Link>\r\n        : {plane.dry ? '$'+plane.dry : '-'}/{plane.wet ? '$'+plane.wet : '-'} (${plane.bonus}<NavigationIcon fontSize=\"inherit\" style={{marginLeft: 3, transform: 'rotate('+dir+'deg)'}} />)\r\n      </Typography>\r\n      <Typography variant=\"body2\" className={classes.planeHome}>\r\n        Home:\r\n        <Link href=\"#\" onClick={handleClick} className={classes.planeSearch} title=\"Go to home location\">\r\n          <CenterFocusStrongIcon fontSize=\"inherit\" />\r\n          {plane.home}\r\n        </Link>\r\n        ({dir} {dist}NM)\r\n      </Typography>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nfunction Popup(props) {\r\n  const {icao, icaodata, planes, siminfo} = props;\r\n  const classes = useStyles();\r\n\r\n  const iconRef = React.useRef(null);\r\n  React.useEffect(() => {\r\n    iconRef.current.innerHTML = SVGs.get(icaodata[icao].type, icaodata[icao].size);\r\n  }, [icaodata, icao]);\r\n\r\n  const models = {}\r\n  if (planes) {\r\n    for (const plane of planes) {\r\n      if (!models[plane.model]) { models[plane.model] = []; }\r\n      models[plane.model].push(plane);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className={classes.popupHeader}>\r\n        <Typography variant=\"h5\" className={classes.icao}>\r\n          <span ref={iconRef} className={classes.icon}></span>\r\n          {\r\n            icaodata[icao][siminfo][0] === icao ?\r\n              icao\r\n            :\r\n              <React.Fragment>\r\n                <span className={classes.striked}>{icao}</span>{icaodata[icao][siminfo][0]}\r\n              </React.Fragment>\r\n          }\r\n          <Link href={\"https://server.fseconomy.net/airport.jsp?icao=\"+icao} target=\"fse\" className={classes.toFSE} title=\"Go to FSE\">\r\n            <OpenInNewIcon fontSize=\"inherit\" />\r\n          </Link>\r\n        </Typography>\r\n        <Typography variant=\"body2\" className={classes.name}>{icaodata[icao].name}</Typography>\r\n      </div>\r\n      <div className={classes.popupPart}>\r\n        <Typography variant=\"body2\" className={classes.popupLabel}>Surface: {airportSurface(icaodata[icao].surface)}</Typography>\r\n        <Typography variant=\"body2\" className={classes.popupLabel}>Longest runway: {icaodata[icao].runway} feet</Typography>\r\n        {\r\n          icaodata[icao][siminfo].length > 1 &&\r\n            <React.Fragment>\r\n              <Typography variant=\"body2\" className={classes.popupLabel}>MSFS alternatives:</Typography>\r\n              <Breadcrumbs\r\n                separator={null}\r\n                maxItems={4}\r\n                itemsBeforeCollapse={4}\r\n                itemsAfterCollapse={0}\r\n                classes={{separator: classes.simSeparator}}\r\n                component='span'\r\n              >\r\n                {icaodata[icao][siminfo].slice(1).map(elm => <span key={elm}>{elm}</span>)}\r\n              </Breadcrumbs>\r\n            </React.Fragment>\r\n        }\r\n      </div>\r\n      {\r\n        planes && Object.entries(models).map(([model, planes]) =>\r\n          <div className={classes.popupPart} key={model}>\r\n            <Typography variant=\"body1\" className={classes.model}>{model}</Typography>\r\n            {planes.map(plane => <PlaneHome key={plane.reg} plane={plane} {...props} />)}\r\n          </div>\r\n        )\r\n      }\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nfunction Marker({position, size, color, sim, id, ...props}) {\r\n  let type = 'default';\r\n  if (!sim || (props.icaodata[props.icao] && props.icaodata[props.icao][sim][0] === props.icao)) {\r\n    const a = props.icaodata[props.icao];\r\n    type = a.type + (a.size >= 3500 ? 3 : a.size >= 1000 ? 2 : 1);\r\n  }\r\n  return new AirportIcon(\r\n    position,\r\n    {\r\n      radius: parseInt(size)/2,\r\n      color: '#fff',\r\n      fillColor: color,\r\n      type: type,\r\n      id: id\r\n    }\r\n  )\r\n    .bindPopup(() => {\r\n      var div = document.createElement('div');\r\n      if (sim) {\r\n        ReactDOM.render(<Typography variant=\"h5\" style={{padding:'3px 8px 3px 8px'}}>{props.icao}</Typography>, div);\r\n      }\r\n      else {\r\n        ReactDOM.render(<Popup {...props} />, div);\r\n      }\r\n      return div;\r\n    }, {\r\n      autoPanPadding: new L.Point(30, 30),\r\n      minWidth: sim ? 100 : Math.min(250, window.innerWidth-10),\r\n      maxWidth: Math.max(600, window.innerWidth-10)\r\n    })\r\n    .on('contextmenu', (evt) => {\r\n      L.DomEvent.stopPropagation(evt);\r\n      const actions = [];\r\n      if (!sim) {\r\n        actions.push({\r\n          name: 'Open in FSE',\r\n          onClick: () => {\r\n            let w = window.open('https://server.fseconomy.net/airport.jsp?icao='+props.icao, 'fse');\r\n            w.focus();\r\n          }\r\n        });\r\n        const isFromIcao = props.actions.current.isFromIcao(props.icao);\r\n        const isToIcao = props.actions.current.isToIcao(props.icao);\r\n        if (isFromIcao) {\r\n          actions.push({\r\n            name: 'Cancel jobs radiating FROM',\r\n            onClick: () => props.actions.current.fromIcao('')\r\n          });\r\n        }\r\n        else {\r\n          actions.push({\r\n            name: 'Jobs radiating FROM',\r\n            onClick: () => {\r\n              if (isToIcao) {\r\n                props.actions.current.toIcao('');\r\n              }\r\n              props.actions.current.fromIcao(props.icao);\r\n            }\r\n          });\r\n        }\r\n        if (isToIcao) {\r\n          actions.push({\r\n            name: 'Cancel jobs radiating TO',\r\n            onClick: () => props.actions.current.toIcao('')\r\n          });\r\n        }\r\n        else {\r\n          actions.push({\r\n            name: 'Jobs radiating TO',\r\n            onClick: () => {\r\n              if (isFromIcao) {\r\n                props.actions.current.fromIcao('');\r\n              }\r\n              props.actions.current.toIcao(props.icao);\r\n            }\r\n          });\r\n        }\r\n        if (props.actions.current.isInCustom(props.icao)) {\r\n          actions.push({\r\n            name: 'Remove from Customs Markers',\r\n            onClick: () => props.actions.current.removeCustom(props.icao)\r\n          });\r\n        }\r\n        else {\r\n          actions.push({\r\n            name: 'Add to Customs Markers',\r\n            onClick: () => props.actions.current.addCustom(props.icao)\r\n          });\r\n        }\r\n      }\r\n      props.actions.current.contextMenu({\r\n        mouseX: evt.originalEvent.clientX,\r\n        mouseY: evt.originalEvent.clientY,\r\n        title: props.icao,\r\n        actions: actions\r\n      });\r\n    });\r\n}\r\n\r\n\r\nexport default Marker;","import L from \"leaflet\";\r\n\r\n\r\nconst JobSegment = L.Polyline.extend({\r\n\r\n  initialize: function(latlngs, options) {\r\n    L.Polyline.prototype.initialize.call(this, latlngs, options);\r\n    this.on('mouseover', () => {\r\n      this.options.prevColor = this.options.color;\r\n      this.setStyle({color: this.options.highlight});\r\n    });\r\n    this.on('mouseout', () => {\r\n      this.setStyle({color: this.options.prevColor});\r\n    })\r\n  },\r\n\r\n  _updatePath: function() {\r\n    this._renderer._updateArrowedPath(this);\r\n  },\r\n\r\n  _clickTolerance: function() {\r\n    return Math.max(this.options.weight/2, 8);\r\n  }\r\n\r\n});\r\nexport default JobSegment;","import React from 'react';\r\nimport JobSegment from \"./JobSegment.js\";\r\nimport Typography from '@material-ui/core/Typography';\r\nimport NavigationIcon from '@material-ui/icons/Navigation';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport ReactDOM from \"react-dom\";\r\nimport L from \"leaflet\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  myflight: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  icon: {\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  icaos: {\r\n    fontSize: '0.8em',\r\n    paddingLeft: theme.spacing(1)\r\n  }\r\n}));\r\n\r\n// Generate amount p\r\nfunction Cargo({cargo, pay, dir}) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Typography variant=\"body2\" className={classes.icon}>\r\n      <NavigationIcon fontSize=\"inherit\" style={{transform: 'rotate('+dir+'deg'}} />\r\n      {cargo.passengers > 0 && <span>&nbsp;{cargo.passengers} passengers</span>}\r\n      {cargo.kg > 0 && <span>&nbsp;{cargo.kg} kg</span>}\r\n      &nbsp;(${pay})\r\n    </Typography>\r\n  );\r\n}\r\n\r\n// Generate tooltip\r\nfunction Tooltip({leg, type, rleg, fromIcao, toIcao}) {\r\n  const classes = useStyles();\r\n  return (\r\n    <div>\r\n      <Typography variant=\"body1\"><b>{leg.distance} NM</b><span className={classes.icaos}>{fromIcao} - {toIcao}</span></Typography>\r\n      { leg.amount > 0 && <Cargo cargo={{[type]: leg.amount}} pay={leg.pay} dir={leg.direction} /> }\r\n      { rleg && rleg.amount > 0 && <Cargo cargo={{[type]: rleg.amount}} pay={rleg.pay} dir={rleg.direction} /> }\r\n      { (leg.flight || (rleg && rleg.flight)) &&\r\n        <div>\r\n          <Typography variant=\"body1\" className={classes.myflight}><b>My flight</b></Typography>\r\n          {leg.flight && <Cargo cargo={leg.flight} pay={leg.flight.pay} dir={leg.direction} />}\r\n          {rleg && rleg.flight && <Cargo cargo={rleg.flight} pay={rleg.flight.pay} dir={rleg.direction} />}\r\n        </div>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n// Generate all components to render leg\r\nfunction Job(props) {\r\n\r\n  // Add line\r\n  return new JobSegment(props.positions, {\r\n    weight: props.weight,\r\n    color: props.color,\r\n    highlight: props.highlight,\r\n    bothWays: props.rleg\r\n  })\r\n    .bindTooltip(() => {\r\n      var div = document.createElement('div');\r\n      ReactDOM.render(<Tooltip {...props} />, div);\r\n      return div;\r\n    }, {sticky: true})\r\n    .on('contextmenu', (evt) => {\r\n      L.DomEvent.stopPropagation(evt);\r\n      const actions = [\r\n        {\r\n          name: <span>Open {props.fromIcao} in FSE</span>,\r\n          onClick: () => {\r\n            let w = window.open('https://server.fseconomy.net/airport.jsp?icao='+props.fromIcao, 'fse');\r\n            w.focus();\r\n          }\r\n        },\r\n        {\r\n          name: <span>Open {props.toIcao} in FSE</span>,\r\n          onClick: () => {\r\n            let w = window.open('https://server.fseconomy.net/airport.jsp?icao='+props.toIcao, 'fse');\r\n            w.focus();\r\n          }\r\n        }\r\n      ];\r\n      props.actions.current.contextMenu({\r\n        mouseX: evt.originalEvent.clientX,\r\n        mouseY: evt.originalEvent.clientY,\r\n        title: <span>{props.fromIcao} - {props.toIcao} <NavigationIcon fontSize=\"inherit\" style={{transform: 'rotate('+props.leg.direction+'deg'}} /></span>,\r\n        actions: actions\r\n      });\r\n    });\r\n\r\n}\r\n\r\n\r\nexport default Job;","import React from 'react';\r\n\r\nimport { getDistance, getRhumbLineBearing, convertDistance } from \"geolib\";\r\nimport L from \"leaflet\";\r\nimport { useLeaflet } from \"react-leaflet\";\r\n\r\nimport Marker from \"./Components/Marker.js\";\r\nimport Job from \"./Components/Job.js\";\r\nimport { hideAirport } from \"../utility.js\";\r\n\r\n\r\nfunction cleanLegs(jobs, opts) {\r\n  const keys = Object.keys(jobs);\r\n  let legs = {};\r\n  let max = 0;\r\n  // Get legs\r\n  for (var i = keys.length - 1; i >= 0; i--) {\r\n    const leg = jobs[keys[i]];\r\n    const [frIcao, toIcao] = keys[i].split('-');\r\n    const fr = { latitude: opts.icaodata[frIcao].lat, longitude: opts.icaodata[frIcao].lon };\r\n    const to = { latitude: opts.icaodata[toIcao].lat, longitude: opts.icaodata[toIcao].lon };\r\n\r\n    // Filter out airports not meeting criterias\r\n    if (hideAirport(frIcao, opts.settings.airport) || hideAirport(toIcao, opts.settings.airport)) { continue; }\r\n\r\n    // Filter out jobs based on distance\r\n    if (opts.minDist && leg.distance < opts.minDist) { continue; }\r\n    if (opts.maxDist && leg.distance > opts.maxDist) { continue; }\r\n\r\n    // Filter out wrong types of jobs\r\n    if (!leg.hasOwnProperty(opts.cargo) || !leg[opts.cargo].hasOwnProperty(opts.type)) { continue; }\r\n\r\n    // Filter out jobs with wrong direction\r\n    if (opts.fromIcao) {\r\n      const fromIcao = { latitude: opts.icaodata[opts.fromIcao].lat, longitude: opts.icaodata[opts.fromIcao].lon };\r\n      if (opts.settings.from.distCoef !== '') {\r\n        if (getDistance(fromIcao, to)/getDistance(fromIcao, fr) < parseFloat(opts.settings.from.distCoef)) { continue; }\r\n      }\r\n      if (opts.settings.from.maxDist !== '') {\r\n        if (convertDistance(getDistance(fromIcao, fr), 'sm') > parseFloat(opts.settings.from.maxDist)) { continue; }\r\n      }\r\n      if (opts.settings.from.angle !== '') {\r\n        if (opts.fromIcao !== frIcao && 180 - Math.abs(Math.abs(getRhumbLineBearing(fr, to) - getRhumbLineBearing(fromIcao, fr)) - 180) > parseInt(opts.settings.from.angle)) { continue; }\r\n      }\r\n    }\r\n    if (opts.toIcao) {\r\n      const toIcao = { latitude: opts.icaodata[opts.toIcao].lat, longitude: opts.icaodata[opts.toIcao].lon };\r\n      if (opts.settings.to.distCoef !== '') {\r\n        if (getDistance(toIcao, fr)/getDistance(toIcao, to) < parseFloat(opts.settings.to.distCoef)) { continue; }\r\n      }\r\n      if (opts.settings.to.maxDist !== '') {\r\n        if (convertDistance(getDistance(toIcao, to), 'sm') > parseFloat(opts.settings.to.maxDist)) { continue; }\r\n      }\r\n      if (opts.settings.to.angle !== '') {\r\n        if (opts.toIcao !== toIcao && 180 - Math.abs(Math.abs(getRhumbLineBearing(fr, to) - getRhumbLineBearing(to, toIcao)) - 180) > parseInt(opts.settings.to.angle)) { continue; }\r\n      }\r\n    }\r\n    if (opts.direction) {\r\n      if (180 - Math.abs(Math.abs(leg.direction - opts.direction) - 180) > parseInt(opts.settings.direction.angle)) { continue; }\r\n    }\r\n\r\n    const filteredJobs = leg[opts.cargo][opts.type].filter(job => {\r\n      // Filter out bad payed jobs\r\n      if (opts.settings.pay.min_job && job.pay < opts.settings.pay.min_job) { return false; }\r\n      // Filter out jobs too big for plane\r\n      if (opts.max && job.nb > opts.max) { return false; }\r\n      return true;\r\n    });\r\n    if (filteredJobs.length < 1) { continue; }\r\n\r\n    // Compute total amount and pay\r\n    const [amount, pay] = filteredJobs.reduce(([amount, pay], job) => [amount+job.nb, pay+job.pay], [0, 0]);\r\n\r\n    // Filter out bad payed legs\r\n    if (opts.settings.pay.min_leg && pay < opts.settings.pay.min_leg) { continue; }\r\n    // Filter out legs with not enougth pax/kg\r\n    if (opts.min && amount < opts.min) { continue; }\r\n    \r\n    legs[keys[i]] = {\r\n      amount: amount,\r\n      pay: pay,\r\n      direction: leg.direction,\r\n      distance: leg.distance\r\n    };\r\n\r\n    max = Math.max(max, amount);\r\n  }\r\n  // Only keep top x% paying jobs\r\n  if (opts.settings.pay.top) {\r\n    const values = [];\r\n    // Compute each leg pay / amount / distance\r\n    Object.values(legs).forEach(leg => {\r\n      leg.pay_r = leg.pay/leg.amount/leg.distance\r\n      values.push(leg.pay_r);\r\n    });\r\n    values.sort((a, b) => a - b);\r\n    // Get values index\r\n    const index = Math.floor(values.length*(1-parseInt(opts.settings.pay.top)/100)) - 1;\r\n    // Get min pay\r\n    const min_pay = values[Math.min(Math.max(index, 0), values.length-1)];\r\n    // Filter out jobs\r\n    Object.keys(legs).filter(icao => legs[icao].pay_r < min_pay).forEach(icao => delete legs[icao]);\r\n  }\r\n  return [legs, max];\r\n}\r\nfunction addFlight(legs, jobs, opts) {\r\n  for (const job of Object.values(jobs)) {\r\n    const fr = { latitude: opts.icaodata[job.Location].lat, longitude: opts.icaodata[job.Location].lon };\r\n    const to = { latitude: opts.icaodata[job.Destination].lat, longitude: opts.icaodata[job.Destination].lon };\r\n    // Create source FBO\r\n    let key = job.Location+\"-\"+job.Destination;\r\n    if (!legs.hasOwnProperty(key)) {\r\n      legs[key] = {\r\n        amount: 0,\r\n        pay: 0,\r\n        direction: Math.round(getRhumbLineBearing(fr, to)),\r\n        distance: Math.round(convertDistance(getDistance(fr, to), 'sm'))\r\n      }\r\n    }\r\n    if (!legs[key].hasOwnProperty('flight')) {\r\n      legs[key].flight = {\r\n        passengers: 0,\r\n        kg: 0,\r\n        pay: 0,\r\n      }\r\n    }\r\n    legs[key].flight[job.Units] += job.Amount;\r\n    legs[key].flight.pay += job.Pay;\r\n  }\r\n  return legs;\r\n}\r\nfunction getMarkers(legs, opts) {\r\n  let markers = new Set();\r\n  // Add markers where a plane can be rented\r\n  Object.keys(opts.planes).forEach(elm => markers.add(elm));\r\n  // Add markers in filtering options\r\n  if (opts.fromIcao) { markers.add(opts.fromIcao); }\r\n  if (opts.toIcao) { markers.add(opts.toIcao); }\r\n  // Add markers in legs\r\n  Object.keys(legs).forEach((key) => {\r\n    let arr = key.split('-');\r\n    markers.add(arr[0]);\r\n    markers.add(arr[1]);\r\n  });\r\n  return [...markers];\r\n}\r\n\r\n\r\n\r\nconst Jobs = React.memo(function Jobs(props) {\r\n\r\n  const s = props.options.settings;\r\n  const groupRef = React.useRef(L.layerGroup());\r\n  const leaflet = React.useRef(useLeaflet());\r\n  const added = React.useRef(false);\r\n\r\n  React.useEffect(() => {\r\n\r\n    let [legs, max] = cleanLegs(props.options.jobs, props.options);\r\n    legs = addFlight(legs, props.options.flight, props.options);\r\n    const markers = getMarkers(legs, props.options);\r\n\r\n    // Clear previous markers and legs\r\n    groupRef.current.clearLayers();\r\n    \r\n    // Add Jobs\r\n    const legsKeys = Object.keys(legs);\r\n    for (var i = 0; i < legsKeys.length; i++) {\r\n      const [fr, to] = legsKeys[i].split('-');\r\n      const leg = legs[legsKeys[i]];\r\n      const rleg = legs[to+'-'+fr]\r\n\r\n      // Ensure only one line for both way legs\r\n      if (rleg && fr > to) { continue; }\r\n\r\n      // Compute line weight\r\n      const mw = parseFloat(s.display.legs.weights[props.options.cargo === 'passengers' ? 'passengers' : 'cargo']);\r\n      const min = props.options.min || 1;\r\n      const amount = rleg ? Math.max(leg.amount, rleg.amount) : leg.amount;\r\n      let weight = parseFloat(s.display.legs.weights.base);\r\n      if (mw) {\r\n        weight = ((amount-min) / (max-min)) * (mw - weight) + weight;\r\n      }\r\n\r\n      // Compute color\r\n      let color = s.display.legs.colors[props.options.cargo === 'passengers' ? 'passengers' : 'cargo'];\r\n\r\n      // Special color and weight if My Flight\r\n      if (leg.flight || (rleg && rleg.flight)) {\r\n        color = s.display.legs.colors.flight;\r\n        weight = parseFloat(s.display.legs.weights.flight);\r\n      }\r\n\r\n      Job({\r\n        positions: [[props.options.icaodata[fr].lat, props.options.icaodata[fr].lon], [props.options.icaodata[to].lat, props.options.icaodata[to].lon]],\r\n        color: color,\r\n        highlight: s.display.legs.colors.highlight,\r\n        weight: weight,\r\n        leg: leg,\r\n        rleg: rleg,\r\n        type: props.options.cargo,\r\n        actions: props.actions,\r\n        fromIcao: fr,\r\n        toIcao: to\r\n      })\r\n        .addTo(groupRef.current);\r\n    }\r\n\r\n    // Add Markers\r\n    for (i = 0; i < markers.length; i++) {\r\n      const marker = markers[i];\r\n\r\n      // Compute marker color\r\n      let color = s.display.markers.colors.base;\r\n      let size = s.display.markers.sizes.base;\r\n      if (props.options.planes[marker]) {\r\n        color = s.display.markers.colors.rentable;\r\n        size = s.display.markers.sizes.rentable;\r\n      }\r\n      if (marker === props.options.fromIcao || marker === props.options.toIcao) {\r\n        color = s.display.markers.colors.selected;\r\n        size = s.display.markers.sizes.selected;\r\n      }\r\n\r\n      // Create marker\r\n      Marker({\r\n        position: [props.options.icaodata[marker].lat, props.options.icaodata[marker].lon],\r\n        size: size,\r\n        color: color,\r\n        icao: marker,\r\n        icaodata: props.options.icaodata,\r\n        planes: props.options.planes[marker],\r\n        siminfo: s.display.sim,\r\n        actions: props.actions,\r\n        id: 'jobs'+color\r\n      })\r\n        .addTo(groupRef.current)\r\n    }\r\n\r\n    // Add layer to map\r\n    if (!added.current) {\r\n      leaflet.current.layerContainer.addLayer(groupRef.current);\r\n      added.current = true;\r\n    }\r\n  }, [props, s]);\r\n\r\n  return null;\r\n\r\n});\r\n\r\nexport default Jobs;\r\n","import React from 'react';\r\n\r\nimport { getDistance, getRhumbLineBearing, convertDistance } from \"geolib\";\r\nimport L from \"leaflet\";\r\nimport { useLeaflet } from \"react-leaflet\";\r\n\r\nimport Marker from \"./Components/Marker.js\";\r\nimport Job from \"./Components/Job.js\";\r\n\r\n\r\nconst Route = React.memo(function Route(props) {\r\n\r\n  const s = props.options.settings;\r\n  const groupRef = React.useRef(L.layerGroup());\r\n  const leaflet = React.useRef(useLeaflet());\r\n  const added = React.useRef(false);\r\n\r\n  React.useEffect(() => {\r\n    const route = props.route;\r\n\r\n    // Clear previous markers and legs\r\n    groupRef.current.clearLayers();\r\n\r\n    if (!route) {\r\n      return;\r\n    }\r\n\r\n    // Create legs\r\n    const legs = {};\r\n    for (var i = 1; i < route.icaos.length; i++) {\r\n      const toIcao = route.icaos[i];\r\n      const fromIcao = route.icaos[i-1];\r\n      const fr = { latitude: props.options.icaodata[fromIcao].lat, longitude: props.options.icaodata[fromIcao].lon };\r\n      const to = { latitude: props.options.icaodata[toIcao].lat, longitude: props.options.icaodata[toIcao].lon };\r\n      let key = fromIcao+\"-\"+toIcao;\r\n      if (!legs.hasOwnProperty(key)) {\r\n        legs[key] = {\r\n          amount: 0,\r\n          pay: 0,\r\n          direction: Math.round(getRhumbLineBearing(fr, to)),\r\n          distance: Math.round(convertDistance(getDistance(fr, to), 'sm')),\r\n          flight: {\r\n            passengers: 0,\r\n            kg: 0,\r\n            pay: 0\r\n          }\r\n        }\r\n      }\r\n      legs[key].flight.kg += route.cargos[i-1].TripOnly.reduce((acc, elm) => acc + elm.kg, 0);\r\n      legs[key].flight.kg += route.cargos[i-1].VIP.reduce((acc, elm) => acc + elm.kg, 0);\r\n      legs[key].flight.passengers += route.cargos[i-1].TripOnly.reduce((acc, elm) => acc + elm.pax, 0);\r\n      legs[key].flight.passengers += route.cargos[i-1].VIP.reduce((acc, elm) => acc + elm.pax, 0);\r\n      legs[key].flight.pay += route.cargos[i-1].TripOnly.reduce((acc, elm) => acc + elm.pay, 0);\r\n      legs[key].flight.pay += route.cargos[i-1].VIP.reduce((acc, elm) => acc + elm.pay, 0);\r\n    }\r\n\r\n    // Add jobs to map\r\n    const legsKeys = Object.keys(legs);\r\n    for (i = 0; i < legsKeys.length; i++) {\r\n      const [fr, to] = legsKeys[i].split('-');\r\n      const leg = legs[legsKeys[i]];\r\n      const rleg = legs[to+'-'+fr]\r\n\r\n      // Ensure only one line for both way legs\r\n      if (rleg && fr > to) { continue; }\r\n\r\n      Job({\r\n        positions: [[props.options.icaodata[fr].lat, props.options.icaodata[fr].lon], [props.options.icaodata[to].lat, props.options.icaodata[to].lon]],\r\n        color: s.display.legs.colors.flight,\r\n        highlight: s.display.legs.colors.highlight,\r\n        weight: parseFloat(s.display.legs.weights.flight),\r\n        leg: leg,\r\n        rleg: rleg,\r\n        actions: props.actions,\r\n        fromIcao: fr,\r\n        toIcao: to\r\n      })\r\n        .addTo(groupRef.current);\r\n    }\r\n\r\n    // Add markers to map\r\n    for (i = 0; i < route.icaos.length; i++) {\r\n      const icao = route.icaos[i];\r\n      Marker({\r\n        position: [props.options.icaodata[icao].lat, props.options.icaodata[icao].lon],\r\n        size: s.display.markers.sizes.selected,\r\n        color: s.display.markers.colors.selected,\r\n        icao: icao,\r\n        icaodata: props.options.icaodata,\r\n        planes: props.options.planes[icao],\r\n        siminfo: s.display.sim,\r\n        actions: props.actions,\r\n        id: 'route'\r\n      })\r\n        .addTo(groupRef.current);\r\n    }\r\n\r\n\r\n    // Add layer to map\r\n    if (!added.current) {\r\n      leaflet.current.layerContainer.addLayer(groupRef.current);\r\n      added.current = true;\r\n    }\r\n\r\n  }, [props, s]);\r\n\r\n  return null;\r\n\r\n});\r\n\r\nexport default Route;\r\n","import React from 'react';\r\n\r\nimport L from \"leaflet\";\r\nimport { useLeaflet } from \"react-leaflet\";\r\n\r\n\r\nconst ZonesLayer = React.memo(function ZonesLayer(props) {\r\n\r\n  const groupRef = React.useRef(L.layerGroup());\r\n  const leaflet = React.useRef(useLeaflet());\r\n  const added = React.useRef(false);\r\n\r\n  // Display all airports on map\r\n  React.useEffect(() => {\r\n\r\n    // Clear previous markers\r\n    groupRef.current.clearLayers();\r\n  \r\n    props.icaos.forEach(icao =>\r\n\r\n      // Create marker\r\n      L.polyline(\r\n        props.icaodata[icao].zone,\r\n        {\r\n          weight: 1,\r\n          color: '#888',\r\n          interactive: false,\r\n          fill: false\r\n      })\r\n        .addTo(groupRef.current)\r\n    );\r\n\r\n    // Add layer to map\r\n    if (!added.current) {\r\n      leaflet.current.layerContainer.addLayer(groupRef.current);\r\n      added.current = true;\r\n    }\r\n\r\n  }, [props.color, props.icaos, props.icaodata]);\r\n\r\n\r\n  return null;\r\n\r\n\r\n});\r\n\r\nexport default ZonesLayer;\r\n","import React from 'react';\r\n\r\nimport L from \"leaflet\";\r\nimport { useLeaflet } from \"react-leaflet\";\r\nimport { getDistance, getRhumbLineBearing, convertDistance } from \"geolib\";\r\n\r\nimport Marker from \"./Components/Marker.js\";\r\nimport Job from \"./Components/Job.js\";\r\nimport { hideAirport } from \"../utility.js\";\r\n\r\nconst AirportsLayer = React.memo(function AirportsLayer(props) {\r\n\r\n  const groupRef = React.useRef(L.featureGroup());\r\n  const leaflet = React.useRef(useLeaflet());\r\n  const added = React.useRef(false);\r\n\r\n  // Display all airports on map\r\n  React.useEffect(() => {\r\n\r\n    // Clear previous markers\r\n    groupRef.current.clearLayers();\r\n\r\n    // Create lines if needed\r\n    if (props.weight) {\r\n      let prevIcao = null;\r\n      let legs = {};\r\n      for (const icao of props.icaos) {\r\n        if (prevIcao) {\r\n          const fr = { latitude: props.icaodata[prevIcao].lat, longitude: props.icaodata[prevIcao].lon };\r\n          const to = { latitude: props.icaodata[icao].lat, longitude: props.icaodata[icao].lon };\r\n          let key = prevIcao+\"-\"+icao;\r\n          if (!legs.hasOwnProperty(key)) {\r\n            legs[key] = {\r\n              amount: 0,\r\n              pay: 0,\r\n              direction: Math.round(getRhumbLineBearing(fr, to)),\r\n              distance: Math.round(convertDistance(getDistance(fr, to), 'sm')),\r\n            }\r\n          }\r\n        }\r\n        prevIcao = icao;\r\n      }\r\n\r\n      const legsKeys = Object.keys(legs);\r\n\r\n      for (var i = 0; i < legsKeys.length; i++) {\r\n        const [fr, to] = legsKeys[i].split('-');\r\n        const leg = legs[legsKeys[i]];\r\n        const rleg = legs[to+'-'+fr]\r\n\r\n        // Ensure only one line for both way legs\r\n        if (rleg && fr > to) { continue; }\r\n        \r\n        Job({\r\n          positions: [[props.icaodata[fr].lat, props.icaodata[fr].lon], [props.icaodata[to].lat, props.icaodata[to].lon]],\r\n          color: props.color,\r\n          highlight: props.highlight,\r\n          weight: parseFloat(props.weight),\r\n          leg: leg,\r\n          rleg: rleg,\r\n          actions: props.actions,\r\n          fromIcao: fr,\r\n          toIcao: to\r\n        })\r\n          .addTo(groupRef.current);\r\n      }\r\n    }\r\n\r\n    // Create markers\r\n    for (const icao of props.icaos) {\r\n      if (hideAirport(icao, props.airportFilter)) { continue; }\r\n      Marker({\r\n        position: [props.icaodata[icao].lat, props.icaodata[icao].lon],\r\n        size: props.size,\r\n        color: props.color,\r\n        icao: icao,\r\n        icaodata: props.fseicaodata,\r\n        actions: props.actions,\r\n        siminfo: props.siminfo,\r\n        sim: props.sim,\r\n        id: 'sim'+props.id\r\n      })\r\n        .addTo(groupRef.current);\r\n    }\r\n\r\n    // Add layer to map\r\n    if (!added.current) {\r\n      leaflet.current.layerContainer.addLayer(groupRef.current);\r\n      added.current = true;\r\n    }\r\n\r\n  }, [\r\n    props.color,\r\n    props.size,\r\n    props.icaos,\r\n    props.icaodata,\r\n    props.link,\r\n    props.siminfo,\r\n    props.sim,\r\n    props.fseicaodata,\r\n    props.actions,\r\n    props.id,\r\n    props.weight,\r\n    props.highlight,\r\n    props.airportFilter\r\n  ]);\r\n\r\n  return null;\r\n\r\n});\r\n\r\nexport default AirportsLayer;\r\n","import React from 'react';\r\nimport Popover from '@material-ui/core/Popover';\r\nimport MenuList from '@material-ui/core/MenuList';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { Map, TileLayer, LayersControl } from \"react-leaflet\";\r\nimport { getBounds } from \"geolib\";\r\nimport L from \"leaflet\";\r\n\r\nimport Canvas from \"./MapLayers/Components/Canvas.js\";\r\nimport JobsLayer from \"./MapLayers/Jobs.js\";\r\nimport RouteLayer from \"./MapLayers/Route.js\";\r\nimport ZonesLayer from \"./MapLayers/Zones.js\";\r\nimport AirportsLayer from \"./MapLayers/Airports.js\";\r\nimport Marker from \"./MapLayers/Components/Marker.js\";\r\n\r\nimport msfs from \"./data/msfs.json\";\r\nconst msfsIcaos = Object.keys(msfs);\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  contextMenu: {\r\n    minWidth: 200\r\n  },\r\n  contextMenuTitle: {\r\n    margin: theme.spacing(1),\r\n    fontWeight: 'bold'\r\n  },\r\n  contextMenuList: {\r\n    paddingTop: 0\r\n  }\r\n}));\r\n\r\nconst FSEMap = React.memo(function FSEMap(props) {\r\n\r\n  const s = props.options.settings;\r\n  const mapRef = props.mapRef;\r\n  const classes = useStyles();\r\n  const canvasRendererRef = React.useRef(new Canvas({ padding: 0.5 }));\r\n  const maxBounds=[[-90, s.display.map.center-180], [90, s.display.map.center+180]];\r\n  const [contextMenu, setContextMenu] = React.useState(null);\r\n  const [unbuiltFBOs, setUnbuildFBOs] = React.useState([]);\r\n\r\n  // Display search marker\r\n  const searchRef = React.useRef(null);\r\n  const prevSearchRef = React.useRef(null);\r\n  React.useEffect(() => {\r\n\r\n    // If marker already exists remove it\r\n    if (searchRef.current) {\r\n      searchRef.current.remove();\r\n      searchRef.current = null;\r\n    }\r\n\r\n    // Only draw marker if search is not empty\r\n    if (props.search) {\r\n      searchRef.current = Marker({\r\n        position: [props.options.icaodata[props.search].lat, props.options.icaodata[props.search].lon],\r\n        size: s.display.markers.sizes.selected,\r\n        color: s.display.markers.colors.selected,\r\n        icao: props.search,\r\n        icaodata: props.options.icaodata,\r\n        planes: props.options.planes[props.search],\r\n        siminfo: s.display.sim,\r\n        actions: props.actions,\r\n        id: 'search'\r\n      })\r\n        .addTo(mapRef.current.leafletElement);\r\n      // Only open popup if search ICAO has changed\r\n      if (prevSearchRef.current !== props.search) {\r\n        setTimeout(() => { searchRef.current && searchRef.current.openPopup() }, 10);\r\n      }\r\n    }\r\n\r\n    prevSearchRef.current = props.search;\r\n  }, [\r\n    props.search,\r\n    props.options.icaodata,\r\n    props.options.planes,\r\n    s.display.sim,\r\n    s.display.markers.colors.selected,\r\n    s.display.markers.sizes.selected,\r\n    props.actions,\r\n    mapRef\r\n  ]);\r\n\r\n  // Set search marker on top at each render\r\n  React.useEffect(() => {\r\n    if (searchRef.current) {\r\n      searchRef.current.bringToFront();\r\n    }\r\n  }, [props.options]);\r\n\r\n  // Clear canvas cache on settings change\r\n  React.useEffect(() => {\r\n    canvasRendererRef.current.clearCache();\r\n  }, [s]);\r\n\r\n\r\n  // Auto zoom map on jobs\r\n  React.useEffect(() => {\r\n    const icaos = new Set();\r\n    Object.keys(props.options.jobs).forEach(key => icaos.add(key.split('-')[0]));\r\n    const points = [...icaos].map(elm => props.options.icaodata[elm]);\r\n    if (points.length > 4) {\r\n      const b = getBounds(points);\r\n      mapRef.current.leafletElement.fitBounds([[b.minLat, b.minLng], [b.maxLat, b.maxLng]], {animate:false});\r\n    }\r\n  }, [props.options.jobs, props.options.icaodata, mapRef]);\r\n\r\n  // Auto zoom on route\r\n  React.useEffect(() => {\r\n    if (props.route) {\r\n      const b = getBounds(props.route.icaos.map(elm => props.options.icaodata[elm]));\r\n      const bounds = L.latLngBounds([b.minLat, b.minLng], [b.maxLat, b.maxLng]);\r\n      const mapBounds = mapRef.current.leafletElement.getBounds();\r\n      if (!mapBounds.contains(bounds)) {\r\n        mapRef.current.leafletElement.fitBounds(mapBounds.extend(bounds));\r\n      }\r\n    }\r\n  }, [props.route, props.options.icaodata, mapRef]);\r\n\r\n  // Load unbuilt lots\r\n  React.useEffect(() => {\r\n    fetch('https://piero-la-lune.fr/fseplanner/data/unbuilt.json').then(response => {\r\n      if (response.ok) {\r\n        response.json().then(arr => {\r\n          setUnbuildFBOs(arr);\r\n        });\r\n      }\r\n    });\r\n  }, []);\r\n\r\n\r\n  props.actions.current.contextMenu = setContextMenu;\r\n\r\n  const closeContextMenu = () => {\r\n    setContextMenu(null);\r\n  };\r\n\r\n\r\n  return (\r\n    <Map\r\n      center={[46.5344, 3.42167]}\r\n      zoom={6}\r\n      ref={mapRef}\r\n      maxBounds={maxBounds}\r\n      attributionControl={false}\r\n      minZoom={2}\r\n      maxZoom={12}\r\n      renderer={canvasRendererRef.current}\r\n      onContextMenu={(evt) => {\r\n        evt.originalEvent.stopPropagation();\r\n        evt.originalEvent.preventDefault();\r\n        const lat = Math.round((evt.latlng.lat + Number.EPSILON) * 10000) / 10000;\r\n        const lon = Math.round((evt.latlng.lng + Number.EPSILON) * 10000) / 10000;\r\n        setContextMenu({\r\n          mouseX: evt.originalEvent.clientX,\r\n          mouseY: evt.originalEvent.clientY,\r\n          title: (lat >= 0 ? lat+'N ' : (-lat)+'S ') + (lon >= 0 ? lon+'E': (-lon)+'W'),\r\n          actions: []\r\n        });\r\n      }}\r\n    >\r\n      {contextMenu &&\r\n        <Popover\r\n          open={true}\r\n          onClose={closeContextMenu}\r\n          anchorReference=\"anchorPosition\"\r\n          anchorPosition={\r\n            { top: contextMenu.mouseY, left: contextMenu.mouseX }\r\n          }\r\n          onContextMenu={(evt) => {evt.preventDefault(); evt.stopPropagation();}}\r\n          classes={{paper:classes.contextMenu}}\r\n        >\r\n          <Typography variant=\"body1\" className={classes.contextMenuTitle}>{contextMenu.title}</Typography>\r\n          {contextMenu.actions.length > 0 &&\r\n            <MenuList className={classes.contextMenuList}>\r\n              { contextMenu.actions.map((action, i) =>\r\n                <MenuItem dense key={i} onClick={() => { action.onClick(); closeContextMenu(); }}>{action.name}</MenuItem>\r\n              )}\r\n            </MenuList>\r\n          }\r\n        </Popover>\r\n      }\r\n      <TileLayer\r\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n      />\r\n      <LayersControl position=\"topleft\">\r\n        <LayersControl.Overlay name=\"FSE airports\" checked={true}>\r\n          <AirportsLayer\r\n            icaos={props.icaos}\r\n            icaodata={props.options.icaodata}\r\n            fseicaodata={props.options.icaodata}\r\n            color={s.display.markers.colors.fse}\r\n            size={s.display.markers.sizes.fse}\r\n            airportFilter={s.airport}\r\n            siminfo={s.display.sim}\r\n            actions={props.actions}\r\n            id=\"fse\"\r\n          />\r\n        </LayersControl.Overlay>\r\n        <LayersControl.Overlay name=\"Unbuilt lots\" checked={false}>\r\n          <AirportsLayer\r\n            icaos={unbuiltFBOs}\r\n            icaodata={props.options.icaodata}\r\n            fseicaodata={props.options.icaodata}\r\n            color={s.display.markers.colors.fse}\r\n            size={s.display.markers.sizes.custom}\r\n            airportFilter={s.airport}\r\n            siminfo={s.display.sim}\r\n            actions={props.actions}\r\n            id=\"fbo\"\r\n          />\r\n        </LayersControl.Overlay>\r\n        <LayersControl.Overlay name=\"MSFS airports\" checked={false}>\r\n          <AirportsLayer\r\n            icaos={msfsIcaos}\r\n            icaodata={msfs}\r\n            fseicaodata={props.options.icaodata}\r\n            color={s.display.markers.colors.msfs}\r\n            size={s.display.markers.sizes.msfs}\r\n            siminfo={s.display.sim}\r\n            sim=\"msfs\"\r\n            actions={props.actions}\r\n            id=\"msfs\"\r\n          />\r\n        </LayersControl.Overlay>\r\n        <LayersControl.Overlay name=\"FSE airports landing area\" checked={false}>\r\n          <ZonesLayer\r\n            icaos={props.icaos}\r\n            icaodata={props.options.icaodata}\r\n            renderer={canvasRendererRef.current}\r\n            color={s.display.markers.colors.base}\r\n          />\r\n        </LayersControl.Overlay>\r\n        <LayersControl.Overlay name=\"Job & plane search\" checked={true}>\r\n          <JobsLayer\r\n            options={props.options}\r\n            renderer={canvasRendererRef.current}\r\n            actions={props.actions}\r\n          />\r\n        </LayersControl.Overlay>\r\n        <LayersControl.Overlay name=\"Route finder\" checked={true}>\r\n          <RouteLayer\r\n            options={props.options}\r\n            renderer={canvasRendererRef.current}\r\n            actions={props.actions}\r\n            route={props.route}\r\n          />\r\n        </LayersControl.Overlay>\r\n        <LayersControl.Overlay name=\"Custom markers\" checked={true}>\r\n          <AirportsLayer\r\n            icaos={props.customIcaos}\r\n            icaodata={props.options.icaodata}\r\n            fseicaodata={props.options.icaodata}\r\n            color={s.display.markers.colors.custom}\r\n            size={s.display.markers.sizes.custom}\r\n            weight={s.display.legs.display.custom ? s.display.legs.weights.flight : undefined}\r\n            highlight={s.display.legs.colors.highlight}\r\n            siminfo={s.display.sim}\r\n            actions={props.actions}\r\n            id=\"custom\"\r\n          />\r\n        </LayersControl.Overlay>\r\n      </LayersControl>\r\n    </Map>\r\n  );\r\n\r\n});\r\n\r\nexport default FSEMap;\r\n","export default function() {\n  return new Worker(__webpack_public_path__ + \"static/js/routing.worker.6e4e99a2.worker.js\");\n}\n","import React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport ToggleButton from '@material-ui/lab/ToggleButton';\r\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\r\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\r\nimport MonetizationOnIcon from '@material-ui/icons/MonetizationOn';\r\nimport SettingsEthernetIcon from '@material-ui/icons/SettingsEthernet';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport TimerIcon from '@material-ui/icons/Timer';\r\nimport Link from '@material-ui/core/Link';\r\nimport Timeline from '@material-ui/lab/Timeline';\r\nimport TimelineItem from '@material-ui/lab/TimelineItem';\r\nimport TimelineSeparator from '@material-ui/lab/TimelineSeparator';\r\nimport TimelineConnector from '@material-ui/lab/TimelineConnector';\r\nimport TimelineContent from '@material-ui/lab/TimelineContent';\r\nimport TimelineDot from '@material-ui/lab/TimelineDot';\r\nimport TimelineOppositeContent from '@material-ui/lab/TimelineOppositeContent';\r\nimport Popover from '@material-ui/core/Popover';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { getDistance, convertDistance, getBounds } from \"geolib\";\r\n\r\nimport RoutingWorker from './routing.worker.js';\r\nimport { hideAirport } from \"./utility.js\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  routing: {\r\n    width: 400,\r\n    background: \"#eee\",\r\n    boxShadow: \"0 0 20px rgba(0, 0, 0, 0.3)\",\r\n    zIndex: 1000,\r\n    display: \"flex\",\r\n    flexDirection: \"column\"\r\n  },\r\n  title: {\r\n    textAlign: \"center\",\r\n    marginTop: theme.spacing(3),\r\n    marginBottom: theme.spacing(3),\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n    fontWeight: 300,\r\n    position: \"relative\"\r\n  },\r\n  pMore: {\r\n    textAlign: \"center\",\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  more: {\r\n    color: \"#666\",\r\n    cursor: \"pointer\",\r\n    \"&:hover\": {\r\n      color: \"#000\"\r\n    }\r\n  },\r\n  pButtons: {\r\n    marginTop: theme.spacing(4),\r\n    marginBottom: theme.spacing(2),\r\n    textAlign: \"center\"\r\n  },\r\n  content: {\r\n    overflowX: \"hidden\",\r\n    overflowY: \"auto\",\r\n    scrollbarWidth: \"thin\",\r\n    background: \"#fff\"\r\n  },\r\n  result: {\r\n    padding: theme.spacing(3),\r\n    borderBottom: \"1px solid #eee\",\r\n    cursor: \"pointer\",\r\n    \"&:hover\": {\r\n      background: \"#f9f9f9\"\r\n    },\r\n    position: \"relative\"\r\n  },\r\n  separator: {\r\n    marginLeft: 1,\r\n    marginRight: 1\r\n  },\r\n  icon: {\r\n    marginRight: theme.spacing(0.2)\r\n  },\r\n  grid: {\r\n    marginTop: theme.spacing(1),\r\n    marginLeft: -theme.spacing(2)\r\n  },\r\n  gridText: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  sortByValue: {\r\n    position: \"absolute\",\r\n    top: theme.spacing(1),\r\n    right: theme.spacing(1),\r\n    color: \"#aaa\",\r\n    fontSize: \"0.8em\"\r\n  },\r\n  form: {\r\n    padding: theme.spacing(2),\r\n  },\r\n  formLabel: {\r\n    marginBottom: theme.spacing(1.5),\r\n    marginTop: 0\r\n  },\r\n  moreSettings: {\r\n    marginTop: theme.spacing(4),\r\n    paddingTop: theme.spacing(4),\r\n    borderTop: \"1px solid #ccc\",\r\n  },\r\n  typeButtons: {\r\n    marginBottom: theme.spacing(3),\r\n    marginTop: theme.spacing(4)\r\n  },\r\n  tlOp: {\r\n    flex: 10\r\n  },\r\n  tlCt: {\r\n    minWidth: 50,\r\n    fontSize: '1.2em',\r\n    marginTop: '-4px'\r\n  },\r\n  tlPaper: {\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(2),\r\n    paddingTop: theme.spacing(1),\r\n    paddingBottom: theme.spacing(1)\r\n  },\r\n  tlGrid: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  tlGridText: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  tlTotal: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  back: {\r\n    padding: theme.spacing(3),\r\n    borderBottom: \"1px solid #eee\",\r\n    cursor: \"pointer\",\r\n    background: \"#fff\",\r\n    display: \"flex\",\r\n    \"&:hover\": {\r\n      background: \"#f9f9f9\"\r\n    }\r\n  },\r\n  backText: {\r\n    verticalAlign: 'middle',\r\n    display: 'inline-flex'\r\n  },\r\n  topResults: {\r\n    background: \"#fff\",\r\n    display: \"flex\",\r\n    alignItems: \"center\"\r\n  },\r\n  nbResults: {\r\n    background: \"#fff\",\r\n    borderBottom: \"1px solid #eee\",\r\n    padding: theme.spacing(1)\r\n  },\r\n  backSearch: {\r\n    cursor: \"pointer\",\r\n    height: \"100%\",\r\n    \"&:hover\": {\r\n      background: \"#f9f9f9\"\r\n    }\r\n  },\r\n  backSearchText: {\r\n    lineHeight: 0.8,\r\n    textAlign: \"center\",\r\n    paddingTop: theme.spacing(2),\r\n    paddingBottom: theme.spacing(2),\r\n    paddingLeft: theme.spacing(1.5),\r\n    paddingRight: theme.spacing(1.5)\r\n  },\r\n  topResultsDiv: {\r\n    paddingTop: theme.spacing(2),\r\n    paddingBottom: theme.spacing(2),\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1)\r\n  },\r\n  filterBtn: {\r\n    width: 150,\r\n    fontSize: \"0.8em\"\r\n  },\r\n  filters: {\r\n    maxWidth: 300,\r\n    paddingTop: theme.spacing(1),\r\n    paddingBottom: theme.spacing(1),\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(2),\r\n  },\r\n  filtersInput: {\r\n    width: \"100%\"\r\n  },\r\n  filtersApply: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  closeButton: {\r\n    position: 'absolute',\r\n    right: 0,\r\n    top: 0,\r\n    color: theme.palette.grey[500],\r\n  },\r\n  progressBar: {\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(2),\r\n  }\r\n}));\r\n\r\n\r\n\r\nfunction textTotalCargo(cargos, kgPax = true) {\r\n  const text = [];\r\n  let pax = 0;\r\n  let kg = 0;\r\n  for (const cargo of cargos) {\r\n    pax += cargo.pax;\r\n    if (!cargo.pax || kgPax) {\r\n      kg += cargo.kg;\r\n    }\r\n  }\r\n  if (pax) {\r\n    if (pax > 1) {\r\n      text.push(pax + ' passengers');\r\n    }\r\n    else {\r\n      text.push('1 passenger');\r\n    }\r\n  }\r\n  if (kg) {\r\n    text.push(kg + 'kg');\r\n  }\r\n  return text.join(' and ');\r\n}\r\n\r\nfunction filterText(sortBy, result) {\r\n  switch(sortBy) {\r\n    case 'payNM': return '$'+Math.round(result.payNM)+'/NM';\r\n    case 'payLeg': return '$'+Math.round(result.payLeg)+'/leg';\r\n    case 'payTime': return '$'+Math.round(result.payTime)+'/H';\r\n    case 'pay': return '';\r\n    default: return '$'+result.b+' bonus';\r\n  }\r\n}\r\n\r\nconst Results = React.memo(({results, classes, showDetail, goTo, setRoute, nbDisplay, sortBy}) => {\r\n  return (\r\n    results.slice(0, nbDisplay).map(result =>\r\n      <div\r\n        className={classes.result}\r\n        key={result.id}\r\n        onClick={() => showDetail(result)}\r\n        onMouseEnter={() => setRoute(result)}\r\n      >\r\n        <Breadcrumbs\r\n          separator={<NavigateNextIcon fontSize=\"small\" />}\r\n          classes={{separator:classes.separator}}\r\n          maxItems={5}\r\n          itemsBeforeCollapse={3}\r\n        >\r\n          {result.icaos.map((icao, i) =>\r\n            <Link\r\n              href=\"#\"\r\n              onClick={evt => {\r\n                evt.stopPropagation();\r\n                evt.preventDefault();\r\n                goTo(icao)\r\n              }}\r\n              key={i}\r\n            >{icao}</Link>\r\n          )}\r\n        </Breadcrumbs>\r\n        <Grid container spacing={1} className={classes.grid}>\r\n          <Grid item xs={4}>\r\n            <Typography variant=\"body2\" className={classes.gridText}><MonetizationOnIcon className={classes.icon} />{result.pay}</Typography>\r\n          </Grid>\r\n          <Grid item xs={4}>\r\n            <Typography variant=\"body2\" className={classes.gridText}><SettingsEthernetIcon className={classes.icon} />{result.distance} NM</Typography>\r\n          </Grid>\r\n          <Grid item xs={4}>\r\n            <Typography variant=\"body2\" className={classes.gridText}><TimerIcon className={classes.icon} />{result.time}</Typography>\r\n          </Grid>\r\n        </Grid>\r\n        <Typography variant=\"body2\" className={classes.sortByValue}>{filterText(sortBy, result)}</Typography>\r\n      </div>\r\n    )\r\n  );\r\n});\r\n\r\n\r\nconst Routing = React.memo((props) => {\r\n  const results = React.useRef(null);\r\n  const resultsScroll = React.useRef(0);\r\n  const resultsDiv = React.useRef(null);\r\n  const [filteredResults, setFilteredResults] = React.useState(null);\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [moreSettings, setMoreSettings] = React.useState(false);\r\n  const [maxPax, setMaxPax] = React.useState('');\r\n  const [maxKg, setMaxKg] = React.useState('');\r\n  const [fromIcao, setFromIcao] = React.useState('');\r\n  const [toIcao, setToIcao] = React.useState('');\r\n  const [maxHops, setMaxHops] = React.useState(4);\r\n  const [maxStops, setMaxStops] = React.useState(1);\r\n  const [speed, setSpeed] = React.useState(250);\r\n  const [approachLength, setApproachLength] = React.useState(10);\r\n  const [loop, setLoop] = React.useState(false);\r\n  const [type, setType] = React.useState('rent');\r\n  const [minLoad, setMinLoad] = React.useState(80);\r\n  const [maxBadLegs, setMaxBadLegs] = React.useState(2);\r\n  const [sortBy, setSortBy] = React.useState('payTime');\r\n  const [focus, setFocus] = React.useState(null);\r\n  const [filterMenu, setFilterMenu] = React.useState(null);\r\n  const [minDist, setMinDist] = React.useState('');\r\n  const [maxDist, setMaxDist] = React.useState('');\r\n  const [minPay, setMinPay] = React.useState('');\r\n  const [maxPay, setMaxPay] = React.useState('');\r\n  const [minTime, setMinTime] = React.useState('');\r\n  const [maxTime, setMaxTime] = React.useState('');\r\n  const [nbDisplay, setNbDisplay] = React.useState(20);\r\n  const [progress, setProgress] = React.useState(0);\r\n  const [cancel, setCancel] = React.useState(null);\r\n  const classes = useStyles();\r\n\r\n  const sortFunctions = {\r\n    payNM: (a, b) => b.payNM - a.payNM,\r\n    payLeg: (a, b) => b.payLeg - a.payLeg,\r\n    payTime: (a, b) => b.payTime - a.payTime,\r\n    pay: (a, b) => b.pay - a.pay,\r\n    bonus: (a, b) => b.b - a.b,\r\n  }\r\n\r\n  const changeSortBy = (evt) => {\r\n    setSortBy(evt.target.value);\r\n    if (results.current !== null) {\r\n      filteredResults.sort(sortFunctions[evt.target.value]);\r\n      setFilteredResults([...filteredResults]);\r\n    }\r\n  }\r\n  const filterResults = () => {\r\n    if (results.current !== null) {\r\n      let minTimeNb = null;\r\n      let maxTimeNb = null;\r\n      if (minTime) {\r\n        const t = minTime.split(':');\r\n        if (t.length === 2) {\r\n          minTimeNb = parseInt(t[0]) + parseInt(t[1])/60;\r\n        }\r\n        else {\r\n          setMinTime('');\r\n        }\r\n      }\r\n      if (maxTime) {\r\n        const t = maxTime.split(':');\r\n        if (t.length === 2) {\r\n          maxTimeNb = parseInt(t[0]) + parseInt(t[1])/60;\r\n        }\r\n        else {\r\n          setMaxTime('');\r\n        }\r\n      }\r\n\r\n      const r = results.current.filter(elm => {\r\n        return !(\r\n             (minDist && elm.distance < minDist)\r\n          || (maxDist && elm.distance > maxDist)\r\n          || (minPay && elm.pay < minPay)\r\n          || (maxPay && elm.pay > maxPay)\r\n          || (minTimeNb && elm.timeNb < minTimeNb)\r\n          || (maxTimeNb && elm.timeNb > maxTimeNb)\r\n        );\r\n      })\r\n      r.sort(sortFunctions[sortBy]);\r\n      setFilteredResults(r);\r\n      setFilterMenu(null);\r\n    }\r\n  }\r\n\r\n  const setRoute = props.setRoute;\r\n  const showDetail = React.useCallback((result) => {\r\n    resultsScroll.current = resultsDiv.current.scrollTop;\r\n    setFocus(result);\r\n    setRoute(result);\r\n    // Center map on route\r\n    const b = getBounds(result.icaos.map(elm => props.options.icaodata[elm]));\r\n    props.mapRef.current.leafletElement.fitBounds([[b.minLat, b.minLng], [b.maxLat, b.maxLng]]);\r\n  }, [props.options.icaodata, props.mapRef, setRoute]);\r\n\r\n  // Scroll back to previous position when returning to results list\r\n  React.useEffect(() => {\r\n    if (focus === null && resultsDiv.current) {\r\n      resultsDiv.current.scrollTo(0, resultsScroll.current);\r\n    }\r\n  }, [focus]);\r\n\r\n  // Scroll to top when filtering / changing sortby of results\r\n  React.useEffect(() => {\r\n    if (resultsDiv.current) {\r\n      resultsDiv.current.scrollTo(0 ,0);\r\n      setNbDisplay(20);\r\n    }\r\n  }, [filteredResults]);\r\n\r\n  const prepResults = (allResults, options) => {\r\n    const approachSpeedRatio = 0.4;\r\n    for (var i = 0; i < allResults.length; i++) {\r\n      const totalDistance = allResults[i].distance + approachLength*(allResults[i].icaos.length-1);\r\n      const time = allResults[i].distance/speed + approachLength*(allResults[i].icaos.length-1)/(speed*approachSpeedRatio) + 0.09*(allResults[i].icaos.length-2);\r\n      const h = Math.floor(time);\r\n      const min = Math.round((time-h)*60);\r\n      let pay = allResults[i].pay;\r\n\r\n      // If rented airplane, find plane with minimum bonus, and deduce bonus from route pay\r\n      if (type === 'rent') {\r\n        let minBonus = 0;\r\n        let minPlane = null;\r\n        const startIcao = allResults[i].icaos[0];\r\n        const endIcao = allResults[i].icaos[allResults[i].icaos.length-1];\r\n        for (const plane of props.options.planes[startIcao]) {\r\n          const bonus = Math.round(\r\n            (\r\n                convertDistance(getDistance(props.options.icaodata[endIcao], options.icaodata[plane.home]), 'sm')\r\n              -\r\n                convertDistance(getDistance(props.options.icaodata[startIcao], options.icaodata[plane.home]), 'sm')\r\n            )\r\n            * plane.bonus / 100);\r\n          if (!minPlane || bonus < minBonus) {\r\n            minPlane = plane;\r\n            minBonus = bonus;\r\n          }\r\n        }\r\n        allResults[i].plane = minPlane;\r\n        allResults[i].b = -minBonus;\r\n        pay -= minBonus;\r\n      }\r\n      allResults[i].payNM = pay/totalDistance;\r\n      allResults[i].payLeg = pay/allResults[i].icaos.length;\r\n      allResults[i].payTime = pay/time;\r\n      allResults[i].time = h+'H'+(min > 9 ? min : \"0\"+min);\r\n      allResults[i].timeNb = time;\r\n      allResults[i].pay = Math.round(pay);\r\n      allResults[i].distance = Math.round(totalDistance);\r\n      allResults[i].id = i;\r\n    }\r\n    allResults.sort(sortFunctions[sortBy]);\r\n\r\n    results.current = allResults;\r\n    filterResults();\r\n    setLoading(false);\r\n    setCancel(null);\r\n  }\r\n\r\n  const startSearch = () => {\r\n    setProgress(0);\r\n    setLoading(true);\r\n    // Check ICAO if free mode\r\n    if (type === 'free') {\r\n      if (!props.options.icaodata[fromIcao]) {\r\n        alert('Invalid departing ICAO');\r\n        setLoading(false);\r\n        return false;\r\n      }\r\n      if (toIcao && !props.options.icaodata[toIcao]) {\r\n        alert('Invalid destination ICAO');\r\n        setLoading(false);\r\n        return false;\r\n      }\r\n    }\r\n    const jobs = {};\r\n    for (const [k, v] of Object.entries(props.options.jobs)) {\r\n      const [fr, to] = k.split('-');\r\n      if (hideAirport(fr, props.options.settings.airport) || hideAirport(to, props.options.settings.airport)) { continue; }\r\n      const obj = {\r\n        cargos: {\r\n          TripOnly: [],\r\n          VIP: []\r\n        },\r\n        distance: v.distance,\r\n        direction: v.direction\r\n      }\r\n      if (v.kg) {\r\n        if (v.kg['Trip-Only']) {\r\n          for (const c of v.kg['Trip-Only']) {\r\n            if (c.nb > maxKg) { continue; }\r\n            obj.cargos.TripOnly.push({pax: 0, kg: c.nb, pay: c.pay, from: fr, to: to});\r\n          }\r\n        }\r\n        if (v.kg['VIP']) {\r\n          for (const c of v.kg['VIP']) {\r\n            if (c.nb > maxKg) { continue; }\r\n            obj.cargos.VIP.push({pax: 0, kg: c.nb, pay: c.pay, from: fr, to: to});\r\n          }\r\n        }\r\n      }\r\n      if (v.passengers) {\r\n        if (v.passengers['Trip-Only']) {\r\n          for (const c of v.passengers['Trip-Only']) {\r\n            if (c.nb*77 > maxKg || c.nb > maxPax) { continue; }\r\n            obj.cargos.TripOnly.push({pax: c.nb, kg: c.nb*77, pay: c.pay, from: fr, to: to});\r\n          }\r\n        }\r\n        if (v.passengers['VIP']) {\r\n          for (const c of v.passengers['VIP']) {\r\n            if (c.nb*77 > maxKg || c.nb > maxPax) { continue; }\r\n            obj.cargos.VIP.push({pax: c.nb, kg: c.nb*77, pay: c.pay, from: fr, to: to});\r\n          }\r\n        }\r\n      }\r\n      if (obj.cargos.TripOnly || obj.cargos.VIP) {\r\n        if (!jobs[fr]) { jobs[fr] = new Map(); }\r\n        jobs[fr].set(to, obj);\r\n      }\r\n    }\r\n\r\n    const options = {\r\n      maxKg: maxKg,\r\n      maxPax: maxPax,\r\n      minPaxLoad: maxPax*minLoad/100,\r\n      minKgLoad: maxKg*minLoad/100,\r\n      maxStops: maxStops,\r\n      icaos: Object.keys(jobs),\r\n      icaodata: props.options.icaodata\r\n    }\r\n\r\n    if (type === \"rent\") {\r\n      const icaos = Object.keys(props.options.planes);\r\n      const totalIcaos = icaos.reduce((acc, elm) => acc + (jobs[elm] ? 1 : 0), 0);\r\n      const maxWorkers = navigator.hardwareConcurrency || 4;\r\n      const closeIcaosCache = {};\r\n      let done = 0;\r\n      let allResults = [];\r\n      const onmessage = ({data}, worker) => {\r\n        if (data.status === 'finished') {\r\n          allResults = allResults.concat(data.results);\r\n          const icao = icaos.pop();\r\n          if (icao) {\r\n            worker.postMessage({\r\n              fromIcao: icao,\r\n              toIcao: loop ? icao : null,\r\n              jobs: jobs,\r\n              options: options,\r\n              maxHops: maxHops,\r\n              maxBadLegs: maxBadLegs,\r\n              closeIcaosCache: closeIcaosCache\r\n            });\r\n          }\r\n          else {\r\n            worker.terminate();\r\n            done += 1;\r\n            if (done === maxWorkers) {\r\n              prepResults(allResults, options);\r\n            }\r\n          }\r\n        }\r\n        else if (data.status === 'progress') {\r\n          setProgress(prev => prev+(data.progress/totalIcaos));\r\n        }\r\n      };\r\n      const workers = [];\r\n      for (var i = 0; i < maxWorkers; i++) {\r\n        const worker = new RoutingWorker();\r\n        worker.onmessage = (evt) => onmessage(evt, worker);\r\n        let icao = icaos.pop();\r\n        if (!icao) { break; }\r\n        worker.postMessage({\r\n          fromIcao: icao,\r\n          toIcao: loop ? icao : null,\r\n          jobs: jobs,\r\n          options: options,\r\n          maxHops: maxHops,\r\n          maxBadLegs: maxBadLegs,\r\n          closeIcaosCache: closeIcaosCache\r\n        });\r\n        workers.push(worker);\r\n      }\r\n      setCancel(workers);\r\n    }\r\n    else {\r\n      const worker = new RoutingWorker();\r\n      worker.onmessage = ({data}) => {\r\n        if (data.status === 'finished') {\r\n          prepResults(data.results, options);\r\n          worker.terminate();\r\n        }\r\n        else if (data.status === 'progress') {\r\n          setProgress(prev => prev+data.progress);\r\n        }\r\n      }\r\n      worker.postMessage({\r\n        fromIcao: fromIcao,\r\n        toIcao: toIcao ? toIcao : null,\r\n        jobs: jobs,\r\n        options: options,\r\n        maxHops: maxHops,\r\n        maxBadLegs: maxBadLegs,\r\n        closeIcaosCache: {}\r\n      });\r\n      setCancel([worker]);\r\n    }\r\n\r\n  };\r\n\r\n  const cancelWorkers = () => {\r\n    for (const worker of cancel) {\r\n      worker.terminate();\r\n    }\r\n    setLoading(false);\r\n    setCancel(null);\r\n  }\r\n\r\n  if (props.hidden) { return null; }\r\n\r\n  return (\r\n    <div className={classes.routing}>\r\n      <Typography variant=\"h4\" className={classes.title}>\r\n        Route finder\r\n        <IconButton className={classes.closeButton} onClick={props.close}>\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </Typography>\r\n\r\n      {filteredResults ?\r\n\r\n        focus ?\r\n\r\n          <React.Fragment>\r\n            <div className={classes.back} onClick={() => setFocus(null)}>\r\n              <Typography variant=\"body1\" className={classes.backText}><ArrowBackIcon />&nbsp;Back to results</Typography>\r\n            </div>\r\n\r\n            <div className={classes.content}>\r\n              <Grid container spacing={1} className={classes.tlGrid}>\r\n                <Grid item xs={4}>\r\n                  <Typography variant=\"body1\" className={classes.tlGridText}><MonetizationOnIcon className={classes.icon} />{focus.pay}</Typography>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  <Typography variant=\"body1\" className={classes.tlGridText}><SettingsEthernetIcon className={classes.icon} />{focus.distance} NM</Typography>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  <Typography variant=\"body1\" className={classes.tlGridText}><TimerIcon className={classes.icon} />{focus.time}</Typography>\r\n                </Grid>\r\n              </Grid>\r\n              <Timeline align=\"right\">\r\n                {focus.icaos.map((icao, i) => {\r\n                  const onboard = i < focus.icaos.length-1 ? focus.cargos[i].TripOnly.reduce((acc, elm) => elm.from === icao ? acc : [...acc, elm], []) : [];\r\n                  return (\r\n                    <TimelineItem key={i}>\r\n                      <TimelineOppositeContent className={classes.tlOp}>\r\n                        { i === 0 && focus.plane &&\r\n                          <React.Fragment>\r\n                            <Typography variant=\"body2\">Rent {focus.plane.reg} (${focus.plane.dry}/${focus.plane.wet})</Typography>\r\n                            <Typography variant=\"body2\" paragraph>Flight total bonus : ${focus.b}</Typography>\r\n                          </React.Fragment>\r\n                        }\r\n                        {i < focus.icaos.length-1 && focus.cargos[i].TripOnly.length > 0 &&\r\n                          <Paper variant=\"outlined\" className={classes.tlPaper}>\r\n                            {focus.cargos[i].TripOnly.map((cargo, j) =>\r\n                            cargo.from === icao\r\n                              ? cargo.pax\r\n                                ? <Typography variant=\"body2\" key={j}>{cargo.pax} passenger{cargo.pax > 1 ? 's' : ''} to {cargo.to} (${cargo.pay})</Typography>\r\n                                : <Typography variant=\"body2\" key={j}>{cargo.kg}kg to {cargo.to} (${cargo.pay})</Typography>\r\n                              : null\r\n                            )}\r\n                            { onboard.length > 0 && <Typography variant=\"body2\"><i>{textTotalCargo(onboard, false)} already onboard</i></Typography> }\r\n                            <Typography variant=\"body2\" className={classes.tlTotal}><b>Total:</b> {textTotalCargo(focus.cargos[i].TripOnly)}</Typography>\r\n                          </Paper>\r\n                        }\r\n                        {i < focus.icaos.length-1 && focus.cargos[i].VIP.length > 0 &&\r\n                          <Paper variant=\"outlined\" className={classes.tlPaper}>\r\n                            {focus.cargos[i].VIP.map((cargo, j) =>\r\n                            cargo.pax ?\r\n                                <Typography variant=\"body2\" key={j}>{cargo.pax} VIP passenger{cargo.pax > 1 ? 's' : ''} to {cargo.to} (${cargo.pay})</Typography>\r\n                              :\r\n                                <Typography variant=\"body2\" key={j}>{cargo.kg}kg VIP to {cargo.to} (${cargo.pay})</Typography>\r\n                            )}\r\n                            <Typography variant=\"body2\" className={classes.tlTotal}><b>Total:</b> {textTotalCargo(focus.cargos[i].VIP)}</Typography>\r\n                          </Paper>\r\n                        }\r\n                      </TimelineOppositeContent>\r\n                      <TimelineSeparator>\r\n                        <TimelineDot\r\n                          color={\r\n                            (\r\n                                i < focus.icaos.length-1\r\n                              &&\r\n                                (\r\n                                    (\r\n                                        focus.cargos[i].TripOnly.length\r\n                                      &&\r\n                                        focus.cargos[i].TripOnly.reduce((acc, cargo) => acc && cargo.from !== icao, true)\r\n                                    )\r\n                                  ||\r\n                                    (\r\n                                        !focus.cargos[i].TripOnly.length\r\n                                      &&\r\n                                        !focus.cargos[i].VIP.length\r\n                                    )\r\n                                )\r\n                            ) ? 'grey' : 'primary'\r\n                          }\r\n                        />\r\n                        <TimelineConnector />\r\n                      </TimelineSeparator>\r\n                      <TimelineContent className={classes.tlCt}>\r\n                        <Link href=\"#\" onClick={evt => {evt.preventDefault(); props.actions.current.goTo(icao) }}>{icao}</Link>\r\n                      </TimelineContent>\r\n                    </TimelineItem>\r\n                  )\r\n                })}\r\n              </Timeline>\r\n            </div>\r\n          </React.Fragment>\r\n\r\n        :\r\n\r\n          <React.Fragment>\r\n            <div className={classes.topResults}>\r\n              <div\r\n                className={classes.backSearch}\r\n                onClick={() => {\r\n                  setFilteredResults(null);\r\n                  props.setRoute(null);\r\n                  results.current = null;\r\n                }}\r\n              >\r\n                <Typography variant=\"body2\" className={classes.backSearchText}><ArrowBackIcon /><br />New search</Typography>\r\n              </div>\r\n              <div className={classes.topResultsDiv}>\r\n                <Button\r\n                  variant=\"contained\"\r\n                  onClick={(evt) => setFilterMenu(evt.currentTarget)}\r\n                  startIcon={<FilterListIcon />}\r\n                >\r\n                  Filters\r\n                </Button>\r\n                <Popover\r\n                  anchorEl={filterMenu}\r\n                  keepMounted\r\n                  open={Boolean(filterMenu)}\r\n                  onClose={() => setFilterMenu(null)}\r\n                  classes={{paper: classes.filters}}\r\n                >\r\n                  <Typography variant=\"body1\">Route filters:</Typography>\r\n                  <Grid container spacing={1}>\r\n                    <Grid item xs={6}>\r\n                      <TextField\r\n                        label=\"Min distance\"\r\n                        variant=\"outlined\"\r\n                        value={minDist}\r\n                        onChange={(evt) => setMinDist(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        InputProps={{\r\n                          endAdornment: <InputAdornment position=\"end\">NM</InputAdornment>,\r\n                        }}\r\n                        InputLabelProps={{\r\n                          shrink: true,\r\n                        }}\r\n                        margin=\"dense\"\r\n                        className={classes.filtersInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <TextField\r\n                        label=\"Max distance\"\r\n                        variant=\"outlined\"\r\n                        value={maxDist}\r\n                        onChange={(evt) => setMaxDist(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        InputProps={{\r\n                          endAdornment: <InputAdornment position=\"end\">NM</InputAdornment>,\r\n                        }}\r\n                        InputLabelProps={{\r\n                          shrink: true,\r\n                        }}\r\n                        margin=\"dense\"\r\n                        className={classes.filtersInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <TextField\r\n                        label=\"Min duration\"\r\n                        variant=\"outlined\"\r\n                        value={minTime}\r\n                        placeholder=\"1:30\"\r\n                        onChange={(evt) => {\r\n                          const val = evt.target.value;\r\n                          if (val.match(/^[0-9:]*$/g)) {\r\n                            setMinTime(val);\r\n                          }\r\n                        }}\r\n                        InputLabelProps={{\r\n                          shrink: true,\r\n                        }}\r\n                        margin=\"dense\"\r\n                        className={classes.filtersInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <TextField\r\n                        label=\"Max duration\"\r\n                        variant=\"outlined\"\r\n                        value={maxTime}\r\n                        placeholder=\"6:30\"\r\n                        onChange={(evt) => {\r\n                          const val = evt.target.value;\r\n                          if (val.match(/^[0-9:]*$/g)) {\r\n                            setMaxTime(val);\r\n                          }\r\n                        }}\r\n                        InputLabelProps={{\r\n                          shrink: true,\r\n                        }}\r\n                        margin=\"dense\"\r\n                        className={classes.filtersInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <TextField\r\n                        label=\"Min pay\"\r\n                        variant=\"outlined\"\r\n                        value={minPay}\r\n                        onChange={(evt) => setMinPay(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        InputProps={{\r\n                          startAdornment: <InputAdornment position=\"start\">$</InputAdornment>,\r\n                        }}\r\n                        InputLabelProps={{\r\n                          shrink: true,\r\n                        }}\r\n                        margin=\"dense\"\r\n                        className={classes.filtersInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <TextField\r\n                        label=\"Max pay\"\r\n                        variant=\"outlined\"\r\n                        value={maxPay}\r\n                        onChange={(evt) => setMaxPay(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        InputProps={{\r\n                          startAdornment: <InputAdornment position=\"start\">$</InputAdornment>,\r\n                        }}\r\n                        InputLabelProps={{\r\n                          shrink: true,\r\n                        }}\r\n                        margin=\"dense\"\r\n                        className={classes.filtersInput}\r\n                      />\r\n                    </Grid>\r\n                  </Grid>\r\n                  <Button variant=\"contained\" color=\"primary\" onClick={filterResults} className={classes.filtersApply}>Apply</Button>\r\n                </Popover>\r\n              </div>\r\n              <div className={classes.topResultsDiv}>\r\n                <TextField\r\n                  value={sortBy}\r\n                  onChange={changeSortBy}\r\n                  label=\"Sort by\"\r\n                  variant=\"outlined\"\r\n                  size=\"small\"\r\n                  select\r\n                  className={classes.filterBtn}\r\n                  InputProps={{style:{fontSize:\"1em\"}}}\r\n                  InputLabelProps={{style:{fontSize:\"1em\"}}}\r\n                >\r\n                  <MenuItem value=\"payNM\">Pay per NM</MenuItem>\r\n                  <MenuItem value=\"payLeg\">Pay per leg</MenuItem>\r\n                  <MenuItem value=\"payTime\">Pay per flight time</MenuItem>\r\n                  <MenuItem value=\"pay\">Total pay</MenuItem>\r\n                  {type === \"rent\" && <MenuItem value=\"bonus\">Plane bonus</MenuItem>}\r\n                </TextField>\r\n              </div>\r\n            </div>\r\n            <div className={classes.nbResults}>\r\n              {\r\n                filteredResults.length > 0 ?\r\n                  <Typography variant=\"body2\">{filteredResults.length} routes found.</Typography>\r\n                :\r\n                  <Typography variant=\"body2\">No route found.</Typography>\r\n              }\r\n            </div>\r\n            <div\r\n              ref={resultsDiv}\r\n              className={classes.content}\r\n              onScroll={() => {\r\n                if (resultsDiv.current.scrollHeight - resultsDiv.current.scrollTop - resultsDiv.current.clientHeight < 400 && nbDisplay < filteredResults.length) {\r\n                  setNbDisplay(nbDisplay + 20);\r\n                }\r\n              }}\r\n            >\r\n              <Results\r\n                results={filteredResults}\r\n                classes={classes}\r\n                showDetail={showDetail}\r\n                goTo={props.actions.current.goTo}\r\n                setRoute={props.setRoute}\r\n                nbDisplay={nbDisplay}\r\n                sortBy={sortBy}\r\n              />\r\n            </div>\r\n          </React.Fragment>\r\n\r\n      :\r\n\r\n        <div className={classes.content+' '+classes.form}>\r\n          <Typography variant=\"body1\" className={classes.formLabel}>Maximum airplane capacity:</Typography>\r\n          <Grid container spacing={1}>\r\n            <Grid item xs={6}>\r\n              <TextField\r\n                label=\"Max passengers\"\r\n                placeholder=\"10\"\r\n                variant=\"outlined\"\r\n                required\r\n                value={maxPax}\r\n                onChange={(evt) => setMaxPax(evt.target.value.replace(/[^0-9]/g, ''))}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <TextField\r\n                label=\"Max weight\"\r\n                variant=\"outlined\"\r\n                placeholder=\"2000\"\r\n                required\r\n                InputProps={{\r\n                  endAdornment: <InputAdornment position=\"end\">Kg</InputAdornment>,\r\n                }}\r\n                value={maxKg}\r\n                onChange={(evt) => setMaxKg(evt.target.value.replace(/[^0-9]/g, ''))}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n\r\n\r\n          <ToggleButtonGroup\r\n            value={type}\r\n            exclusive\r\n            onChange={(evt, newType) => {\r\n              if (newType !== null) {\r\n                setType(newType);\r\n                if (newType !== 'rent' && sortBy === 'bonus') {\r\n                  setSortBy('payTime');\r\n                }\r\n              }\r\n            }}\r\n            className={classes.typeButtons}\r\n          >\r\n            <ToggleButton value=\"rent\">Rent a plane</ToggleButton>\r\n            <ToggleButton value=\"free\">Free search</ToggleButton>\r\n          </ToggleButtonGroup>\r\n\r\n          { type === \"rent\" ?\r\n            <FormControlLabel\r\n              control={<Switch checked={loop} onChange={(evt) => setLoop(evt.target.checked)} />}\r\n              label=\"Return plane to starting airport\"\r\n            />\r\n          :\r\n            <React.Fragment>\r\n              <Typography variant=\"body1\" className={classes.formLabel}>Restrict search to specific route:</Typography>\r\n              <Grid container spacing={1}>\r\n                <Grid item xs={6}>\r\n                  <TextField\r\n                    label=\"From\"\r\n                    placeholder=\"ICAO\"\r\n                    variant=\"outlined\"\r\n                    value={fromIcao}\r\n                    onChange={(evt) => setFromIcao(evt.target.value.toUpperCase())}\r\n                    required\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <TextField\r\n                    label=\"To\"\r\n                    variant=\"outlined\"\r\n                    placeholder=\"ICAO\"\r\n                    value={toIcao}\r\n                    onChange={(evt) => setToIcao(evt.target.value.toUpperCase())}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n            </React.Fragment>\r\n          }\r\n\r\n\r\n          {!moreSettings &&\r\n            <Typography variant=\"body1\" className={classes.pMore}>\r\n              <span className={classes.more} onClick={() => setMoreSettings(true)}>More options...</span>\r\n            </Typography>\r\n          }\r\n\r\n          {moreSettings &&\r\n            <div>\r\n              <div className={classes.moreSettings}>\r\n                <Typography variant=\"body1\" className={classes.formLabel}>Change default algorithm parameters:</Typography>\r\n                <Grid container spacing={1}>\r\n                  <Grid item xs={6}>\r\n                    <Tooltip title=\"Maximum algorithm iterations. The total route legs may be more than this, due to deadhead legs and on-route stops.\">\r\n                      <TextField\r\n                        label=\"Iterations\"\r\n                        placeholder=\"5\"\r\n                        variant=\"outlined\"\r\n                        value={maxHops}\r\n                        onChange={(evt) => setMaxHops(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        required\r\n                      />\r\n                    </Tooltip>\r\n                  </Grid>\r\n                  <Grid item xs={6}>\r\n                    <Tooltip title=\"Number of possible stops along a leg to drop passengers/cargo, in order to better fill the plane part of the leg.\">\r\n                      <TextField\r\n                        label=\"Max stops\"\r\n                        variant=\"outlined\"\r\n                        placeholder=\"1\"\r\n                        value={maxStops}\r\n                        onChange={(evt) => setMaxStops(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        required\r\n                      />\r\n                    </Tooltip>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid container spacing={1} style={{marginTop:12}}>\r\n                  <Grid item xs={6}>\r\n                    <Tooltip title=\"Try to always keep the plane at least this full.\">\r\n                      <TextField\r\n                        label=\"Min plane load\"\r\n                        placeholder=\"80\"\r\n                        variant=\"outlined\"\r\n                        value={minLoad}\r\n                        onChange={(evt) => setMinLoad(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        required\r\n                        InputProps={{\r\n                          endAdornment: <InputAdornment position=\"end\">%</InputAdornment>,\r\n                        }}\r\n                      />\r\n                    </Tooltip>\r\n                  </Grid>\r\n                  <Grid item xs={6}>\r\n                    <Tooltip title=\"Number of possible legs bellow the minimum plane load.\">\r\n                      <TextField\r\n                        label=\"Max bad legs\"\r\n                        variant=\"outlined\"\r\n                        placeholder=\"2\"\r\n                        value={maxBadLegs}\r\n                        onChange={(evt) => setMaxBadLegs(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        required\r\n                      />\r\n                    </Tooltip>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n\r\n              <div className={classes.moreSettings}>\r\n                <Typography variant=\"body1\" className={classes.formLabel}>Adjust airplane parameters:</Typography>\r\n                <Grid container spacing={1}>\r\n                  <Grid item xs={6}>\r\n                    <Tooltip title=\"Used to compute an estimated flight duration.\">\r\n                      <TextField\r\n                        label=\"Airplane speed\"\r\n                        placeholder=\"250\"\r\n                        variant=\"outlined\"\r\n                        value={speed}\r\n                        onChange={(evt) => setSpeed(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        required\r\n                        InputProps={{\r\n                          endAdornment: <InputAdornment position=\"end\">kts</InputAdornment>,\r\n                        }}\r\n                      />\r\n                    </Tooltip>\r\n                  </Grid>\r\n                  <Grid item xs={6}>\r\n                    <Tooltip title=\"Added to the leg straight distance, to account for approach circuits.\">\r\n                      <TextField\r\n                        label=\"Approach distance\"\r\n                        placeholder=\"10\"\r\n                        variant=\"outlined\"\r\n                        value={approachLength}\r\n                        onChange={(evt) => setApproachLength(evt.target.value.replace(/[^0-9]/g, ''))}\r\n                        required\r\n                        InputProps={{\r\n                          endAdornment: <InputAdornment position=\"end\">NM</InputAdornment>,\r\n                        }}\r\n                      />\r\n                    </Tooltip>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </div>\r\n          }\r\n\r\n          <div className={classes.pButtons}>\r\n            {!loading &&\r\n              <Button variant=\"contained\" color=\"primary\" size=\"large\" onClick={startSearch} disabled={!maxPax || !maxKg || !maxHops || !maxStops || !minLoad || !maxBadLegs || !speed || !approachLength || (type === \"free\" && !fromIcao)}>\r\n                Find best routes\r\n              </Button>\r\n            }\r\n            {loading && <LinearProgress variant=\"determinate\" value={progress} className={classes.progressBar} />}\r\n            {cancel !== null &&\r\n              <Button color=\"secondary\" onClick={cancelWorkers}>\r\n                Cancel\r\n              </Button>\r\n            }\r\n          </div>\r\n        </div>\r\n      }\r\n    </div>\r\n  );\r\n\r\n});\r\n\r\nexport default Routing;","import { Component } from \"react\";\r\nimport { withLeaflet } from \"react-leaflet\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet-path-transform\";\r\n\r\nclass RectangleTransform extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.map = props.leaflet.map;\r\n    this.obj = null;\r\n  }\r\n  componentDidMount() {\r\n    this.obj = L.rectangle(this.props.bounds, {transform: true, draggable: true }).addTo(this.map);\r\n\r\n    this.obj.transform.enable({rotation: false, scaling: true, uniformScaling: false});\r\n    this.obj.dragging.enable();\r\n\r\n    if (this.props.onUpdate) {\r\n      this.obj.on('transformed', () => this.props.onUpdate(this.obj.getBounds()));\r\n    }\r\n    \r\n  }\r\n  componentWillUnmount() {\r\n    if (this.obj) {\r\n      this.obj.remove();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default withLeaflet(RectangleTransform);","import React from 'react';\r\nimport { Map, TileLayer, } from \"react-leaflet\";\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Button from '@material-ui/core/Button';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport L from \"leaflet\";\r\n\r\nimport RectangleTransform from \"./RectangleTransform.js\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  closeButton: {\r\n    position: 'absolute',\r\n    right: theme.spacing(1),\r\n    top: theme.spacing(1),\r\n    color: theme.palette.grey[500],\r\n  },\r\n  popup: {\r\n    height: '90vh'\r\n  },\r\n  popupContent: {\r\n    display: 'flex'\r\n  }\r\n}));\r\nconst boundsOptions = {animate:false};\r\n\r\nfunction CustomAreaPopup(props) {\r\n\r\n  const startBounds = props.bounds || L.latLngBounds([[51.310, 8.496], [42.200, -5.065]]);\r\n\r\n  const handleClose = () => {\r\n    setBounds(startBounds);\r\n    props.handleClose();\r\n  }\r\n\r\n  const classes = useStyles();\r\n  const [bounds, setBounds] = React.useState(() => startBounds);\r\n\r\n  const maxBounds=[[-90, props.settings.display.map.center-180], [90, props.settings.display.map.center+180]];\r\n\r\n  const mapRef = React.useCallback(node => {\r\n    if (node !== null) {\r\n      node.leafletElement.setMinZoom(node.leafletElement.getBoundsZoom(maxBounds, true));\r\n    }\r\n  }, [maxBounds]);\r\n\r\n  return (\r\n\r\n    <Dialog onClose={handleClose} open={props.open} fullWidth={true} maxWidth=\"lg\" classes={{paper: classes.popup}}>\r\n      <DialogTitle>\r\n        Select custom area\r\n        <IconButton className={classes.closeButton} onClick={handleClose}>\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </DialogTitle>\r\n      <DialogContent className={classes.popupContent}>\r\n        <Map ref={mapRef} bounds={startBounds} boundsOptions={boundsOptions} maxBounds={maxBounds} minZoom={2}>\r\n          <TileLayer\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n          <RectangleTransform bounds={bounds} onUpdate={(bounds) => setBounds(bounds)} />\r\n        </Map>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={handleClose} color=\"primary\">\r\n          Cancel\r\n        </Button>\r\n        <Button onClick={() => {props.setArea(bounds); props.handleClose();}} color=\"primary\" variant=\"contained\">\r\n          Add selected area\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default CustomAreaPopup;","class Storage {\r\n\r\n  constructor() {\r\n    const version = process.env.REACT_APP_VERSION;\r\n    const oldVersion = localStorage.getItem('version');\r\n    // Update older version of storage\r\n    if (version !== oldVersion) {\r\n      if (!oldVersion || oldVersion < '1.0.0') {\r\n        const planeModel = this.get('planeModel', '');\r\n        if (planeModel) {\r\n          this.set('planeModel', [planeModel]);\r\n        }\r\n        this.remove('planes');\r\n        this.remove('jobs');\r\n      }\r\n      if (oldVersion < '1.1.0') {\r\n        this.remove('settings');\r\n      }\r\n      localStorage.setItem('version', version);\r\n    }\r\n  }\r\n\r\n  get(item, defaultValue = null) {\r\n    let value = localStorage.getItem(item);\r\n    if (value === null) { return defaultValue; }\r\n    if (typeof defaultValue === 'object' && defaultValue !== null) {\r\n      return JSON.parse(value);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  set(item, value) {\r\n    try {\r\n      localStorage.setItem(item, typeof value === 'object' ? JSON.stringify(value) : value);\r\n      return true;\r\n    }\r\n    catch(error) {\r\n      alert('Unable to save data for later usage: local storage is full.');\r\n      return false;\r\n    }\r\n  }\r\n\r\n  remove(item) {\r\n    localStorage.removeItem(item)\r\n  }\r\n\r\n}\r\n\r\nexport default Storage;","import React from 'react';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Button from '@material-ui/core/Button';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Link from '@material-ui/core/Link';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Autocomplete, { createFilterOptions } from '@material-ui/lab/Autocomplete';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport AspectRatioIcon from '@material-ui/icons/AspectRatio';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { readString } from 'react-papaparse';\r\nimport { isPointInPolygon } from \"geolib\";\r\nimport L from \"leaflet\";\r\nimport { getDistance, getRhumbLineBearing, convertDistance } from \"geolib\";\r\n\r\nimport CustomAreaPopup from './Components/CustomArea.js';\r\nimport Storage from '../Storage.js';\r\n\r\nimport aircrafts from \"../data/aircraft.json\";\r\n\r\nconst storage = new Storage();\r\n\r\n\r\n// Generate country list\r\nfunction getAreas(icaodata, icaos) {\r\n  let a = new Set();\r\n  for (var i = icaos.length - 1; i >= 0; i--) {\r\n    const country = icaodata[icaos[i]].country;\r\n    if (country === 'United States') {\r\n      a.add('US - '+icaodata[icaos[i]].state)\r\n    }\r\n    a.add(country);\r\n  }\r\n  return [\"Custom area\", ...[...a].sort()];\r\n}\r\n\r\n// Get the list of all airports within the selected countries and custom area\r\nfunction getIcaoList(countries, bounds, icaodata, icaos) {\r\n  let points = null;\r\n  // If custom area, compute polygon points\r\n  if (countries.includes('Custom area')) {\r\n    const [n, e, s, w] = [bounds.getNorth(), bounds.getEast(), bounds.getSouth(), bounds.getWest()];\r\n    points = [\r\n      { latitude: n, longitude: w },\r\n      { latitude: n, longitude: e },\r\n      { latitude: s, longitude: e },\r\n      { latitude: s, longitude: w }\r\n    ];\r\n  }\r\n  let i = [];\r\n  for (const icao of icaos) {\r\n    // If custom area, check if icao is inside the polygon\r\n    if (points && isPointInPolygon({ latitude: icaodata[icao].lat, longitude: icaodata[icao].lon}, points)) {\r\n      i.push(icao);\r\n    }\r\n    else {\r\n      // For the United States, we can use states instead\r\n      if (icaodata[icao].country === 'United States' && countries.includes('US - '+icaodata[icao].state)) {\r\n        i.push(icao);\r\n      }\r\n      else if (countries.includes(icaodata[icao].country)) {\r\n        i.push(icao);\r\n      }\r\n    }\r\n  }\r\n  let reminder = i.join('-');\r\n  // Split list into chunks smaller than about 8000 chars\r\n  const list = [];\r\n  while (true) {\r\n    let start = reminder.slice(0, 8000);\r\n    reminder = reminder.slice(8000);\r\n    const index = reminder.indexOf('-');\r\n    if (index === -1) {\r\n      list.push(start+reminder);\r\n      break;\r\n    }\r\n    list.push(start+reminder.slice(0, index));\r\n    reminder = reminder.slice(index+1);\r\n  }\r\n  return list;\r\n}\r\n\r\n\r\nfunction cleanPlanes(list) {\r\n  const planes = {};\r\n  for (const obj of list) {\r\n    // Exclude broken airplanes\r\n    if (obj.NeedsRepair === 1) { continue; }\r\n    // Ensure plane can be rented\r\n    if (obj.Location === 'In Flight') { continue; }\r\n    if (obj.RentedBy !== 'Not rented.') { continue; }\r\n    if (!obj.RentalDry && !obj.RentalWet) { continue; }\r\n    if (obj.FeeOwed) { continue; }\r\n\r\n    // Ensure location exist in planes object\r\n    if (!planes.hasOwnProperty(obj.MakeModel)) { planes[obj.MakeModel] = {}; }\r\n    if (!planes[obj.MakeModel].hasOwnProperty(obj.Location)) { planes[obj.MakeModel][obj.Location] = []; }\r\n\r\n    planes[obj.MakeModel][obj.Location].push({\r\n      id: obj.SerialNumber,\r\n      reg: obj.Registration,\r\n      home: obj.Home,\r\n      wet: obj.RentalWet,\r\n      dry: obj.RentalDry,\r\n      bonus: obj.Bonus\r\n    });\r\n  }\r\n  return planes;\r\n}\r\n\r\nfunction cleanJobs(list, icaodata) {\r\n  const jobs = {};\r\n  for (const job of list) {\r\n    // Do not keep non paying jobs\r\n    if (!job.Pay) { continue; }\r\n\r\n    const key = job.Location+\"-\"+job.ToIcao;\r\n\r\n    // Ensure leg exist in jobs object\r\n    if (!jobs.hasOwnProperty(key)) {\r\n      const fr = { latitude: icaodata[job.Location].lat, longitude: icaodata[job.Location].lon };\r\n      const to = { latitude: icaodata[job.ToIcao].lat, longitude: icaodata[job.ToIcao].lon };\r\n      jobs[key] = {\r\n        direction: Math.round(getRhumbLineBearing(fr, to)),\r\n        distance: Math.round(convertDistance(getDistance(fr, to), 'sm'))\r\n      };\r\n    }\r\n    if (!jobs[key].hasOwnProperty(job.UnitType)) {\r\n      jobs[key][job.UnitType] = {};\r\n    }\r\n    if (!jobs[key][job.UnitType][job.Type]) {\r\n      jobs[key][job.UnitType][job.Type] = [];\r\n    }\r\n\r\n    jobs[key][job.UnitType][job.Type].push({\r\n      nb: job.Amount,\r\n      pay: job.Pay\r\n    });\r\n  }\r\n  return jobs;\r\n}\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  closeButton: {\r\n    position: 'absolute',\r\n    right: theme.spacing(1),\r\n    top: theme.spacing(1),\r\n    color: theme.palette.grey[500],\r\n  },\r\n  alert: {\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  buttonProgress: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -12,\r\n    marginLeft: -12,\r\n  },\r\n  span: {\r\n    display: 'flex',\r\n    fontWeight: 'bold'\r\n  },\r\n  divider: {\r\n    margin: theme.spacing(3) + 'px 0'\r\n  },\r\n  dialog: {\r\n    padding: theme.spacing(3)\r\n  },\r\n  accSummary: {\r\n    alignItems: 'center'\r\n  },\r\n  accDetails: {\r\n    flexDirection: 'column'\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  }\r\n}));\r\n\r\nconst filter = createFilterOptions();\r\n\r\n\r\nfunction UpdatePopup(props) {\r\n\r\n  const [key, setKey] = React.useState(storage.get('key', ''));\r\n  const [jobsAreas, setJobsAreas] = React.useState(storage.get('jobsAreas', []));\r\n  const [jobsCustom, setJobsCustom] = React.useState(() => {\r\n    const b = storage.get('jobsCustom', {});\r\n    if (b && b._southWest) { return L.latLngBounds(b._southWest, b._northEast); }\r\n    return null;\r\n  });\r\n  const [jobsTime, setJobsTime] = React.useState(storage.get('jobsTime'));\r\n  const [jobsRequests, setJobsRequests] = React.useState(() => getIcaoList(jobsAreas, jobsCustom, props.icaodata, props.icaos).length);\r\n  const [planeModel, setPlaneModel] = React.useState(storage.get('planeModel', []));\r\n  const [planesTime, setPlanesTime] = React.useState(storage.get('planesTime'));\r\n  const [planesRequests, setPlanesRequests] = React.useState(planeModel.length);\r\n  const [flightTime, setFlightTime] = React.useState(storage.get('flightTime'));\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [openCustom, setOpenCustom] = React.useState(false);\r\n  const [expanded, setExpanded] = React.useState(key ? false : 'panel1');\r\n  const [customIcaosVal, setCustomIcaosVal] = React.useState(props.customIcaos.join(' '));\r\n  const classes = useStyles();\r\n\r\n  const areas = React.useState(() => getAreas(props.icaodata, props.icaos))[0];\r\n\r\n  // Close popup\r\n  const handleClose = () => {\r\n    props.setUpdatePopup(false);\r\n  }\r\n\r\n  // Open popup on loading if no FSE key\r\n  const setUpdatePopupRef = React.useRef(props.setUpdatePopup);\r\n  React.useEffect(() => {\r\n    if (!storage.get('key')) {\r\n      setUpdatePopupRef.current(true);\r\n    }\r\n  }, []);\r\n\r\n  // Update Custom markers input\r\n  React.useEffect(() => {\r\n    setCustomIcaosVal(props.customIcaos.join(' '));\r\n  }, [props.customIcaos]);\r\n\r\n  // Loop function to get jobs from FSE\r\n  const updateJobsRequest = (icaosList, jobs, callback) => {\r\n    if (!icaosList.length) {\r\n      callback(jobs);\r\n      return;\r\n    }\r\n    const url = 'data?userkey='+key+'&format=csv&query=icao&search=jobsfrom&icaos='+icaosList.pop();\r\n    // Fetch job list\r\n    fetch(process.env.REACT_APP_PROXY+url)\r\n    .then(function(response) {\r\n      if (!response.ok) {\r\n        throw new Error(\"Network error\");\r\n      }\r\n      return response.text();\r\n    })\r\n    .then(function(csv) {\r\n      // Parse CSV\r\n      const parse = readString(csv, {header: true, skipEmptyLines: 'greedy', dynamicTyping: true});\r\n      if (parse.errors.length > 0) {\r\n        throw new Error(\"Parsing error\");\r\n      }\r\n      updateJobsRequest(icaosList, [...jobs, ...parse.data], callback);\r\n    })\r\n    .catch(function(error) {\r\n      console.log(error);\r\n      alert('Could not get data. Check your read access key and ensure you have not reached your quota limit.');\r\n      setLoading(false);\r\n    });\r\n  }\r\n  // Jobs Update button clicked\r\n  const updateJobs = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    // Compute ICAO list\r\n    const icaosList = getIcaoList(jobsAreas, jobsCustom, props.icaodata, props.icaos);\r\n    updateJobsRequest(icaosList, [], (list) => {\r\n      const jobs = cleanJobs(list, props.icaodata);\r\n      // Update jobs\r\n      storage.set('jobs', jobs);\r\n      props.setJobs(jobs);\r\n      // Update date\r\n      let date = new Date().toString();\r\n      storage.set('jobsTime', date);\r\n      setJobsTime(date);\r\n      // Update area\r\n      storage.set('jobsAreas', jobsAreas);\r\n      storage.set('jobsCustom', jobsCustom);\r\n      // Close popup\r\n      setLoading(false);\r\n      handleClose();\r\n    });\r\n  }\r\n  // Jobs Clicked button clicked\r\n  const clearJobs = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    // Update planes\r\n    props.setJobs({});\r\n    storage.remove('jobs');\r\n    storage.remove('jobsTime');\r\n    setJobsTime(null);\r\n    // Close popup\r\n    setLoading(false);\r\n    handleClose();\r\n  }\r\n\r\n  // Loop function to get planes from FSE\r\n  const updatePlanesRequest = (models, planes, callback) => {\r\n    if (!models.length) {\r\n      callback(planes);\r\n      return;\r\n    }\r\n    const url = 'data?userkey='+key+'&format=csv&query=aircraft&search=makemodel&makemodel='+encodeURI(models.pop());\r\n    // Fetch plane list\r\n    fetch(process.env.REACT_APP_PROXY+url)\r\n    .then(function(response) {\r\n      if (!response.ok) {\r\n        throw new Error(\"Network error\");\r\n      }\r\n      return response.text();\r\n    })\r\n    .then(function(csv) {\r\n      // Parse CSV\r\n      const parse = readString(csv, {header: true, skipEmptyLines: 'greedy', dynamicTyping: true});\r\n      if (parse.errors.length > 0) {\r\n        throw new Error(\"Parsing error\");\r\n      }\r\n      // Convert array to object\r\n      updatePlanesRequest(models, [...planes, ...parse.data], callback);\r\n    })\r\n    .catch(function(error) {\r\n      console.log(error);\r\n      alert('Could not get data. Check your read access key and ensure you have not reached your quota limit.');\r\n      setLoading(false);\r\n    });\r\n  }\r\n  // Planes Update button clicked\r\n  const updatePlanes = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    updatePlanesRequest(planeModel.slice(), [], (list) => {\r\n      // Transform to object\r\n      const planes = cleanPlanes(list);\r\n      // Update planes\r\n      storage.set('planes', planes);\r\n      props.setPlanes(planes);\r\n      // Update date\r\n      let date = new Date().toString();\r\n      storage.set('planesTime', date);\r\n      setPlanesTime(date);\r\n      // Update model\r\n      storage.set('planeModel', planeModel);\r\n      // Close popup\r\n      setLoading(false);\r\n      handleClose();\r\n    });\r\n  }\r\n  // Planes Clear button clicked\r\n  const clearPlanes = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    // Update planes\r\n    props.setPlanes({});\r\n    storage.remove('planes');\r\n    storage.remove('planesTime');\r\n    setPlanesTime(null);\r\n    // Close popup\r\n    setLoading(false);\r\n    handleClose();\r\n  }\r\n\r\n  // My Flight Update button clicked\r\n  const updateFlight = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    // Build URL\r\n    const url = 'data?userkey='+key+'&format=csv&query=assignments&search=key&readaccesskey='+key\r\n    // Fetch job list\r\n    fetch(process.env.REACT_APP_PROXY+url)\r\n    .then(function(response) {\r\n      if (!response.ok) {\r\n        throw new Error(\"Network error\");\r\n      }\r\n      return response.text();\r\n    })\r\n    .then(function(csv) {\r\n      // Parse CSV\r\n      const parse = readString(csv, {header: true, skipEmptyLines: 'greedy', dynamicTyping: true});\r\n      if (parse.errors.length > 0) {\r\n        throw new Error(\"Parsing error\");\r\n      }\r\n      // Convert array to object\r\n      let jobs = parse.data.reduce((obj, item) => {\r\n        obj[item.Id] = item;\r\n        return obj;\r\n      }, {});\r\n      // Update flight\r\n      storage.set('flight', jobs);\r\n      props.setFlight(jobs);\r\n      // Update date\r\n      let date = new Date().toString();\r\n      storage.set('flightTime', date);\r\n      setFlightTime(date);\r\n      // Close popup\r\n      setLoading(false);\r\n      handleClose();\r\n    })\r\n    .catch(function(error) {\r\n      alert('Could not get data. Check your read access key.');\r\n      setLoading(false);\r\n    });\r\n  }\r\n  // My Flight Clear button clicked\r\n  const clearFlight = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    // Update planes\r\n    props.setFlight({});\r\n    storage.remove('flight');\r\n    storage.remove('flightTime');\r\n    setFlightTime(null);\r\n    // Close popup\r\n    setLoading(false);\r\n    handleClose();\r\n  }\r\n\r\n  // Custom markers button clicked\r\n  const updateCustom = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    const elms = customIcaosVal.split(/[ ,\\n]+/);\r\n    const icaos = [];\r\n    // Keep only existing ICAO\r\n    for (const elm of elms) {\r\n      if (props.icaodata[elm]) {\r\n        icaos.push(elm);\r\n      }\r\n    }\r\n    // Update var and storage\r\n    setCustomIcaosVal(icaos.join(' '));\r\n    props.setCustomIcaos(icaos);\r\n    // Do not update storage, it is done in App.js\r\n    // Close popup\r\n    setLoading(false);\r\n    handleClose();\r\n  }\r\n  const clearCustom = (evt) => {\r\n    evt.stopPropagation();\r\n    setLoading(true);\r\n    setCustomIcaosVal('');\r\n    props.setCustomIcaos([]);\r\n    storage.remove('customIcaos');\r\n    setLoading(false);\r\n  }\r\n\r\n  const panelChange = (panel) => (event, isExpanded) => {\r\n    setExpanded(isExpanded ? panel : false);\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={props.open} fullWidth={true} maxWidth=\"sm\">\r\n      <DialogTitle>\r\n        Load data from FSE\r\n        <IconButton className={classes.closeButton} onClick={handleClose}>\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </DialogTitle>\r\n      <DialogContent dividers className={classes.dialog}>\r\n\r\n        <Alert severity=\"warning\" className={classes.alert}>You are limited to 40 requests every 6 hours (~1 request every 10 minutes).</Alert>\r\n\r\n        <Accordion expanded={expanded === 'panel1'} onChange={panelChange('panel1')} data-tour=\"Step4\">\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <Typography>FSE read access key</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails className={classes.accDetails}>\r\n            <TextField\r\n              label=\"Read Access Key\"\r\n              type=\"text\"\r\n              onChange={(evt) => {\r\n                let k = evt.target.value;\r\n                setKey(k);\r\n                storage.set('key', k);\r\n              }}\r\n              value={key}\r\n              helperText={<span>Can be found <Link href=\"https://server.fseconomy.net/datafeeds.jsp\" target=\"_blank\">here</Link></span>}\r\n              variant='outlined'\r\n              fullWidth\r\n            />\r\n          </AccordionDetails>\r\n        </Accordion>\r\n\r\n        <Accordion expanded={expanded === 'panel2'} onChange={panelChange('panel2')} data-tour=\"Step5\">\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />} classes={{content: classes.accSummary}}>\r\n            <Typography className={classes.title}>Jobs</Typography>\r\n            <Button color=\"secondary\" onClick={clearJobs}>\r\n              Clear\r\n            </Button>\r\n            &nbsp;\r\n            <Tooltip title={<span>Last update : {jobsTime ? ((new Date(jobsTime)).toLocaleString()) : \"never\"}</span>}>\r\n              <span>\r\n                <Button variant=\"contained\" color=\"primary\" onClick={updateJobs} disabled={loading || !key || !jobsAreas.length || jobsRequests > 10}>\r\n                  Update\r\n                  {loading && <CircularProgress size={24} className={classes.buttonProgress} />}\r\n                </Button>\r\n              </span>\r\n            </Tooltip>\r\n          </AccordionSummary>\r\n          <AccordionDetails className={classes.accDetails}>\r\n            <Autocomplete\r\n              multiple\r\n              limitTags={2}\r\n              options={areas}\r\n              renderInput={(params) => (\r\n                jobsRequests > 1 ?\r\n                  <TextField {...params} label='Included countries' variant='outlined' error helperText={'Selected area is very large, it will require '+jobsRequests+' requests (10 max)'} />\r\n                :\r\n                  <TextField {...params} label='Included countries' variant='outlined' />\r\n              )}\r\n              onChange={(evt, value) => {\r\n                if (value.includes('Custom area') && !jobsAreas.includes('Custom area')) {\r\n                  setOpenCustom(true);\r\n                }\r\n                else {\r\n                  setJobsAreas(value);\r\n                  setJobsRequests(getIcaoList(value, jobsCustom, props.icaodata, props.icaos).length)  \r\n                }\r\n              }}\r\n              value={jobsAreas}\r\n              filterOptions={(options, params) => {\r\n                const filtered = filter(options, params);\r\n                if (!filtered.includes('Custom area')) {\r\n                  filtered.unshift('Custom area');\r\n                }\r\n                return filtered;\r\n              }}\r\n              selectOnFocus\r\n              clearOnBlur\r\n              handleHomeEndKeys\r\n              renderOption={option => (option === 'Custom area') ? <span className={classes.span}><AspectRatioIcon />&nbsp;Select custom area on map</span> : option}\r\n            />\r\n            <CustomAreaPopup\r\n              open={openCustom}\r\n              handleClose={() => setOpenCustom(false)}\r\n              setArea={(bounds) => {\r\n                const a = [...jobsAreas, 'Custom area'];\r\n                setJobsCustom(bounds);\r\n                setJobsAreas(a);\r\n                setJobsRequests(getIcaoList(a, bounds, props.icaodata, props.icaos).length);\r\n              }}\r\n              bounds={jobsCustom}\r\n              settings={props.settings}\r\n            />\r\n          </AccordionDetails>\r\n        </Accordion>\r\n\r\n        <Accordion expanded={expanded === 'panel3'} onChange={panelChange('panel3')} data-tour=\"Step6\">\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />} classes={{content: classes.accSummary}}>\r\n            <Typography className={classes.title}>Rentable planes</Typography>\r\n            <Button color=\"secondary\" onClick={clearPlanes}>\r\n              Clear\r\n            </Button>\r\n            &nbsp;\r\n            <Tooltip title={<span>Last update : {planesTime ? ((new Date(planesTime)).toLocaleString()) : \"never\"}</span>}>\r\n              <span>\r\n                <Button variant=\"contained\" color=\"primary\" onClick={updatePlanes} disabled={loading || !key || !planeModel.length || planesRequests > 10}>\r\n                  Update\r\n                  {loading && <CircularProgress size={24} className={classes.buttonProgress} />}\r\n                </Button>\r\n              </span>\r\n            </Tooltip>\r\n          </AccordionSummary>\r\n          <AccordionDetails className={classes.accDetails}>\r\n            <Autocomplete\r\n              multiple\r\n              limitTags={2}\r\n              options={Object.keys(aircrafts)}\r\n              renderInput={(params) => (\r\n                planesRequests > 1 ?\r\n                  <TextField {...params} label='Aircraft model' variant='outlined' error helperText={planesRequests+' models selected, it will require '+planesRequests+' requests (10 max)'} />\r\n                :\r\n                  <TextField {...params} label='Aircraft model' variant='outlined' />\r\n              )}\r\n              onChange={(evt, value) => {\r\n                setPlaneModel(value);\r\n                setPlanesRequests(value.length);\r\n              }}\r\n              value={planeModel}\r\n            />\r\n          </AccordionDetails>\r\n        </Accordion>\r\n\r\n        <Accordion expanded={expanded === 'panel4'} onChange={panelChange('panel4')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />} classes={{content: classes.accSummary}}>\r\n            <Typography className={classes.title}>My flight</Typography>\r\n            <Button color=\"secondary\" onClick={clearFlight}>\r\n              Clear\r\n            </Button>\r\n            &nbsp;\r\n            <Tooltip title={<span>Last update : {flightTime ? ((new Date(flightTime)).toLocaleString()) : \"never\"}</span>}>\r\n              <span>\r\n                <Button variant=\"contained\" color=\"primary\" onClick={updateFlight} disabled={loading || !key}>\r\n                  Update\r\n                  {loading && <CircularProgress size={24} className={classes.buttonProgress} />}\r\n                </Button>\r\n              </span>\r\n            </Tooltip>\r\n          </AccordionSummary>\r\n        </Accordion>\r\n\r\n        <Accordion expanded={expanded === 'panel5'} onChange={panelChange('panel5')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />} classes={{content: classes.accSummary}}>\r\n            <Typography className={classes.title}>Custom markers</Typography>\r\n            <Button color=\"secondary\" onClick={clearCustom}>\r\n              Clear\r\n            </Button>\r\n            &nbsp;\r\n            <span>\r\n              <Button variant=\"contained\" color=\"primary\" onClick={updateCustom} disabled={loading}>\r\n                Update\r\n                {loading && <CircularProgress size={24} className={classes.buttonProgress} />}\r\n              </Button>\r\n            </span>\r\n          </AccordionSummary>\r\n          <AccordionDetails className={classes.accDetails}>\r\n            <TextField\r\n              label=\"List of FSE ICAOs\"\r\n              multiline\r\n              rows={4}\r\n              variant=\"outlined\"\r\n              placeholder=\"LFLY EGLL LFPO [...]\"\r\n              helperText=\"ICAOs can be seperated by a white space, a new line or a coma.\"\r\n              value={customIcaosVal}\r\n              onChange={(evt) => {\r\n                setCustomIcaosVal(evt.target.value);\r\n              }}\r\n            />\r\n          </AccordionDetails>\r\n        </Accordion>\r\n\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default UpdatePopup;","import React from 'react';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Button from '@material-ui/core/Button';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport FlightTakeoffIcon from '@material-ui/icons/FlightTakeoff';\r\nimport FlightLandIcon from '@material-ui/icons/FlightLand';\r\nimport ExploreIcon from '@material-ui/icons/Explore';\r\nimport MonetizationOnIcon from '@material-ui/icons/MonetizationOn';\r\nimport BusinessIcon from '@material-ui/icons/Business';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport {default as _set} from 'lodash/set';\r\nimport {default as _clone} from 'lodash/cloneDeep';\r\n\r\nimport Storage from '../Storage.js';\r\n\r\nconst storage = new Storage();\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  closeButton: {\r\n    position: 'absolute',\r\n    right: theme.spacing(1),\r\n    top: theme.spacing(1),\r\n    color: theme.palette.grey[500],\r\n  },\r\n  dialog: {\r\n    padding: theme.spacing(3)\r\n  }\r\n}));\r\n\r\n\r\nfunction Setting({xs, setting, s, setS, ...props}) {\r\n  return (\r\n    <Grid item xs={xs || 6}>\r\n      <TextField\r\n        {...props}\r\n        variant=\"outlined\"\r\n        fullWidth\r\n        size=\"small\"\r\n        value={setting.split('.').reduce((a, b) => a[b], s)}\r\n        onChange={(evt) => {\r\n          const obj = Object.assign({}, s);\r\n          _set(obj, setting, evt.target.value)\r\n          setS(obj);\r\n        }}\r\n      />\r\n    </Grid>\r\n  );\r\n}\r\nfunction SettingSlider({xs, setting, s, setS, label, ...props}) {\r\n  return (\r\n    <Grid item xs={xs || 6}>\r\n      <Typography variant=\"body2\">{label}:</Typography>\r\n      <Slider\r\n        defaultValue={0}\r\n        min={-180}\r\n        max={180}\r\n        step={10}\r\n        marks={[{value: 0, label: 'Europe/Africa'}, {value: 100, label: 'Asia/Oceania'}, {value: -100, label: 'America'}]}\r\n        track={false}\r\n        value={parseInt(setting.split('.').reduce((a, b) => a[b], s))}\r\n        valueLabelDisplay=\"auto\"\r\n        onChange={(evt, value) => {\r\n          const obj = Object.assign({}, s);\r\n          _set(obj, setting, value)\r\n          setS(obj);\r\n        }}\r\n      />\r\n    </Grid>\r\n  );\r\n}\r\nfunction SettingSwitch({xs, setting, s, setS, label, ...props}) {\r\n  return (\r\n    <Grid item xs={xs || 6}>\r\n      <FormControlLabel\r\n        control={\r\n          <Switch\r\n            checked={setting.split('.').reduce((a, b) => a[b], s) === true}\r\n            onChange={(evt, value) => {\r\n              const obj = Object.assign({}, s);\r\n              _set(obj, setting, value)\r\n              setS(obj);\r\n            }}\r\n            color=\"primary\"\r\n          />\r\n        }\r\n        label={label}\r\n      />\r\n    </Grid>\r\n  );\r\n}\r\nfunction SettingSlider2({xs, setting, s, setS, label, ...props}) {\r\n  const val = setting.split('.').reduce((a, b) => a[b], s);\r\n  const computeVal = val => val > 3500 ? 3500+(val-3500)/10 : val;\r\n  const inverseVal = val => val > 3500 ? 3500+(val-3500)*10 : val;\r\n  return (\r\n    <Grid item xs={xs || 6}>\r\n      <Typography variant=\"body2\">{label}:</Typography>\r\n      <Slider\r\n        min={0}\r\n        max={5500}\r\n        value={[computeVal(val[0]), computeVal(val[1])]}\r\n        valueLabelFormat={inverseVal}\r\n        valueLabelDisplay=\"auto\"\r\n        onChange={(evt, value) => {\r\n          const obj = Object.assign({}, s);\r\n          _set(obj, setting, [inverseVal(value[0]), inverseVal(value[1])])\r\n          setS(obj);\r\n        }}\r\n        marks={[{value: 0, label: '1 lot'}, {value: 1000, label: '2 lots'}, {value: 3500, label: '3 lots'}]}\r\n      />\r\n    </Grid>\r\n  );\r\n}\r\nfunction SettingSlider3({xs, setting, s, setS, label, ...props}) {\r\n  const val = setting.split('.').reduce((a, b) => a[b], s);\r\n  const computeVal = val => val > 15000 ? 15000 : val;\r\n  const inverseVal = val => val === 15000 ? 30000 : val;\r\n  return (\r\n    <Grid item xs={xs || 6}>\r\n      <Typography variant=\"body2\">{label}:</Typography>\r\n      <Slider\r\n        min={0}\r\n        max={15000}\r\n        value={[computeVal(val[0]), computeVal(val[1])]}\r\n        valueLabelFormat={inverseVal}\r\n        valueLabelDisplay=\"auto\"\r\n        onChange={(evt, value) => {\r\n          const obj = Object.assign({}, s);\r\n          _set(obj, setting, [inverseVal(value[0]), inverseVal(value[1])])\r\n          setS(obj);\r\n        }}\r\n        marks={[{value: 5000, label: '5000 feet'}, {value: 10000, label: '10000 feet'}, {value: 15000, label: 'no limit'}]}\r\n      />\r\n    </Grid>\r\n  );\r\n}\r\nfunction SettingSelect({xs, setting, s, setS, ...props}) {\r\n  return (\r\n    <Grid item xs={xs || 6}>\r\n      <TextField\r\n        {...props}\r\n        variant=\"outlined\"\r\n        fullWidth\r\n        size=\"small\"\r\n        value={setting.split('.').reduce((a, b) => a[b], s)}\r\n        select\r\n        SelectProps={{multiple: true}}\r\n        onChange={(evt) => {\r\n          const obj = Object.assign({}, s);\r\n          _set(obj, setting, evt.target.value)\r\n          setS(obj);\r\n        }}\r\n      >\r\n        <MenuItem value={1}>Asphalt</MenuItem>\r\n        <MenuItem value={2}>Concrete</MenuItem>\r\n        <MenuItem value={3}>Coral</MenuItem>\r\n        <MenuItem value={4}>Dirt</MenuItem>\r\n        <MenuItem value={5}>Grass</MenuItem>\r\n        <MenuItem value={6}>Gravel</MenuItem>\r\n        <MenuItem value={7}>Helipad</MenuItem>\r\n        <MenuItem value={8}>Oil Treated</MenuItem>\r\n        <MenuItem value={9}>Snow</MenuItem>\r\n        <MenuItem value={10}>Steel Mats</MenuItem>\r\n        <MenuItem value={11}>Water</MenuItem>\r\n      </TextField>\r\n    </Grid>\r\n  );}\r\n\r\n\r\nfunction SettingsPopup(props) {\r\n\r\n  const [expanded, setExpanded] = React.useState(false);\r\n  const handleChange = (panel) => (event, isExpanded) => {\r\n    setExpanded(isExpanded ? panel : false);\r\n  };\r\n  const [s, setS] = React.useState(() => _clone(props.settings));\r\n  const classes = useStyles();\r\n\r\n  const handleClose = () => {\r\n    // Cancel change\r\n    setS(_clone(props.settings));\r\n    setExpanded(false);\r\n    // Close popup\r\n    props.handleClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={props.open} fullWidth={true} maxWidth=\"md\">\r\n      <DialogTitle>\r\n        Settings\r\n        <IconButton className={classes.closeButton} onClick={handleClose}>\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </DialogTitle>\r\n      <DialogContent dividers className={classes.dialog}>\r\n        <Accordion expanded={expanded === 'panel1'} onChange={handleChange('panel1')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <Typography>Display settings</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            <Grid container spacing={3}>\r\n              <Setting s={s} setS={setS} label=\"Standard airport color\" setting='display.markers.colors.base' />\r\n              <Setting s={s} setS={setS} label=\"Standard airport size\" setting='display.markers.sizes.base' />\r\n              <Setting s={s} setS={setS} label=\"Airport with rentable plane color\" setting='display.markers.colors.rentable' />\r\n              <Setting s={s} setS={setS} label=\"Airport with rentable plane size\" setting='display.markers.sizes.rentable' />\r\n              <Setting s={s} setS={setS} label=\"Highlighted airport color\" setting='display.markers.colors.selected' />\r\n              <Setting s={s} setS={setS} label=\"Highlighted airport size\" setting='display.markers.sizes.selected' />\r\n              <Setting s={s} setS={setS} label=\"FSE airport color\" setting='display.markers.colors.fse' />\r\n              <Setting s={s} setS={setS} label=\"FSE airport size\" setting='display.markers.sizes.fse' />\r\n              <Setting s={s} setS={setS} label=\"MSFS airport color\" setting='display.markers.colors.msfs' />\r\n              <Setting s={s} setS={setS} label=\"MSFS airport size\" setting='display.markers.sizes.msfs' />\r\n              <Setting s={s} setS={setS} label=\"Custom marker airport color\" setting='display.markers.colors.custom' />\r\n              <Setting s={s} setS={setS} label=\"Custom marker airport size\" setting='display.markers.sizes.custom' />\r\n              <Setting s={s} setS={setS} label=\"Passenger leg color\" setting='display.legs.colors.passengers' xs={4} />\r\n              <Setting s={s} setS={setS} label=\"Cargo leg color\" setting='display.legs.colors.cargo' xs={4} />\r\n              <Setting s={s} setS={setS} label=\"My Flight leg color\" setting='display.legs.colors.flight' xs={4} />\r\n              <Setting s={s} setS={setS} label=\"Max passenger leg weight\" setting='display.legs.weights.passengers' helperText=\"Leave empty to disable adaptative weight\" xs={4} />\r\n              <Setting s={s} setS={setS} label=\"Max cargo leg weight\" setting='display.legs.weights.cargo' helperText=\"Leave empty to disable adaptative weight\" xs={4} />\r\n              <Setting s={s} setS={setS} label=\"My Flight leg weight\" setting='display.legs.weights.flight' xs={4} />\r\n              <Setting s={s} setS={setS} label=\"Highlighted leg color\" setting='display.legs.colors.highlight' />\r\n              <Setting s={s} setS={setS} label=\"Min leg weight\" setting='display.legs.weights.base' helperText=\"Also used when adaptative weight is disabled\" />\r\n              <SettingSlider s={s} setS={setS} label=\"Map center\" setting='display.map.center' xs={12} />\r\n              <SettingSwitch s={s} setS={setS} label=\"Join Custom markers with a line to form a route\" setting=\"display.legs.display.custom\" xs={12} />\r\n            </Grid>\r\n          </AccordionDetails>\r\n        </Accordion>\r\n        <Accordion expanded={expanded === 'panel2'} onChange={handleChange('panel2')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <FlightTakeoffIcon />&nbsp;<Typography>From ICAO settings</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            <Grid container spacing={3}>\r\n              <Grid item container xs={9}>\r\n                <Typography variant=\"body2\">You may use up to 3 different constraints. Leave the input empty to disable a constraint.</Typography>\r\n                <Setting s={s} setS={setS} label=\"Max d\" setting='from.maxDist' xs={12} placeholder=\"20NM\" />\r\n                <Setting s={s} setS={setS} label=\"Min D/d\" setting='from.distCoef' xs={12} placeholder=\"1.5\" />\r\n                <Setting s={s} setS={setS} label=\"Max \" setting='from.angle' xs={12} placeholder=\"30\" />\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                <img src=\"settings/helpFrom.png\" alt=\"Schema\" />\r\n              </Grid>\r\n            </Grid>\r\n          </AccordionDetails>\r\n        </Accordion>\r\n        <Accordion expanded={expanded === 'panel3'} onChange={handleChange('panel3')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <FlightLandIcon />&nbsp;<Typography>To ICAO settings</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            <Grid container spacing={3}>\r\n              <Grid item container xs={9}>\r\n                <Typography variant=\"body2\">You may use up to 3 different constraints. Leave the input empty to disable a constraint.</Typography>\r\n                <Setting s={s} setS={setS} label=\"Max d\" setting='to.maxDist' xs={12} placeholder=\"20NM\" />\r\n                <Setting s={s} setS={setS} label=\"Min D/d\" setting='to.distCoef' xs={12} placeholder=\"1.5\" />\r\n                <Setting s={s} setS={setS} label=\"Max \" setting='to.angle' xs={12} placeholder=\"30\" />\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                <img src=\"settings/helpTo.png\" alt=\"Schema\" />\r\n              </Grid>\r\n            </Grid>\r\n          </AccordionDetails>\r\n        </Accordion>\r\n        <Accordion expanded={expanded === 'panel4'} onChange={handleChange('panel4')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <ExploreIcon />&nbsp;<Typography>Direction settings</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            <Grid container spacing={3}>\r\n              <Setting s={s} setS={setS} label=\"Maximum tolerance angle\" setting='direction.angle' />\r\n            </Grid>\r\n          </AccordionDetails>\r\n        </Accordion>\r\n        <Accordion expanded={expanded === 'panel5'} onChange={handleChange('panel5')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <MonetizationOnIcon />&nbsp;<Typography>Pay settings</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            <Grid container spacing={3}>\r\n              <Setting s={s} setS={setS} label=\"Minimum job pay (in $)\" setting='pay.min_job' xs={4} />\r\n              <Setting s={s} setS={setS} label=\"Minimum leg pay (in $)\" setting='pay.min_leg' xs={4} />\r\n              <Setting s={s} setS={setS} label=\"Top paying jobs (in percent)\" setting='pay.top' xs={4} />\r\n            </Grid>\r\n          </AccordionDetails>\r\n        </Accordion>\r\n        <Accordion expanded={expanded === 'panel6'} onChange={handleChange('panel6')}>\r\n          <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n            <BusinessIcon />&nbsp;<Typography>Airport filtering</Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            <Grid container spacing={3}>\r\n              <SettingSlider2 s={s} setS={(s) => {s.airport = _clone(s.airport); setS(s)}} label=\"Airport size (combined length of all runways in meters)\" setting='airport.size' xs={12} />\r\n              <SettingSlider3 s={s} setS={(s) => {s.airport = _clone(s.airport); setS(s)}} label=\"Airport longest runway (in feet)\" setting=\"airport.runway\" xs={12} />\r\n              <SettingSelect s={s} setS={(s) => {s.airport = _clone(s.airport); setS(s)}} label=\"Airport runway surface\" setting=\"airport.surface\" xs={12} />\r\n              <SettingSwitch s={s} setS={(s) => {s.airport = _clone(s.airport); setS(s)}} label=\"Only display and use MSFS compatible airports\" setting=\"airport.onlyMSFS\" xs={12} />\r\n            </Grid>\r\n          </AccordionDetails>\r\n        </Accordion>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button\r\n          onClick={handleClose}\r\n          color=\"primary\"\r\n        >\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          onClick={() => {\r\n            if (window.confirm('Are you sure you want to reset all settings to default settings?')) {\r\n              // Propagate change\r\n              props.setSettings(props.defaultSettings);\r\n              setS(props.defaultSettings);\r\n              // Save settings to local storage\r\n              storage.set('settings', props.defaultSettings);\r\n              // Close popup\r\n              setExpanded(false);\r\n              props.handleClose();\r\n            }\r\n          }}\r\n          color=\"secondary\"\r\n        >\r\n          Reset settings\r\n        </Button>\r\n        <Button\r\n          onClick={() => {\r\n            // Propagate change\r\n            props.setSettings(s);\r\n            // Save settings to local storage\r\n            storage.set('settings', s);\r\n            // Close popup\r\n            setExpanded(false);\r\n            props.handleClose();\r\n          }}\r\n          color=\"primary\"\r\n          variant=\"contained\"\r\n        >\r\n          Save settings\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default SettingsPopup;","import React from 'react';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Link from '@material-ui/core/Link';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  closeButton: {\r\n    position: 'absolute',\r\n    right: theme.spacing(1),\r\n    top: theme.spacing(1),\r\n    color: theme.palette.grey[500],\r\n  },\r\n  popup: {\r\n    height: '100vh'\r\n  },\r\n  dialog: {\r\n    paddingLeft: theme.spacing(3),\r\n    paddingRight: theme.spacing(3),\r\n    paddingTop: 0\r\n  },\r\n  content: {\r\n    marginTop: theme.spacing(4),\r\n    marginBottom: theme.spacing(4),\r\n    padding: theme.spacing(2)\r\n  },\r\n  version: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n}));\r\n\r\n\r\nfunction IssueLink({id}) {\r\n  return <Link href={\"https://github.com/piero-la-lune/FSE-Planner/issues/\"+id} target=\"_blank\">#{id}</Link>\r\n}\r\n\r\n\r\nfunction CreditsPopup(props) {\r\n\r\n  const [expanded, setExpanded] = React.useState(0);\r\n  const handleChange = (panel, newValue) => {\r\n    if (newValue === 2) {\r\n      handleClose();\r\n      props.openTutorial();\r\n    }\r\n    else {\r\n      setExpanded(newValue);\r\n    }\r\n  };\r\n  const classes = useStyles();\r\n\r\n  const handleClose = () => {\r\n    setExpanded(0);\r\n    // Close popup\r\n    props.handleClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={props.open} fullWidth={true} maxWidth=\"md\" classes={{paper: classes.popup}}>\r\n      <DialogTitle>\r\n        <Tabs\r\n          value={expanded}\r\n          onChange={handleChange}\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          centered\r\n        >\r\n          <Tab label=\"Changelog\" />\r\n          <Tab label=\"Credits\" />\r\n          <Tab label=\"Tutorial\" />\r\n        </Tabs>\r\n        <IconButton className={classes.closeButton} onClick={handleClose}>\r\n          <CloseIcon />\r\n        </IconButton>\r\n      </DialogTitle>\r\n      <DialogContent dividers className={classes.dialog}>\r\n        <div hidden={expanded !== 0}>\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v1.3.1 (2021-01-07)</Typography>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>Wrong passenger count in Route Finder (<IssueLink id={31} />)</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v1.3.0 (2021-01-05)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>New airport surface and airport runway length filter (<IssueLink id={20} />)</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>Airport popup now show runway length and surface</ListItem>\r\n              <ListItem>Airplane model list updated to include the new CJ4 and 2 other new models (<IssueLink id={19} />)</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>Wrong latitude and longitude in context menu (<IssueLink id={25} />)</ListItem>\r\n              <ListItem>Missing MN24 airport (<IssueLink id={14} />)</ListItem>\r\n              <ListItem>Wrong passenger weight in Route Finder (<IssueLink id={21} />)</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v1.2.0 (2020-12-11)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>New map overlay with unbuilt lots (updated daily)</ListItem>\r\n              <ListItem>Airport filter settings: only show/consider aiports in MSFS or in the given size range (also works with Route Finder)</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>Display sort by value in Route Finder results</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>Planes showing as rentable but cannot be rented</ListItem>\r\n              <ListItem>Tutorial skip button issue</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v1.1.1 (2020-12-07)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>Cancel button in Route Finder</ListItem>\r\n              <ListItem>ICAOs in leg tooltips</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>MSFS airports updated</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>Overlapping buttons in airport popups</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v1.1.0 (2020-12-01)</Typography>\r\n            <Alert style={{margin:20}} severity=\"warning\">User settings have been reset</Alert>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>Route Finder: find the best paying multi-hop multi-assignment routes</ListItem>\r\n              <ListItem>Huge performance improvement when displaying lot of objects on map</ListItem>\r\n              <ListItem>Right click context menu on map, with various actions (open in FSE, set FROM or TO filter, etc.)</ListItem>\r\n              <ListItem>Display custom markers on map (right click on airport to add/remove, or bulk management in the Data popup)</ListItem>\r\n              <ListItem>Rentable planes: link to the FSE plane page</ListItem>\r\n              <ListItem>Rentable planes: link to pan the map to a plane homeNew map layer with all FSE airports</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>Default settings for FROM and TO filters</ListItem>\r\n              <ListItem>Include searched ICAO in URL</ListItem>\r\n              <ListItem>Default colors</ListItem>\r\n              <ListItem>Variable airport icon size and path weight, depending on map zoom</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>Broken tooltips in airports popups</ListItem>\r\n              <ListItem>Alternative airport list display, when list was exceeding one line (#6)</ListItem>\r\n              <ListItem>Broken zoom on search result (#7)</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v1.0.0 (2020-11-06)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>New map layer with all FSE airports</ListItem>\r\n              <ListItem>New map layer with all MSFS airports</ListItem>\r\n              <ListItem>New map layer with all FSE airport landing areas</ListItem>\r\n              <ListItem>Show/hide layers on map</ListItem>\r\n              <ListItem>Tutorial for first time users</ListItem>\r\n              <ListItem>FSE airport popup now indicates if the airport exists in MSFS, if the ICAO is different, and other potential MSFS landing spots within the FSE airport landing area</ListItem>\r\n              <ListItem>No more restriction on the size of the zone for loading jobs from FSE</ListItem>\r\n              <ListItem>You can now select multiple plane models when loading rentable planes from FSE</ListItem>\r\n              <ListItem>New changelog and credits popup (changelog opens automatically when a new version is released)</ListItem>\r\n              <ListItem>3 different airport icons depending on airport size</ListItem>\r\n              <ListItem>New pay filter : minimum job pay, minimum leg pay, and top X% job pay per NM</ListItem>\r\n              <ListItem>Loading screen and app icon</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>Load Data popup now opens automatically for first time users</ListItem>\r\n              <ListItem>Airports popup remodeled</ListItem>\r\n              <ListItem>Improved performance</ListItem>\r\n              <ListItem>Better proxy for FSE requests</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>Search history is now correctly ordered</ListItem>\r\n              <ListItem>Leg tooltips now show correct information when only My Flight is displayed on map</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v0.5.0 (2020-10-20)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>Auto center/zoom map to jobs on loading</ListItem>\r\n              <ListItem>New setting to change map middle</ListItem>\r\n              <ListItem>Show My Flight (FSE selected jobs) on map</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>Update popup improved</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>From/To ICAO bug with max angle</ListItem>\r\n              <ListItem>Naval airport icon</ListItem>\r\n              <ListItem>Map issue at around longitude -180</ListItem>\r\n              <ListItem>Typo</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v0.4.1 (2020-10-17)</Typography>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List>\r\n              <ListItem>\"From ICAO\" and \"To ICAO\" filters now work as expected for jobs departing/arriving from/to the selected airport when a maximum angle is set</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v0.4.0 (2020-10-17)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>Highlight leg on mouse over</ListItem>\r\n              <ListItem>Search airport by ICAO or name, and display its location on map</ListItem>\r\n              <ListItem>Search history is saved between sessions, and shown in drop-down list</ListItem>\r\n              <ListItem>Display home information for rentable planes (arrow + details in tooltip)</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Changed</Typography>\r\n            <List dense>\r\n              <ListItem>Both way legs are now merged into one line on map</ListItem>\r\n              <ListItem>Better design for map tooltips and popups</ListItem>\r\n            </List>\r\n            <Typography variant=\"h6\">Fixed</Typography>\r\n            <List dense>\r\n              <ListItem>App header now adapt to window width</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v0.3.0 (2020-10-14)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>Display settings</ListItem>\r\n              <ListItem>Advanced \"From ICAO\", \"To ICAO\" and \"Distance\" settings</ListItem>\r\n              <ListItem>Settings are kept between sessions</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v0.2.0 (2020-10-12)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>You can now select an area on a map to load jobs from, instead of selecting countries</ListItem>\r\n              <ListItem>You get an error if the selected job area is too large</ListItem>\r\n              <ListItem>\"From ICAO\" and \"To ICAO\" airports now appear with a green icon on the map</ListItem>\r\n              <ListItem>New distance filter : set minimum and/or maximum job distance</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>v0.1.0 (2020-10-11)</Typography>\r\n            <Typography variant=\"h6\">Added</Typography>\r\n            <List dense>\r\n              <ListItem>Show available jobs on map</ListItem>\r\n              <ListItem>Show rentable plane on map</ListItem>\r\n              <ListItem>Choose countries to load jobs from</ListItem>\r\n              <ListItem>Choose airplane model to load rentable planes</ListItem>\r\n              <ListItem>Filters are available to filter out unwanted jobs on map</ListItem>\r\n            </List>\r\n          </Paper>\r\n        </div>\r\n        <div hidden={expanded !== 1}>\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>Contributors</Typography>\r\n            <List dense>\r\n              <ListItem>piero-la-lune (author)</ListItem>\r\n            </List>\r\n          </Paper>\r\n\r\n          <Paper className={classes.content}>\r\n            <Typography variant=\"h5\" className={classes.version}>Map</Typography>\r\n            <List dense>\r\n              <ListItem><Link href=\"https://leafletjs.com/\">Leaflet</Link></ListItem>\r\n              <ListItem>&copy;&nbsp;<Link href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</Link>&nbsp;contributors</ListItem>\r\n            </List>\r\n          </Paper>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default CreditsPopup;","import React from 'react';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Button from '@material-ui/core/Button';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport ReactTour from 'reactour';\r\n\r\nimport Storage from './Storage.js';\r\n\r\nconst storage = new Storage();\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  title: {\r\n    marginBottom: theme.spacing(2),\r\n    paddingRight: theme.spacing(2)\r\n  },\r\n  buttons: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  button: {\r\n    marginRight: theme.spacing(2)\r\n  },\r\n  p: {\r\n    marginBottom: theme.spacing(2)\r\n  }\r\n}));\r\n\r\nfunction TourStep(props) {\r\n\r\n  const classes = useStyles();\r\n\r\n  const handleNext = () => {\r\n    if (props.onNext) {\r\n      props.onNext();\r\n    }\r\n    props.goTo(props.step);\r\n  };\r\n  const handlePrev = () => {\r\n    if (props.onPrev) {\r\n      props.onPrev();\r\n    }\r\n    props.goTo(props.step-2)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {props.title && <Typography variant=\"h6\" className={classes.title}>{props.title}</Typography>}\r\n      {typeof props.text === 'string' ?\r\n        <Typography variant=\"body2\">{props.text}</Typography>\r\n      :\r\n        <React.Fragment>\r\n          {props.text.map((text, id) => <Typography key={id} variant=\"body2\" className={classes.p}>{text}</Typography>)}\r\n        </React.Fragment>\r\n      }\r\n      <div className={classes.buttons}>\r\n        {props.step > 1 && <Button color=\"secondary\" onClick={handlePrev} disableFocusRipple={true} className={classes.button}>Back</Button>}\r\n        {props.skip && <Button color=\"secondary\" onClick={props.skip} disableFocusRipple={true} className={classes.button}>Skip tutorial</Button>}\r\n        {props.end ? \r\n          <Button color=\"primary\" variant=\"contained\" onClick={props.end} disableFocusRipple={true} className={classes.button}>Done</Button>\r\n        :\r\n          <Button color=\"primary\" variant=\"contained\" onClick={handleNext} disableFocusRipple={true} className={classes.button}>Next</Button>\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\nfunction Tour({ setUpdatePopup, updatePopup, isTourOpen, setIsTourOpen }) {\r\n\r\n  const isUpdatePopupOpen = React.useRef(false);\r\n  const wasUpdatePopupOpen = React.useRef(false);\r\n  const wasTourOpen = React.useRef(false);\r\n  React.useEffect(() => {\r\n    isUpdatePopupOpen.current = updatePopup;\r\n  }, [updatePopup]);\r\n  React.useEffect(() => {\r\n    if (isTourOpen) {\r\n      wasUpdatePopupOpen.current = isUpdatePopupOpen.current;\r\n      wasTourOpen.current = true;\r\n      setUpdatePopup(false);\r\n    }\r\n    else if (wasTourOpen.current) {\r\n      setUpdatePopup(wasUpdatePopupOpen.current);\r\n    }\r\n  }, [isTourOpen, setUpdatePopup]);\r\n\r\n  const steps =[\r\n    {\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={1}\r\n          title=\"Welcome aboard FSE Planner!\"\r\n          text=\"This quick tour will show you the main features of this application.\"\r\n          goTo={goTo}\r\n          skip={() => goTo(10)}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step2\"]',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={2}\r\n          title=\"Step 1: Loading jobs\"\r\n          text=\"First, you have to load jobs from FSE. Click here to open the data update popup.\"\r\n          goTo={goTo}\r\n          onNext={() => setUpdatePopup(true)}\r\n        />\r\n    },\r\n    {\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={3}\r\n          text=\"This popup allows you to load and update different type of data from FSE.\"\r\n          goTo={goTo}\r\n          onPrev={() => setUpdatePopup(false)}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step4\"]',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={4}\r\n          text=\"You have to first enter your FSE Read Access Key.\"\r\n          goTo={goTo}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step5\"]',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={5}\r\n          text=\"You can now select an area to load jobs from. Click on Update to start the loading process.\"\r\n          goTo={goTo}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step6\"]',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={6}\r\n          text=\"You can also display airports where a plane is available for rental.\"\r\n          goTo={goTo}\r\n          onNext={() => setUpdatePopup(false)}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step7\"]',\r\n      content: ({goTo}) => \r\n        <TourStep\r\n          step={7}\r\n          title=\"Step 2: Filtering jobs\"\r\n          text={[\r\n            \"Jobs are now loaded and displayed on the map, but it is often a mess since there are so many jobs available. Use the filters in the top bar to reduce the number of jobs displayed on the map.\",\r\n            \"For instance, this filter allows you to show only jobs radiating from this airport.\"\r\n          ]}\r\n          goTo={goTo}\r\n          onPrev={() => setUpdatePopup(true)}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step8\"]',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={8}\r\n          text=\"More filtering and display options are available here.\"\r\n          goTo={goTo}\r\n        />\r\n    },\r\n    {\r\n      selector: '.leaflet-control-layers',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={9}\r\n          title=\"Map layers\"\r\n          text=\"You can display more usefull layers on the map, such as MSFS airports or FSE airports landing areas.\"\r\n          goTo={goTo}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step8b\"]',\r\n      content: ({goTo}) => \r\n        <TourStep\r\n          step={10}\r\n          title=\"Route finding\"\r\n          text={[\r\n            \"Click here to open the Route Finder.\",\r\n            \"The Route Finder will allow you to find the best paying multi-hop multi-assignment routes.\"\r\n          ]}\r\n          goTo={goTo}\r\n        />\r\n    },\r\n    {\r\n      selector: '[data-tour=\"Step9\"]',\r\n      content: ({goTo}) =>\r\n        <TourStep\r\n          step={11}\r\n          title=\"Your turn!\"\r\n          text=\"You can launch again this tutorial or review the changelog and credits here.\"\r\n          goTo={goTo}\r\n          end={() => {\r\n            goTo(0);\r\n            setIsTourOpen(false);\r\n            storage.set('tutorial', process.env.REACT_APP_VERSION);\r\n          }}\r\n        />\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <ReactTour\r\n      steps={steps}\r\n      isOpen={isTourOpen}\r\n      onRequestClose={() => setIsTourOpen(false)}\r\n      showNavigation={false}\r\n      disableInteraction={true}\r\n      showButtons={false}\r\n      closeWithMask={false}\r\n      showCloseButton={false}\r\n    />\r\n\r\n  );       \r\n\r\n\r\n}\r\n\r\n\r\n\r\nexport default Tour;","import React from 'react';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Button from '@material-ui/core/Button';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Autocomplete, { createFilterOptions } from '@material-ui/lab/Autocomplete';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Popper from '@material-ui/core/Popper';\r\nimport ToggleButton from '@material-ui/lab/ToggleButton';\r\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport EmojiPeopleIcon from '@material-ui/icons/EmojiPeople';\r\nimport FlightIcon from '@material-ui/icons/Flight';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport BusinessCenterIcon from '@material-ui/icons/BusinessCenter';\r\nimport FlightTakeoffIcon from '@material-ui/icons/FlightTakeoff';\r\nimport FlightLandIcon from '@material-ui/icons/FlightLand';\r\nimport ExploreIcon from '@material-ui/icons/Explore';\r\nimport UpdateIcon from '@material-ui/icons/Update';\r\nimport SettingsEthernetIcon from '@material-ui/icons/SettingsEthernet';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport TuneIcon from '@material-ui/icons/Tune';\r\nimport DirectionsIcon from '@material-ui/icons/Directions';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { default as _clone } from 'lodash/cloneDeep';\r\nimport { default as _defaultsDeep } from 'lodash/defaultsDeep';\r\n\r\nimport FSEMap from './Map.js';\r\nimport Routing from './Routing.js';\r\nimport UpdatePopup from './Popups/Update.js';\r\nimport SettingsPopup from './Popups/Settings.js';\r\nimport CreditsPopup from './Popups/Credits.js';\r\nimport Tour from './Tour.js';\r\nimport Storage from './Storage.js';\r\n\r\nimport icaodataSrc from \"./data/icaodata-with-zones.json\";\r\nconst icaodataSrcArr = Object.values(icaodataSrc);\r\n\r\n\r\nconst defaultSettings = {\r\n  display: {\r\n    markers: {\r\n      colors: {\r\n        base: 'black',\r\n        rentable: 'red',\r\n        selected: 'darkred',\r\n        fse: 'black',\r\n        msfs: 'darkslateblue',\r\n        custom: 'darkcyan'\r\n      },\r\n      sizes: {\r\n        base: '13',\r\n        rentable: '20',\r\n        selected: '25',\r\n        fse: '3',\r\n        msfs: '3',\r\n        custom: '20'\r\n      }\r\n    },\r\n    legs: {\r\n      colors: {\r\n        passengers: '#3f51b5',\r\n        cargo: '#3f51b5',\r\n        highlight: 'yellow',\r\n        flight: 'darkred'\r\n      },\r\n      weights: {\r\n        base: '1.2',\r\n        passengers: '8',\r\n        cargo: '8',\r\n        flight: '5'\r\n      },\r\n      display: {\r\n        custom: true\r\n      }\r\n    },\r\n    map: {\r\n      center: 0\r\n    },\r\n    sim: 'msfs'\r\n  },\r\n  from: {\r\n    distCoef: '',\r\n    angle: '30',\r\n    maxDist: ''\r\n  },\r\n  to: {\r\n    distCoef: '',\r\n    angle: '30',\r\n    maxDist: ''\r\n  },\r\n  direction: {\r\n    angle: '30'\r\n  },\r\n  pay: {\r\n    min_job: '',\r\n    min_leg: '',\r\n    top: '',\r\n  },\r\n  airport: {\r\n    size: [0, 23500],\r\n    surface: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],\r\n    runway: [0, 30000],\r\n    onlyMSFS: false\r\n  }\r\n};\r\n\r\nconst icaos = Object.keys(icaodataSrc);\r\n\r\n\r\nconst filter = createFilterOptions({limit: 5});\r\nconst PopperMy = function (props) {\r\n  return (<Popper {...props} style={{ width: 400 }} placement='bottom-start' />)\r\n}\r\n\r\nfunction wrap(num, center) {\r\n  if (num < center-180) { return 360; }\r\n  if (num >= center+180) { return -360; }\r\n  return 0;\r\n}\r\nfunction wrapZone(zone, pointLon, wrap, center) {\r\n  for (var i = 0; i < zone.length; i++) {\r\n    zone[i][1] += wrap;\r\n  }\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  tgBtn: {\r\n    color: \"rgba(255, 255, 255, 0.5)\",\r\n    borderColor: \"rgba(255, 255, 255, 0.5)\"\r\n  },\r\n  tgBtnSelected: {\r\n    color: \"rgba(255, 255, 255, 1) !important\"\r\n  },\r\n  box: {\r\n    marginLeft: theme.spacing(2),\r\n    marginTop: theme.spacing(1)/2,\r\n    marginBottom: theme.spacing(1)/2,\r\n  },\r\n  input: {\r\n    backgroundColor: \"rgba(255, 255, 255, 0.2)\",\r\n    color: \"#fff\",\r\n    borderRadius: theme.shape.borderRadius,\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1),\r\n    width: \"60px\"\r\n  },\r\n  inputNb: {\r\n    backgroundColor: \"rgba(255, 255, 255, 0.2)\",\r\n    color: \"#fff\",\r\n    borderRadius: theme.shape.borderRadius,\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1),\r\n    width: \"50px\"\r\n  },\r\n  inputSearch: {\r\n    backgroundColor: \"rgba(0, 0, 0, 0.2)\",\r\n    color: \"#fff\",\r\n    borderRadius: theme.shape.borderRadius,\r\n    paddingLeft: theme.spacing(1),\r\n    paddingTop: theme.spacing(1),\r\n    paddingBottom: theme.spacing(1),\r\n    width: \"120px\"\r\n  },\r\n  boxBorder: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    border: '1px solid',\r\n    borderColor: \"rgba(255, 255, 255, 0.5)\",\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1),\r\n    paddingTop: '7px',\r\n    paddingBottom: '7px',\r\n    marginLeft: theme.spacing(2),\r\n    marginTop: theme.spacing(1)/2,\r\n    marginBottom: theme.spacing(1)/2,\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  icon: {\r\n    color: \"rgba(255, 255, 255, 0.5)\",\r\n    \"&:hover\": {\r\n      color: \"#fff\"\r\n    },\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  popover: {\r\n    padding: theme.spacing(2),\r\n    marginTop: '24px'\r\n  },\r\n  tooltip: {\r\n    backgroundColor: theme.palette.primary.dark,\r\n    border: '1px solid #fff',\r\n    fontSize: '0.9em',\r\n    fontWeight: 'normal',\r\n    marginTop: '5px'\r\n  },\r\n  tooltipArrow: {\r\n    color: theme.palette.primary.dark,\r\n    \"&:before\": {\r\n      border: '1px solid #fff'\r\n    }\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n    display: 'flex',\r\n    alignItems: 'baseline',\r\n    flexWrap: 'wrap'\r\n  },\r\n  h6: {\r\n    lineHeight: 1\r\n  },\r\n  version: {\r\n    marginLeft: theme.spacing(1),\r\n    paddingLeft: '2px',\r\n    paddingRight: '2px',\r\n    paddingTop: theme.spacing(0.5),\r\n    paddingBottom: theme.spacing(0.5),\r\n    fontWeight: 'normal',\r\n    color: '#fff',\r\n    letterSpacing: 'normal',\r\n    textTransform: 'none',\r\n    minWidth: 'auto'\r\n  },\r\n  filters: {\r\n    display: 'flex',\r\n    flexWrap: 'wrap',\r\n    margin: theme.spacing(1)/2,\r\n    justifyContent: 'flex-end'\r\n  },\r\n  search: {\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  searchOption: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    overflow: 'hidden'\r\n  },\r\n  searchInfos: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    marginLeft: theme.spacing(2),\r\n    overflow: 'hidden',\r\n  },\r\n  searchLocation: {\r\n    textOverflow: 'ellipsis',\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    color: '#aaa'\r\n  },\r\n  searchName: {\r\n    textOverflow: 'ellipsis',\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap'\r\n  },\r\n  searchIcao: {\r\n    minWidth: 40,\r\n    textAlign: 'center'\r\n  },\r\n  body: {\r\n    display: 'flex',\r\n    flexWrap: 'nowrap',\r\n    flexGrow: '1',\r\n    overflow: 'hidden'\r\n  }\r\n}));\r\n\r\nconst TooltipToggleButton = ({ children, title, tclasses, ...props }) => (\r\n  <Tooltip title={title} classes={tclasses} arrow>\r\n    <ToggleButton {...props}>{children}</ToggleButton>\r\n  </Tooltip>\r\n)\r\n\r\n\r\nfunction transformPlanes(p) {\r\n  const planes = {};\r\n  for (const model of Object.keys(p)) {\r\n    for (const icao of Object.keys(p[model])) {\r\n      if (!planes[icao]) { planes[icao] = []; }\r\n      for (const plane of p[model][icao]) {\r\n        plane.model = model\r\n        planes[icao].push(plane);\r\n      }\r\n    }\r\n  }\r\n  return planes;\r\n}\r\n\r\nconst storage = new Storage();\r\n\r\n\r\nfunction App() {\r\n\r\n  const [type, setType] = React.useState('Trip-Only');\r\n  const [cargo, setCargo] = React.useState('passengers');\r\n  const [fromIcaoInput, setFromIcaoInput] = React.useState('');\r\n  const [fromIcao, setFromIcao] = React.useState(null);\r\n  const [toIcaoInput, setToIcaoInput] = React.useState('');\r\n  const [toIcao, setToIcao] = React.useState(null);\r\n  const [min, setMin] = React.useState('');\r\n  const [max, setMax] = React.useState('');\r\n  const [minDist, setMinDist] = React.useState('');\r\n  const [maxDist, setMaxDist] = React.useState('');\r\n  const [direction, setDirection] = React.useState('');\r\n  const [updatePopup, setUpdatePopup] = React.useState(false);\r\n  const [settingsPopop, setSettingsPopup] = React.useState(false);\r\n  const [creditsPopop, setCreditsPopup] = React.useState(false);\r\n  const [jobs, setJobs] = React.useState(storage.get('jobs', {}));\r\n  const [planes, setPlanes] = React.useState(() => {\r\n    return transformPlanes(storage.get('planes', {}));\r\n  });\r\n  const [flight, setFlight] = React.useState(storage.get('flight', {}));\r\n  const [settings, setSettings] = React.useState(() => {\r\n    return _defaultsDeep(storage.get('settings', {}), defaultSettings);\r\n  });\r\n  const [search, setSearch] = React.useState(null);\r\n  const [searchInput, setSearchInput] = React.useState('');\r\n  const [searchHistory, setSearchHistory] = React.useState(storage.get('searchHistory', []));\r\n  const [icaodata, setIcaodata] = React.useState(icaodataSrc);\r\n  const [isTourOpen, setIsTourOpen] = React.useState(storage.get('tutorial') === null);\r\n  const [customIcaos, setCustomIcaos] = React.useState(storage.get('customIcaos', []));\r\n  const [routeFinder, setRouteFinder] = React.useState(false);\r\n  const [route, setRoute] = React.useState(null);\r\n  const mapRef = React.useRef();\r\n  const classes = useStyles();\r\n\r\n  const options = React.useMemo(() => ({\r\n    min: min,\r\n    max: max,\r\n    minDist: minDist,\r\n    maxDist: maxDist,\r\n    direction: direction,\r\n    type: type,\r\n    cargo: cargo,\r\n    fromIcao: fromIcao,\r\n    toIcao: toIcao,\r\n    jobs: jobs,\r\n    planes: planes,\r\n    flight: flight,\r\n    settings: settings,\r\n    icaodata: icaodata\r\n  }), [type, cargo, fromIcao, toIcao, min, max, minDist, maxDist, direction, jobs, planes, flight, settings, icaodata]);\r\n\r\n  React.useEffect(() => {\r\n    const obj = _clone(icaodataSrc);\r\n    icaos.forEach((icao) => {\r\n      const nb = wrap(obj[icao].lon, settings.display.map.center);\r\n      obj[icao].lon += nb;\r\n      wrapZone(obj[icao].zone, obj[icao].lon, nb, settings.display.map.center);\r\n    });\r\n    setIcaodata(obj);\r\n  }, [settings.display.map.center]);\r\n\r\n  React.useEffect(() => {\r\n    const last = storage.get('tutorial');\r\n    if (last && last !== process.env.REACT_APP_VERSION) {\r\n      setCreditsPopup(true);\r\n      storage.set('tutorial', process.env.REACT_APP_VERSION);\r\n    }\r\n\r\n    // Set search if query string in URL\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const icao = urlParams.get('icao');\r\n    if (icao) {\r\n      setSearch(icao);\r\n    }\r\n  }, []);\r\n\r\n  // Create goTo function, to allow panning to given ICAO\r\n  // Cannot just use setSearch, because need to pan even if the ICAO was already in search var\r\n  const goToRef = React.useRef(null);\r\n  const goTo = React.useCallback((icao) => {\r\n    setSearch(prevIcao => prevIcao === icao ? null : icao);\r\n    goToRef.current = icao;\r\n    window.history.replaceState({icao:icao}, '', '?icao='+icao);\r\n  }, []);\r\n  React.useEffect(() => {\r\n    if (goToRef.current) {\r\n      const icao = goToRef.current;\r\n      goToRef.current = null;\r\n      setSearch(icao);\r\n    }\r\n  }, [search]);\r\n\r\n  // Invalidate map size when routing toogled\r\n  React.useEffect(() => {\r\n    mapRef.current.leafletElement.invalidateSize({pan:false});\r\n  }, [routeFinder]);\r\n\r\n  const setFrom = React.useCallback((icao) => {\r\n    icao = icao.toUpperCase();\r\n    setFromIcaoInput(icao);\r\n    if (icaodata.hasOwnProperty(icao)) {\r\n      setFromIcao(icao);\r\n    }\r\n    else {\r\n      setFromIcao(null)\r\n    }\r\n  }, [icaodata]);\r\n  const isFromIcao = React.useCallback((icao) => fromIcao === icao, [fromIcao]);\r\n  const setTo = React.useCallback((icao) => {\r\n    icao = icao.toUpperCase();\r\n    setToIcaoInput(icao);\r\n    if (icaodata.hasOwnProperty(icao)) {\r\n      setToIcao(icao);\r\n    }\r\n    else {\r\n      setToIcao(null)\r\n    }\r\n  }, [icaodata]);\r\n  const isToIcao = React.useCallback((icao) => toIcao === icao, [toIcao]);\r\n  const addCustom = (icao) => setCustomIcaos(prev => [...prev, icao]);\r\n  const removeCustom = (icao) => setCustomIcaos(prev => prev.filter(elm => elm !== icao));\r\n  const isInCustom = React.useCallback((icao) => customIcaos.includes(icao), [customIcaos]);\r\n  React.useEffect(() => {\r\n    storage.set('customIcaos', customIcaos);\r\n  }, [customIcaos]);\r\n\r\n  // Actions\r\n  const actions = React.useRef(null);\r\n  const setActions = () => {\r\n    actions.current = {\r\n      goTo: goTo,\r\n      fromIcao: setFrom,\r\n      isFromIcao: isFromIcao,\r\n      isToIcao: isToIcao,\r\n      toIcao: setTo,\r\n      addCustom: addCustom,\r\n      removeCustom: removeCustom,\r\n      isInCustom: isInCustom,\r\n      contextMenu: (actions.current && actions.current.contextMenu) ? actions.current.contextMenu : undefined\r\n    };\r\n  }\r\n  if (!actions.current) { setActions(); }\r\n  React.useEffect(setActions, [goTo, setFrom, isFromIcao, setTo, isToIcao, addCustom, removeCustom, isInCustom]);\r\n\r\n\r\n  return (\r\n    <div style={{\r\n      display: \"flex\",\r\n      flexFlow: \"column\",\r\n      height: \"100vh\",\r\n    }}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <div className={classes.title}>\r\n            <Typography variant=\"h6\" className={classes.h6}>\r\n              FSE Planner\r\n            </Typography>\r\n            <Tooltip title=\"Changelog & credits\">\r\n              <Button className={classes.version} onClick={() => setCreditsPopup(true)} data-tour=\"Step9\" size=\"small\">\r\n                v{process.env.REACT_APP_VERSION}\r\n              </Button>\r\n            </Tooltip>\r\n          </div>\r\n          <div className={classes.filters}>\r\n            <div className={classes.search}>\r\n              <Autocomplete\r\n                options={icaodataSrcArr}\r\n                getOptionLabel={(a) => a.icao ? a.icao : ''}\r\n                renderOption={(a) =>\r\n                  <span className={classes.searchOption}>\r\n                    <b className={classes.searchIcao}>{a.icao}</b>\r\n                    <span className={classes.searchInfos}>\r\n                      <span className={classes.searchName}>{a.name}</span>\r\n                      <Typography variant=\"caption\" className={classes.searchLocation}>{a.city}, {a.state ? a.state+', ' : ''}{a.country}</Typography>\r\n                    </span>\r\n                  </span>\r\n                }\r\n                filterOptions={(options, params) => {\r\n                  // If input is empty and search history is not, display search history\r\n                  if (!searchInput && searchHistory.length > 0) {\r\n                    return searchHistory.map(icao => icaodata[icao]);\r\n                  }\r\n                  // Search for ICAO\r\n                  let filtered = filter(options, { inputValue: searchInput, getOptionLabel: (a) => a.icao });\r\n                  // If not enough results, search for city name\r\n                  if (filtered.length < 5) {\r\n                    const add = filter(options, { inputValue: searchInput, getOptionLabel: (a) => a.name });\r\n                    filtered = filtered.concat(add.slice(0, 5-filtered.length));\r\n                  }\r\n                  return filtered;\r\n                }}\r\n                renderInput={(params) =>\r\n                  <InputBase\r\n                    placeholder=\"Search...\"\r\n                    className={classes.inputSearch}\r\n                    ref={params.InputProps.ref}\r\n                    inputProps={params.inputProps}\r\n                    endAdornment={params.inputProps.value ?\r\n                        <IconButton\r\n                          size=\"small\"\r\n                          onClick={() => {\r\n                            setSearch(null);\r\n                            setSearchInput('');\r\n                            window.history.replaceState(null, '', '?');\r\n                          }}\r\n                        >\r\n                          <CloseIcon />\r\n                        </IconButton>\r\n                      :\r\n                        null\r\n                    }\r\n                  />\r\n                }\r\n                PopperComponent={PopperMy}\r\n                onChange={(evt, value) => {\r\n                  if (value) {\r\n                    setSearch(value.icao);\r\n                    const list = [...(new Set([value.icao, ...searchHistory]))].slice(0, 5);\r\n                    setSearchHistory(list);\r\n                    storage.set('searchHistory', list);\r\n                    window.history.replaceState({icao:value.icao}, '', '?icao='+value.icao);\r\n                  }\r\n                  else {\r\n                    setSearch(null);\r\n                    window.history.replaceState(null, '', '?');\r\n                  }\r\n                }}\r\n                value={search ? icaodataSrc[search] : null}\r\n                inputValue={searchInput}\r\n                onInputChange={(evt, value) => setSearchInput(value)}\r\n                autoHighlight={true}\r\n                selectOnFocus={false}\r\n              />\r\n            </div>\r\n            <Tooltip title='Jobs radiating FROM this airport' classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n              <div className={classes.boxBorder} data-tour=\"Step7\">\r\n                <FlightTakeoffIcon className={fromIcao === null ? classes.tgBtn : null}/>\r\n                &nbsp;&nbsp;\r\n                <InputBase\r\n                  placeholder=\"ICAO\"\r\n                  className={classes.input}\r\n                  inputProps={{maxLength:4}}\r\n                  value={fromIcaoInput}\r\n                  onChange={evt => setFrom(evt.target.value)}\r\n                />\r\n              </div>\r\n            </Tooltip>\r\n            <Tooltip title='Jobs radiating TO this airport' classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n              <div className={classes.boxBorder}>\r\n                <FlightLandIcon className={toIcao === null ? classes.tgBtn : null} />\r\n                &nbsp;&nbsp;\r\n                <InputBase\r\n                  placeholder=\"ICAO\"\r\n                  className={classes.input}\r\n                  inputProps={{maxLength:4}}\r\n                  value={toIcaoInput}\r\n                  onChange={evt => setTo(evt.target.value)}\r\n                />\r\n              </div>\r\n            </Tooltip>\r\n            <Tooltip title='Jobs going in this direction (+/- 30)' classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n              <div className={classes.boxBorder}>\r\n                <ExploreIcon className={direction === '' ? classes.tgBtn : null}/>\r\n                &nbsp;&nbsp;\r\n                <InputBase\r\n                  placeholder=\"145\"\r\n                  className={classes.input}\r\n                  inputProps={{maxLength:3}}\r\n                  value={direction}\r\n                  onChange={evt => { setDirection(evt.target.value); }}\r\n                />\r\n              </div>\r\n            </Tooltip>\r\n            <ToggleButtonGroup value={type} onChange={(evt, val) => {setType(val)}} className={classes.box} exclusive>\r\n              <TooltipToggleButton value=\"Trip-Only\" title=\"Trip only\" classes={{root: classes.tgBtn, selected: classes.tgBtnSelected}} tclasses={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}}>\r\n                <EmojiPeopleIcon />\r\n              </TooltipToggleButton>\r\n              <TooltipToggleButton value=\"VIP\" title=\"VIP\" classes={{root: classes.tgBtn, selected: classes.tgBtnSelected}} tclasses={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}}>\r\n                <StarIcon />\r\n              </TooltipToggleButton>\r\n              <TooltipToggleButton value=\"All-In\" title=\"All in\" classes={{root: classes.tgBtn, selected: classes.tgBtnSelected}} tclasses={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}}>\r\n                <FlightIcon />\r\n              </TooltipToggleButton>\r\n            </ToggleButtonGroup>\r\n            <ToggleButtonGroup value={cargo} onChange={(evt, val) => {setCargo(val);setMin('');setMax('');}} className={classes.box} exclusive>\r\n              <TooltipToggleButton value=\"passengers\" title=\"Passengers\" classes={{root: classes.tgBtn, selected: classes.tgBtnSelected}} tclasses={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}}>\r\n                <PeopleIcon />\r\n              </TooltipToggleButton>\r\n              <TooltipToggleButton value=\"kg\" title=\"Cargo\" classes={{root: classes.tgBtn, selected: classes.tgBtnSelected}} tclasses={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}}>\r\n                <BusinessCenterIcon />\r\n              </TooltipToggleButton>\r\n            </ToggleButtonGroup>\r\n            <div className={classes.boxBorder}>\r\n              {cargo === 'passengers' ?\r\n                <PeopleIcon className={min === '' && max === '' ? classes.tgBtn : null}/>\r\n              :\r\n                <BusinessCenterIcon className={min === '' && max === '' ? classes.tgBtn : null} />\r\n              }\r\n              &nbsp;\r\n              <Tooltip title={cargo === 'passengers' ? \"Minimum number of passengers per segment\" : \"Minimum weight per segment\"} classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n                <InputBase\r\n                  placeholder=\"min\"\r\n                  className={classes.inputNb}\r\n                  value={min}\r\n                  onChange={evt => { let nb = parseInt(evt.target.value) || ''; setMin(nb); }}\r\n                />\r\n              </Tooltip>\r\n              -\r\n              <Tooltip title={cargo === 'passengers' ? \"Maximum number of passengers per job\" : \"Maximum weight per job\"} classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n                <InputBase\r\n                  placeholder=\"max\"\r\n                  className={classes.inputNb}\r\n                  value={max}\r\n                  onChange={evt => { let nb = parseInt(evt.target.value) || ''; setMax(nb); }}\r\n                />\r\n              </Tooltip>\r\n            </div>\r\n            <div className={classes.boxBorder}>\r\n              <SettingsEthernetIcon className={minDist === '' && maxDist === '' ? classes.tgBtn : null} />\r\n              &nbsp;\r\n              <Tooltip title='Minimum job distance in NM' classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n                <InputBase\r\n                  placeholder=\"min\"\r\n                  className={classes.inputNb}\r\n                  value={minDist}\r\n                  onChange={evt => { let nb = parseInt(evt.target.value) || ''; setMinDist(nb); }}\r\n                />\r\n              </Tooltip>\r\n              -\r\n              <Tooltip title='Maximum job distance in NM' classes={{tooltip: classes.tooltip, arrow: classes.tooltipArrow}} arrow>\r\n                <InputBase\r\n                  placeholder=\"max\"\r\n                  className={classes.inputNb}\r\n                  value={maxDist}\r\n                  onChange={evt => { let nb = parseInt(evt.target.value) || ''; setMaxDist(nb); }}\r\n                />\r\n              </Tooltip>\r\n            </div>\r\n            <IconButton className={classes.icon+' '+classes.box} size=\"small\" onClick={() => setSettingsPopup(true)} data-tour=\"Step8\">\r\n              <Tooltip title=\"More options\">\r\n                <TuneIcon />\r\n              </Tooltip>\r\n            </IconButton>\r\n            <IconButton className={classes.icon+' '+classes.box} size=\"small\" onClick={() => setRouteFinder(!routeFinder)} data-tour=\"Step8b\">\r\n              <Tooltip title=\"Route finder\">\r\n                <DirectionsIcon />\r\n              </Tooltip>\r\n            </IconButton>\r\n            <IconButton className={classes.icon+' '+classes.box} size=\"small\" onClick={() => setUpdatePopup(true)} data-tour=\"Step2\">\r\n              <Tooltip title=\"Load data from FSE\">\r\n                <UpdateIcon />\r\n              </Tooltip>\r\n            </IconButton>\r\n          </div>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <div className={classes.body}>\r\n        <Routing\r\n          options={options}\r\n          setRoute={setRoute}\r\n          hidden={!routeFinder}\r\n          mapRef={mapRef}\r\n          close={() => setRouteFinder(false)}\r\n          actions={actions}\r\n        />\r\n        <FSEMap\r\n          options={options}\r\n          search={search}\r\n          icaos={icaos}\r\n          customIcaos={customIcaos}\r\n          route={route}\r\n          mapRef={mapRef}\r\n          actions={actions}\r\n        />\r\n      </div>\r\n      <UpdatePopup\r\n        open={updatePopup}\r\n        setUpdatePopup={setUpdatePopup}\r\n        setJobs={setJobs}\r\n        setPlanes={(planes) => setPlanes(transformPlanes(planes))}\r\n        setFlight={setFlight}\r\n        icaodata={icaodata}\r\n        icaos={icaos}\r\n        settings={settings}\r\n        customIcaos={customIcaos}\r\n        setCustomIcaos={setCustomIcaos}\r\n      />\r\n      <SettingsPopup\r\n        open={settingsPopop}\r\n        handleClose={() => setSettingsPopup(false)}\r\n        settings={settings}\r\n        setSettings={setSettings}\r\n        defaultSettings={defaultSettings}\r\n      />\r\n      <CreditsPopup\r\n        open={creditsPopop}\r\n        handleClose={() => setCreditsPopup(false)}\r\n        openTutorial={() => setIsTourOpen(true)}\r\n      />\r\n      <Tour\r\n        isTourOpen={isTourOpen}\r\n        setIsTourOpen={setIsTourOpen}\r\n        updatePopup={updatePopup}\r\n        setUpdatePopup={setUpdatePopup}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}